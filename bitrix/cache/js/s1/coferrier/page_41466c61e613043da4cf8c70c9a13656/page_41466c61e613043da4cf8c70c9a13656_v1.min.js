(function(b){if(b.JCCatalogElement){return}var a=function(c){a.superclass.constructor.apply(this,arguments);this.buttonNode=BX.create("SPAN",{props:{className:"btn btn-default btn-buy btn-sm",id:this.id},style:typeof c.style==="object"?c.style:{},text:c.text,events:this.contextEvents});if(BX.browser.IsIE()){this.buttonNode.setAttribute("hideFocus","hidefocus")}};BX.extend(a,BX.PopupWindowButton);b.JCCatalogElement=function(c){this.productType=0;this.config={useCatalog:true,showQuantity:true,showPrice:true,showAbsent:true,showOldPrice:false,showPercent:false,showSkuProps:false,showOfferGroup:false,useCompare:false,useStickers:false,useSubscribe:false,usePopup:false,useMagnifier:false,usePriceRanges:false,basketAction:["BUY"],showClosePopup:false,templateTheme:"",showSlider:false,sliderInterval:5000,useEnhancedEcommerce:false,dataLayerName:"dataLayer",brandProperty:false,alt:"",title:"",magnifierZoomPercent:200};this.checkQuantity=false;this.maxQuantity=0;this.minQuantity=0;this.stepQuantity=1;this.isDblQuantity=false;this.canBuy=true;this.isGift=false;this.canSubscription=true;this.currentIsSet=false;this.updateViewedCount=false;this.currentPriceMode="";this.currentPrices=[];this.currentPriceSelected=0;this.currentQuantityRanges=[];this.currentQuantityRangeSelected=0;this.precision=6;this.precisionFactor=Math.pow(10,this.precision);this.visual={};this.basketMode="";this.product={checkQuantity:false,maxQuantity:0,stepQuantity:1,startQuantity:1,isDblQuantity:false,canBuy:true,canSubscription:true,name:"",pict:{},id:0,addUrl:"",buyUrl:"",slider:{},sliderCount:0,useSlider:false,sliderPict:[]};this.mess={};this.basketData={useProps:false,emptyProps:false,quantity:"quantity",props:"prop",basketUrl:"",sku_props:"",sku_props_var:"basket_props",add_url:"",buy_url:""};this.compareData={compareUrl:"",compareDeleteUrl:"",comparePath:""};this.defaultPict={preview:null,detail:null};this.offers=[];this.offerNum=0;this.treeProps=[];this.selectedValues={};this.mouseTimer=null;this.isTouchDevice=BX.hasClass(document.documentElement,"bx-touch");this.touch=null;this.slider={interval:null,progress:null,paused:null,controls:[]};this.quantityDelay=null;this.quantityTimer=null;this.obProduct=null;this.obQuantity=null;this.obQuantityUp=null;this.obQuantityDown=null;this.obPrice={price:null,full:null,discount:null,percent:null,total:null};this.obTree=null;this.obPriceRanges=null;this.obBuyBtn=null;this.obAddToBasketBtn=null;this.obBasketActions=null;this.obNotAvail=null;this.obSubscribe=null;this.obSkuProps=null;this.obDescription=null;this.obMainSkuProps=null;this.obBigSlider=null;this.obMeasure=null;this.obQuantityLimit={all:null,value:null};this.obCompare=null;this.obTabsPanel=null;this.node={};this.smallCardNodes={};this.magnify={enabled:false,obBigImg:null,obBigSlider:null,height:0,width:0,timer:0};this.currentImg={id:0,src:"",width:0,height:0};this.viewedCounter={path:"/bitrix/components/bitrix/catalog.element/ajax.php",params:{AJAX:"Y",SITE_ID:"",PRODUCT_ID:0,PARENT_ID:0}};this.obPopupWin=null;this.basketUrl="";this.basketParams={};this.errorCode=0;if(typeof c==="object"){this.params=c;this.initConfig();if(this.params.MESS){this.mess=this.params.MESS}switch(this.productType){case 0:case 1:case 2:this.initProductData();break;case 3:this.initOffersData();break;default:this.errorCode=-1}this.initBasketData();this.initCompareData();this.isFacebookConversionCustomizeProductEventEnabled=this.params.IS_FACEBOOK_CONVERSION_CUSTOMIZE_PRODUCT_EVENT_ENABLED}if(this.errorCode===0){BX.ready(BX.delegate(this.init,this))}this.params={};BX.addCustomEvent("onSaleProductIsGift",BX.delegate(this.onSaleProductIsGift,this));BX.addCustomEvent("onSaleProductIsNotGift",BX.delegate(this.onSaleProductIsNotGift,this))};b.JCCatalogElement.prototype={getEntity:function(d,c,f){if(!d||!c){return null}f=f||"";return d.querySelector(f+'[data-entity="'+c+'"]')},getEntities:function(d,c,f){if(!d||!c){return{length:0}}f=f||"";return d.querySelectorAll(f+'[data-entity="'+c+'"]')},onSaleProductIsGift:function(d,c){if(c&&this.offers&&this.offers[this.offerNum].ID==c){this.setGift()}},onSaleProductIsNotGift:function(d,c){if(c&&this.offers&&this.offers[this.offerNum].ID==c){this.restoreSticker();this.isGift=false;this.setPrice()}},reloadGiftInfo:function(){if(this.productType===3){this.checkQuantity=true;this.maxQuantity=1;this.setPrice();this.redrawSticker({text:BX.message("PRODUCT_GIFT_LABEL")})}},setGift:function(){if(this.productType===3){this.isGift=true}if(this.productType===1||this.productType===2){this.isGift=true}if(this.productType===0){this.isGift=false}this.reloadGiftInfo()},setOffer:function(c){this.offerNum=parseInt(c);this.setCurrent()},init:function(){var d=0,h=0,f=null;this.obProduct=BX(this.visual.ID);if(!this.obProduct){this.errorCode=-1}this.obBigSlider=BX(this.visual.BIG_SLIDER_ID);this.node.imageContainer=this.getEntity(this.obProduct,"images-container");this.node.imageSliderBlock=this.getEntity(this.obProduct,"images-slider-block");this.node.sliderProgressBar=this.getEntity(this.obProduct,"slider-progress-bar");this.node.sliderControlLeft=this.getEntity(this.obBigSlider,"slider-control-left");this.node.sliderControlRight=this.getEntity(this.obBigSlider,"slider-control-right");if(!this.obBigSlider||!this.node.imageContainer||!this.node.imageContainer){this.errorCode=-2}if(this.config.showPrice){this.obPrice.price=BX(this.visual.PRICE_ID);if(!this.obPrice.price&&this.config.useCatalog){this.errorCode=-16}else{this.obPrice.total=BX(this.visual.PRICE_TOTAL);if(this.config.showOldPrice){this.obPrice.full=BX(this.visual.OLD_PRICE_ID);this.obPrice.discount=BX(this.visual.DISCOUNT_PRICE_ID);if(!this.obPrice.full||!this.obPrice.discount){this.config.showOldPrice=false}}if(this.config.showPercent){this.obPrice.percent=BX(this.visual.DISCOUNT_PERCENT_ID);if(!this.obPrice.percent){this.config.showPercent=false}}}this.obBasketActions=BX(this.visual.BASKET_ACTIONS_ID);if(this.obBasketActions){if(BX.util.in_array("BUY",this.config.basketAction)){this.obBuyBtn=BX(this.visual.BUY_LINK)}if(BX.util.in_array("ADD",this.config.basketAction)){this.obAddToBasketBtn=BX(this.visual.ADD_BASKET_LINK)}}this.obNotAvail=BX(this.visual.NOT_AVAILABLE_MESS)}if(this.config.showQuantity){this.obQuantity=BX(this.visual.QUANTITY_ID);this.node.quantity=this.getEntity(this.obProduct,"quantity-block");if(this.visual.QUANTITY_UP_ID){this.obQuantityUp=BX(this.visual.QUANTITY_UP_ID)}if(this.visual.QUANTITY_DOWN_ID){this.obQuantityDown=BX(this.visual.QUANTITY_DOWN_ID)}}if(this.productType===3){if(this.visual.TREE_ID){this.obTree=BX(this.visual.TREE_ID);if(!this.obTree){this.errorCode=-256}}if(this.visual.QUANTITY_MEASURE){this.obMeasure=BX(this.visual.QUANTITY_MEASURE)}if(this.visual.QUANTITY_LIMIT&&this.config.showMaxQuantity!=="N"){this.obQuantityLimit.all=BX(this.visual.QUANTITY_LIMIT);if(this.obQuantityLimit.all){this.obQuantityLimit.value=this.getEntity(this.obQuantityLimit.all,"quantity-limit-value");if(!this.obQuantityLimit.value){this.obQuantityLimit.all=null}}}if(this.config.usePriceRanges){this.obPriceRanges=this.getEntity(this.obProduct,"price-ranges-block")}}if(this.config.showSkuProps){this.obSkuProps=BX(this.visual.DISPLAY_PROP_DIV);this.obMainSkuProps=BX(this.visual.DISPLAY_MAIN_PROP_DIV)}if(this.config.showSkuDescription==="Y"){this.obDescription=BX(this.visual.DESCRIPTION_ID)}if(this.config.useCompare){this.obCompare=BX(this.visual.COMPARE_LINK)}if(this.config.useSubscribe){this.obSubscribe=BX(this.visual.SUBSCRIBE_LINK)}this.obTabs=BX(this.visual.TABS_ID);this.obTabContainers=BX(this.visual.TAB_CONTAINERS_ID);this.obTabsPanel=BX(this.visual.TABS_PANEL_ID);this.smallCardNodes.panel=BX(this.visual.SMALL_CARD_PANEL_ID);if(this.smallCardNodes.panel){this.smallCardNodes.picture=this.getEntity(this.smallCardNodes.panel,"panel-picture");this.smallCardNodes.title=this.getEntity(this.smallCardNodes.panel,"panel-title");this.smallCardNodes.price=this.getEntity(this.smallCardNodes.panel,"panel-price");this.smallCardNodes.sku=this.getEntity(this.smallCardNodes.panel,"panel-sku-container");this.smallCardNodes.oldPrice=this.getEntity(this.smallCardNodes.panel,"panel-old-price");this.smallCardNodes.buyButton=this.getEntity(this.smallCardNodes.panel,"panel-buy-button");this.smallCardNodes.addButton=this.getEntity(this.smallCardNodes.panel,"panel-add-button");this.smallCardNodes.notAvailableButton=this.getEntity(this.smallCardNodes.panel,"panel-not-available-button");this.smallCardNodes.aligner=this.getEntity(this.obProduct,"main-button-container")}this.initPopup();this.initTabs();if(this.smallCardNodes.panel){this.smallCardNodes.picture&&BX.bind(this.smallCardNodes.picture.parentNode,"click",BX.proxy(this.scrollToProduct,this));this.smallCardNodes.title&&BX.bind(this.smallCardNodes.title,"click",BX.proxy(this.scrollToProduct,this));this.smallCardNodes.sku&&BX.bind(this.smallCardNodes.sku,"click",BX.proxy(this.scrollToProduct,this))}if(this.obTabsPanel||this.smallCardNodes.panel){this.checkTopPanels();BX.bind(b,"scroll",BX.proxy(this.checkTopPanels,this))}if(this.errorCode===0){if(this.config.showSlider&&!this.isTouchDevice){BX.bind(this.obBigSlider,"mouseenter",BX.proxy(this.stopSlider,this));BX.bind(this.obBigSlider,"mouseleave",BX.proxy(this.cycleSlider,this))}if(this.isTouchDevice){BX.bind(this.node.imageContainer,"touchstart",BX.proxy(this.touchStartEvent,this));BX.bind(this.node.imageContainer,"touchend",BX.proxy(this.touchEndEvent,this));BX.bind(this.node.imageContainer,"touchcancel",BX.proxy(this.touchEndEvent,this))}BX.bind(this.node.sliderControlLeft,"click",BX.proxy(this.slidePrev,this));BX.bind(this.node.sliderControlRight,"click",BX.proxy(this.slideNext,this));if(this.config.showQuantity){var c=this.isTouchDevice?"touchstart":"mousedown";var g=this.isTouchDevice?"touchend":"mouseup";if(this.obQuantityUp){BX.bind(this.obQuantityUp,c,BX.proxy(this.startQuantityInterval,this));BX.bind(this.obQuantityUp,g,BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityUp,"mouseout",BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityUp,"click",BX.delegate(this.quantityUp,this))}if(this.obQuantityDown){BX.bind(this.obQuantityDown,c,BX.proxy(this.startQuantityInterval,this));BX.bind(this.obQuantityDown,g,BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityDown,"mouseout",BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityDown,"click",BX.delegate(this.quantityDown,this))}if(this.obQuantity){BX.bind(this.obQuantity,"change",BX.delegate(this.quantityChange,this))}}switch(this.productType){case 0:case 1:case 2:if(this.product.useSlider){this.product.slider={ID:this.visual.SLIDER_CONT_ID,CONT:BX(this.visual.SLIDER_CONT_ID),COUNT:this.product.sliderCount};this.product.slider.ITEMS=this.getEntities(this.product.slider.CONT,"slider-control");for(h=0;h<this.product.slider.ITEMS.length;h++){BX.bind(this.product.slider.ITEMS[h],"mouseenter",BX.delegate(this.onSliderControlHover,this));BX.bind(this.product.slider.ITEMS[h],"mouseleave",BX.delegate(this.onSliderControlLeave,this));BX.bind(this.product.slider.ITEMS[h],"click",BX.delegate(this.selectSliderImg,this))}this.setCurrentImg(this.product.sliderPict[0],true,true);this.checkSliderControls(this.product.sliderCount);if(this.product.slider.ITEMS.length>1){this.initSlider()}}this.checkQuantityControls();this.fixFontCheck();this.setAnalyticsDataLayer("showDetail");break;case 3:f=this.obTree.querySelectorAll("li");for(d=0;d<f.length;d++){BX.bind(f[d],"click",BX.delegate(this.selectOfferProp,this))}for(d=0;d<this.offers.length;d++){this.offers[d].SLIDER_COUNT=parseInt(this.offers[d].SLIDER_COUNT,10)||0;if(this.offers[d].SLIDER_COUNT===0){this.slider.controls[d]={ID:"",COUNT:this.offers[d].SLIDER_COUNT,ITEMS:[]}}else{for(h=0;h<this.offers[d].SLIDER.length;h++){this.offers[d].SLIDER[h].WIDTH=parseInt(this.offers[d].SLIDER[h].WIDTH,10);this.offers[d].SLIDER[h].HEIGHT=parseInt(this.offers[d].SLIDER[h].HEIGHT,10)}this.slider.controls[d]={ID:this.visual.SLIDER_CONT_OF_ID+this.offers[d].ID,OFFER_ID:this.offers[d].ID,CONT:BX(this.visual.SLIDER_CONT_OF_ID+this.offers[d].ID),COUNT:this.offers[d].SLIDER_COUNT};this.slider.controls[d].ITEMS=this.getEntities(this.slider.controls[d].CONT,"slider-control");for(h=0;h<this.slider.controls[d].ITEMS.length;h++){BX.bind(this.slider.controls[d].ITEMS[h],"mouseenter",BX.delegate(this.onSliderControlHover,this));BX.bind(this.slider.controls[d].ITEMS[h],"mouseleave",BX.delegate(this.onSliderControlLeave,this));BX.bind(this.slider.controls[d].ITEMS[h],"click",BX.delegate(this.selectSliderImg,this))}}}this.setCurrent();break}this.obBuyBtn&&BX.bind(this.obBuyBtn,"click",BX.proxy(this.buyBasket,this));this.smallCardNodes.buyButton&&BX.bind(this.smallCardNodes.buyButton,"click",BX.proxy(this.buyBasket,this));this.obAddToBasketBtn&&BX.bind(this.obAddToBasketBtn,"click",BX.proxy(this.add2Basket,this));this.smallCardNodes.addButton&&BX.bind(this.smallCardNodes.addButton,"click",BX.proxy(this.add2Basket,this));if(this.obCompare){BX.bind(this.obCompare,"click",BX.proxy(this.compare,this));BX.addCustomEvent("onCatalogDeleteCompare",BX.proxy(this.checkDeletedCompare,this))}}},initConfig:function(){if(this.params.PRODUCT_TYPE){this.productType=parseInt(this.params.PRODUCT_TYPE,10)}if(this.params.CONFIG.USE_CATALOG!=="undefined"&&BX.type.isBoolean(this.params.CONFIG.USE_CATALOG)){this.config.useCatalog=this.params.CONFIG.USE_CATALOG}this.config.showQuantity=this.params.CONFIG.SHOW_QUANTITY;this.config.showPrice=this.params.CONFIG.SHOW_PRICE;this.config.showPercent=this.params.CONFIG.SHOW_DISCOUNT_PERCENT;this.config.showOldPrice=this.params.CONFIG.SHOW_OLD_PRICE;this.config.showSkuProps=this.params.CONFIG.SHOW_SKU_PROPS;this.config.showOfferGroup=this.params.CONFIG.OFFER_GROUP;this.config.useCompare=this.params.CONFIG.DISPLAY_COMPARE;this.config.useStickers=this.params.CONFIG.USE_STICKERS;this.config.useSubscribe=this.params.CONFIG.USE_SUBSCRIBE;this.config.showMaxQuantity=this.params.CONFIG.SHOW_MAX_QUANTITY;this.config.relativeQuantityFactor=parseInt(this.params.CONFIG.RELATIVE_QUANTITY_FACTOR);this.config.usePriceRanges=this.params.CONFIG.USE_PRICE_COUNT;this.config.showSkuDescription=this.params.CONFIG.SHOW_SKU_DESCRIPTION;this.config.displayPreviewTextMode=this.params.CONFIG.DISPLAY_PREVIEW_TEXT_MODE;if(this.params.CONFIG.MAIN_PICTURE_MODE){this.config.usePopup=BX.util.in_array("POPUP",this.params.CONFIG.MAIN_PICTURE_MODE);this.config.useMagnifier=BX.util.in_array("MAGNIFIER",this.params.CONFIG.MAIN_PICTURE_MODE)}if(this.params.CONFIG.ADD_TO_BASKET_ACTION){this.config.basketAction=this.params.CONFIG.ADD_TO_BASKET_ACTION}this.config.showClosePopup=this.params.CONFIG.SHOW_CLOSE_POPUP;this.config.templateTheme=this.params.CONFIG.TEMPLATE_THEME||"";this.config.showSlider=this.params.CONFIG.SHOW_SLIDER==="Y";if(this.config.showSlider&&!this.isTouchDevice){this.config.sliderInterval=parseInt(this.params.CONFIG.SLIDER_INTERVAL)||5000}else{this.config.sliderInterval=false}this.config.useEnhancedEcommerce=this.params.CONFIG.USE_ENHANCED_ECOMMERCE==="Y";this.config.dataLayerName=this.params.CONFIG.DATA_LAYER_NAME;this.config.brandProperty=this.params.CONFIG.BRAND_PROPERTY;this.config.alt=this.params.CONFIG.ALT||"";this.config.title=this.params.CONFIG.TITLE||"";this.config.magnifierZoomPercent=parseInt(this.params.CONFIG.MAGNIFIER_ZOOM_PERCENT)||200;if(!this.params.VISUAL||typeof this.params.VISUAL!=="object"||!this.params.VISUAL.ID){this.errorCode=-1;return}this.visual=this.params.VISUAL},initProductData:function(){var c=0;if(this.params.PRODUCT&&typeof this.params.PRODUCT==="object"){if(this.config.showPrice){this.currentPriceMode=this.params.PRODUCT.ITEM_PRICE_MODE;this.currentPrices=this.params.PRODUCT.ITEM_PRICES;this.currentPriceSelected=this.params.PRODUCT.ITEM_PRICE_SELECTED;this.currentQuantityRanges=this.params.PRODUCT.ITEM_QUANTITY_RANGES;this.currentQuantityRangeSelected=this.params.PRODUCT.ITEM_QUANTITY_RANGE_SELECTED}if(this.config.showQuantity){this.product.checkQuantity=this.params.PRODUCT.CHECK_QUANTITY;this.product.isDblQuantity=this.params.PRODUCT.QUANTITY_FLOAT;if(this.product.checkQuantity){this.product.maxQuantity=this.product.isDblQuantity?parseFloat(this.params.PRODUCT.MAX_QUANTITY):parseInt(this.params.PRODUCT.MAX_QUANTITY,10)}this.product.stepQuantity=this.product.isDblQuantity?parseFloat(this.params.PRODUCT.STEP_QUANTITY):parseInt(this.params.PRODUCT.STEP_QUANTITY,10);this.checkQuantity=this.product.checkQuantity;this.isDblQuantity=this.product.isDblQuantity;this.stepQuantity=this.product.stepQuantity;this.maxQuantity=this.product.maxQuantity;this.minQuantity=this.currentPriceMode==="Q"?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity;if(this.isDblQuantity){this.stepQuantity=Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor}}this.product.canBuy=this.params.PRODUCT.CAN_BUY;this.canSubscription=this.product.canSubscription=this.params.PRODUCT.SUBSCRIPTION;this.product.name=this.params.PRODUCT.NAME;this.product.pict=this.params.PRODUCT.PICT;this.product.id=this.params.PRODUCT.ID;this.product.category=this.params.PRODUCT.CATEGORY;if(this.params.PRODUCT.ADD_URL){this.product.addUrl=this.params.PRODUCT.ADD_URL}if(this.params.PRODUCT.BUY_URL){this.product.buyUrl=this.params.PRODUCT.BUY_URL}if(this.params.PRODUCT.SLIDER_COUNT){this.product.sliderCount=parseInt(this.params.PRODUCT.SLIDER_COUNT,10)||0;if(this.product.sliderCount>0&&this.params.PRODUCT.SLIDER.length){for(c=0;c<this.params.PRODUCT.SLIDER.length;c++){this.product.useSlider=true;this.params.PRODUCT.SLIDER[c].WIDTH=parseInt(this.params.PRODUCT.SLIDER[c].WIDTH,10);this.params.PRODUCT.SLIDER[c].HEIGHT=parseInt(this.params.PRODUCT.SLIDER[c].HEIGHT,10)}this.product.sliderPict=this.params.PRODUCT.SLIDER;this.setCurrentImg(this.product.sliderPict[0],false)}}this.currentIsSet=true}else{this.errorCode=-1}},initOffersData:function(){if(this.params.OFFERS&&BX.type.isArray(this.params.OFFERS)){this.offers=this.params.OFFERS;this.offerNum=0;if(this.params.OFFER_SELECTED){this.offerNum=parseInt(this.params.OFFER_SELECTED,10)||0}if(this.params.TREE_PROPS){this.treeProps=this.params.TREE_PROPS}if(this.params.DEFAULT_PICTURE){this.defaultPict.preview=this.params.DEFAULT_PICTURE.PREVIEW_PICTURE;this.defaultPict.detail=this.params.DEFAULT_PICTURE.DETAIL_PICTURE}if(this.params.PRODUCT&&typeof this.params.PRODUCT==="object"){this.product.id=parseInt(this.params.PRODUCT.ID,10);this.product.name=this.params.PRODUCT.NAME;this.product.category=this.params.PRODUCT.CATEGORY;this.product.detailText=this.params.PRODUCT.DETAIL_TEXT;this.product.detailTextType=this.params.PRODUCT.DETAIL_TEXT_TYPE;this.product.previewText=this.params.PRODUCT.PREVIEW_TEXT;this.product.previewTextType=this.params.PRODUCT.PREVIEW_TEXT_TYPE}}else{this.errorCode=-1}},initBasketData:function(){if(this.params.BASKET&&typeof this.params.BASKET==="object"){if(this.productType===1||this.productType===2){this.basketData.useProps=this.params.BASKET.ADD_PROPS;this.basketData.emptyProps=this.params.BASKET.EMPTY_PROPS}if(this.params.BASKET.QUANTITY){this.basketData.quantity=this.params.BASKET.QUANTITY}if(this.params.BASKET.PROPS){this.basketData.props=this.params.BASKET.PROPS}if(this.params.BASKET.BASKET_URL){this.basketData.basketUrl=this.params.BASKET.BASKET_URL}if(this.productType===3){if(this.params.BASKET.SKU_PROPS){this.basketData.sku_props=this.params.BASKET.SKU_PROPS}}if(this.params.BASKET.ADD_URL_TEMPLATE){this.basketData.add_url=this.params.BASKET.ADD_URL_TEMPLATE}if(this.params.BASKET.BUY_URL_TEMPLATE){this.basketData.buy_url=this.params.BASKET.BUY_URL_TEMPLATE}if(this.basketData.add_url===""&&this.basketData.buy_url===""){this.errorCode=-1024}}},initCompareData:function(){if(this.config.useCompare){if(this.params.COMPARE&&typeof this.params.COMPARE==="object"){if(this.params.COMPARE.COMPARE_PATH){this.compareData.comparePath=this.params.COMPARE.COMPARE_PATH}if(this.params.COMPARE.COMPARE_URL_TEMPLATE){this.compareData.compareUrl=this.params.COMPARE.COMPARE_URL_TEMPLATE}else{this.config.useCompare=false}if(this.params.COMPARE.COMPARE_DELETE_URL_TEMPLATE){this.compareData.compareDeleteUrl=this.params.COMPARE.COMPARE_DELETE_URL_TEMPLATE}else{this.config.useCompare=false}}else{this.config.useCompare=false}}},initSlider:function(){if(this.node.sliderProgressBar){if(this.slider.progress){this.resetProgress()}else{this.slider.progress=new BX.easing({transition:BX.easing.transitions.linear,step:BX.delegate(function(c){this.node.sliderProgressBar.style.width=c.width/10+"%"},this)})}}this.cycleSlider()},setAnalyticsDataLayer:function(j){if(!this.config.useEnhancedEcommerce||!this.config.dataLayerName){return}var m={},t={},p=[],c,d,f,k,g,q;switch(this.productType){case 0:case 1:case 2:m={id:this.product.id,name:this.product.name,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,category:this.product.category,brand:BX.type.isArray(this.config.brandProperty)?this.config.brandProperty.join("/"):this.config.brandProperty};break;case 3:for(c in this.offers[this.offerNum].TREE){if(this.offers[this.offerNum].TREE.hasOwnProperty(c)){k=c.substring(5);g=this.offers[this.offerNum].TREE[c];for(d in this.treeProps){if(this.treeProps.hasOwnProperty(d)&&this.treeProps[d].ID==k){for(f in this.treeProps[d].VALUES){q=this.treeProps[d].VALUES[f];if(q.ID==g){p.push(q.NAME);break}}}}}}m={id:this.offers[this.offerNum].ID,name:this.offers[this.offerNum].NAME,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,category:this.product.category,brand:BX.type.isArray(this.config.brandProperty)?this.config.brandProperty.join("/"):this.config.brandProperty,variant:p.join("/")};break}switch(j){case"showDetail":t={ecommerce:{currencyCode:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].CURRENCY||"",detail:{products:[{name:m.name||"",id:m.id||"",price:m.price||0,brand:m.brand||"",category:m.category||"",variant:m.variant||""}]}}};break;case"addToCart":t={ecommerce:{currencyCode:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].CURRENCY||"",add:{products:[{name:m.name||"",id:m.id||"",price:m.price||0,brand:m.brand||"",category:m.category||"",variant:m.variant||"",quantity:this.config.showQuantity&&this.obQuantity?this.obQuantity.value:1}]}}};break}b[this.config.dataLayerName]=b[this.config.dataLayerName]||[];b[this.config.dataLayerName].push(t)},initTabs:function(){var f=this.getEntities(this.obTabs,"tab"),d=this.getEntities(this.obTabsPanel,"tab");var j,g,c=false;if(f.length!==d.length){return}for(var h in f){if(f.hasOwnProperty(h)&&BX.type.isDomNode(f[h])){j=f[h].getAttribute("data-value");if(j){g=this.obTabContainers.querySelector('[data-value="'+j+'"]');if(BX.type.isDomNode(g)){BX.bind(f[h],"click",BX.proxy(this.changeTab,this));BX.bind(d[h],"click",BX.proxy(this.changeTab,this));if(!c){BX.addClass(f[h],"active");BX.addClass(d[h],"active");BX.show(g);c=true}else{BX.removeClass(f[h],"active");BX.removeClass(d[h],"active");BX.hide(g)}}}}}},checkTouch:function(c){if(!c||!c.changedTouches){return false}return c.changedTouches[0].identifier===this.touch.identifier},touchStartEvent:function(c){if(c.touches.length!=1){return}this.touch=c.changedTouches[0]},touchEndEvent:function(d){if(!this.checkTouch(d)){return}var c=this.touch.pageX-d.changedTouches[0].pageX,f=this.touch.pageY-d.changedTouches[0].pageY;if(Math.abs(c)>=Math.abs(f)+10){if(c>0){this.slideNext()}if(c<0){this.slidePrev()}}},cycleSlider:function(d){d||(this.slider.paused=false);this.slider.interval&&clearInterval(this.slider.interval);if(this.config.sliderInterval&&!this.slider.paused){if(this.slider.progress){this.slider.progress.stop();var c=parseInt(this.node.sliderProgressBar.style.width);this.slider.progress.options.duration=this.config.sliderInterval*(100-c)/100;this.slider.progress.options.start={width:c*10};this.slider.progress.options.finish={width:1000};this.slider.progress.options.complete=BX.delegate(function(){this.slider.interval=true;this.slideNext()},this);this.slider.progress.animate()}else{this.slider.interval=setInterval(BX.proxy(this.slideNext,this),this.config.sliderInterval)}}},stopSlider:function(d){d||(this.slider.paused=true);this.slider.interval&&(this.slider.interval=clearInterval(this.slider.interval));if(this.slider.progress){this.slider.progress.stop();var c=parseInt(this.node.sliderProgressBar.style.width);this.slider.progress.options.duration=this.config.sliderInterval*c/200;this.slider.progress.options.start={width:c*10};this.slider.progress.options.finish={width:0};this.slider.progress.options.complete=null;this.slider.progress.animate()}},resetProgress:function(){this.slider.progress&&this.slider.progress.stop();this.node.sliderProgressBar.style.width=0},slideNext:function(){return this.slide("next")},slidePrev:function(){return this.slide("prev")},slide:function(d){if(!this.product.slider||!this.product.slider.CONT){return}var c=this.getEntity(this.product.slider.CONT,"slider-control",".active"),f=this.getItemForDirection(d,c);BX.removeClass(c,"active");this.selectSliderImg(f);this.slider.interval&&this.cycleSlider()},getItemForDirection:function(f,d){var h=this.getItemIndex(d),g=f==="prev"?-1:1,c=(h+g)%this.product.slider.COUNT;return this.eq(this.product.slider.ITEMS,c)},getItemIndex:function(c){return BX.util.array_values(this.product.slider.ITEMS).indexOf(c)},eq:function(d,c){var g=d.length,f=+c+(c<0?g:0);return f>=0&&f<g?d[f]:{}},scrollToProduct:function(){var c=BX.GetWindowScrollPos().scrollTop,d=BX.pos(this.obProduct).top-30;if(c>d){new BX.easing({duration:500,start:{scroll:c},finish:{scroll:d},transition:BX.easing.makeEaseOut(BX.easing.transitions.quint),step:BX.delegate(function(e){b.scrollTo(0,e.scroll)},this)}).animate()}},checkTopPanels:function(){var d=BX.GetWindowScrollPos().scrollTop,c;if(this.smallCardNodes.panel){c=BX.pos(this.smallCardNodes.aligner).bottom-50;if(d>c){BX.addClass(this.smallCardNodes.panel,"active")}else{if(BX.hasClass(this.smallCardNodes.panel,"active")){BX.removeClass(this.smallCardNodes.panel,"active")}}}if(this.obTabsPanel){c=BX.pos(this.obTabs).top;if(d+73>c){BX.addClass(this.obTabsPanel,"active")}else{if(BX.hasClass(this.obTabsPanel,"active")){BX.removeClass(this.obTabsPanel,"active")}}}},changeTab:function(d){BX.PreventDefault(d);var k=BX.proxy_context&&BX.proxy_context.getAttribute("data-value"),g,c,j;if(!BX.hasClass(BX.proxy_context,"active")&&k){g=this.getEntities(this.obTabContainers,"tab-container");for(var l in g){if(g.hasOwnProperty(l)&&BX.type.isDomNode(g[l])){if(g[l].getAttribute("data-value")===k){BX.show(g[l])}else{BX.hide(g[l])}}}c=this.getEntities(this.obTabs,"tab");j=this.getEntities(this.obTabsPanel,"tab");for(l in c){if(c.hasOwnProperty(l)&&BX.type.isDomNode(c[l])){if(c[l].getAttribute("data-value")===k){BX.addClass(c[l],"active");BX.addClass(j[l],"active")}else{BX.removeClass(c[l],"active");BX.removeClass(j[l],"active")}}}}var m=BX.GetWindowScrollPos().scrollTop,f=BX.pos(this.obTabContainers).top;if(m+150>f){new BX.easing({duration:500,start:{scroll:m},finish:{scroll:f-150},transition:BX.easing.makeEaseOut(BX.easing.transitions.quint),step:BX.delegate(function(e){b.scrollTo(0,e.scroll)},this)}).animate()}},initPopup:function(){if(this.config.usePopup){this.node.imageContainer.style.cursor="zoom-in";BX.bind(this.node.imageContainer,"click",BX.delegate(this.toggleMainPictPopup,this));BX.bind(document,"keyup",BX.proxy(this.closeByEscape,this));BX.bind(this.getEntity(this.obBigSlider,"close-popup"),"click",BX.proxy(this.hideMainPictPopup,this))}},checkSliderControls:function(d){var c=d>1?"":"none";this.node.sliderControlLeft&&(this.node.sliderControlLeft.style.display=c);this.node.sliderControlRight&&(this.node.sliderControlRight.style.display=c)},setCurrentImg:function(f,d,h){var g,c;this.currentImg.id=f.ID;this.currentImg.src=f.SRC;this.currentImg.width=f.WIDTH;this.currentImg.height=f.HEIGHT;if(d&&this.node.imageContainer){g=this.getEntities(this.node.imageContainer,"image");c=g.length;while(c--){if(g[c].getAttribute("data-id")==f.ID){if(!BX.hasClass(g[c],"active")){this.node.sliderProgressBar&&this.resetProgress()}BX.addClass(g[c],"active")}else{if(BX.hasClass(g[c],"active")){BX.removeClass(g[c],"active")}}}}if(h&&this.smallCardNodes.picture){this.smallCardNodes.picture.setAttribute("src",this.currentImg.src)}if(this.config.useMagnifier&&!this.isTouchDevice){this.setMagnifierParams();if(d){this.disableMagnifier(true)}}},setMagnifierParams:function(){var d=this.getEntities(this.node.imageContainer,"image"),c=d.length,f;while(c--){f=d[c].querySelector("img");f.setAttribute("data-title",f.getAttribute("title")||"");f.removeAttribute("title");if(d[c].getAttribute("data-id")==this.currentImg.id){BX.unbind(this.currentImg.node,"mouseover",BX.proxy(this.enableMagnifier,this));this.currentImg.node=f;this.currentImg.node.style.backgroundImage="url('"+this.currentImg.src+"')";this.currentImg.node.style.backgroundSize="100% auto";BX.bind(this.currentImg.node,"mouseover",BX.proxy(this.enableMagnifier,this))}}},enableMagnifier:function(){BX.bind(document,"mousemove",BX.proxy(this.moveMagnifierArea,this))},disableMagnifier:function(c){if(!this.magnify.enabled){return}clearTimeout(this.magnify.timer);BX.removeClass(this.obBigSlider,"magnified");this.magnify.enabled=false;this.currentImg.node.style.backgroundSize="100% auto";if(c){this.currentImg.node.style.height=this.magnify.height+"px";this.currentImg.node.style.width=this.magnify.width+"px";this.magnify.timer=setTimeout(BX.delegate(function(){this.currentImg.node.src=this.currentImg.src;this.currentImg.node.style.height="";this.currentImg.node.style.width=""},this),250)}else{this.currentImg.node.src=this.currentImg.src;this.currentImg.node.style.height="";this.currentImg.node.style.width=""}BX.unbind(document,"mousemove",BX.proxy(this.moveMagnifierArea,this))},moveMagnifierArea:function(q){var j=BX.pos(this.currentImg.node),m=this.inRect(q,j);if(this.inBound(j,m)){var u=m.X/this.currentImg.node.width*100,p=m.Y/this.currentImg.node.height*100,c,d,f,k,g;this.currentImg.node.style.backgroundPosition=u+"% "+p+"%";if(!this.magnify.enabled){clearTimeout(this.magnify.timer);BX.addClass(this.obBigSlider,"magnified");this.currentImg.node.style.height=(this.magnify.height=this.currentImg.node.clientHeight)+"px";this.currentImg.node.style.width=(this.magnify.width=this.currentImg.node.offsetWidth)+"px";c=this.currentImg.width/this.currentImg.height;d=this.obBigSlider.offsetWidth;if(d>this.currentImg.width&&!BX.hasClass(this.obBigSlider,"popup")){f=d;k=f/c;g=100}else{f=this.currentImg.width;k=this.currentImg.height;g=this.config.magnifierZoomPercent>100?this.config.magnifierZoomPercent:100}this.currentImg.node.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQI12P4zwAAAgEBAKrChTYAAAAASUVORK5CYII=";this.currentImg.node.style.backgroundSize=g+"% auto";this.magnify.timer=setTimeout(BX.delegate(function(){this.currentImg.node.style.height=k+"px";this.currentImg.node.style.width=f+"px"},this),10)}this.magnify.enabled=true}else{this.disableMagnifier(true)}},inBound:function(d,c){return c.Y>=0&&d.height>=c.Y&&(c.X>=0&&d.width>=c.X)},inRect:function(d,c){var g=BX.GetWindowSize(),f={X:0,Y:0,globalX:0,globalY:0};f.globalX=d.clientX+g.scrollLeft;if(d.offsetX&&d.offsetX<0){f.globalX-=d.offsetX}f.X=f.globalX-c.left;f.globalY=d.clientY+g.scrollTop;if(d.offsetY&&d.offsetY<0){f.globalY-=d.offsetY}f.Y=f.globalY-c.top;return f},setProductMainPict:function(f){var d=-1,h=0,g=0,c="";if(this.product.sliderCount){for(g=0;g<this.product.sliderPict.length;g++){if(f===this.product.sliderPict[g].ID){d=g;break}}if(d>-1){if(this.product.sliderPict[d]){this.setCurrentImg(this.product.sliderPict[d],true)}for(h=0;h<this.product.slider.ITEMS.length;h++){c=this.product.slider.ITEMS[h].getAttribute("data-value");if(c===f){BX.addClass(this.product.slider.ITEMS[h],"active")}else{if(BX.hasClass(this.product.slider.ITEMS[h],"active")){BX.removeClass(this.product.slider.ITEMS[h],"active")}}}}}},onSliderControlHover:function(){var c=BX.proxy_context;this.mouseTimer=setTimeout(BX.delegate(function(){this.selectSliderImg(c)},this),200)},onSliderControlLeave:function(){clearTimeout(this.mouseTimer);this.mouseTimer=null},selectSliderImg:function(d){var c="",f=[];d=BX.type.isDomNode(d)?d:BX.proxy_context;if(d&&d.hasAttribute("data-value")){c=d.getAttribute("data-value");if(c.indexOf("_")!==-1){f=c.split("_");this.setMainPict(f[0],f[1])}else{this.setProductMainPict(c)}}},setMainPict:function(m,g,k){var p=-1,l=-1,c,d,f="",j="";for(c=0;c<this.offers.length;c++){if(m===this.offers[c].ID){p=c;break}}if(p>-1){if(this.offers[p].SLIDER_COUNT>0){for(d=0;d<this.offers[p].SLIDER.length;d++){if(g===this.offers[p].SLIDER[d].ID){l=d;break}}if(l>-1){if(this.offers[p].SLIDER[l]){this.setCurrentImg(this.offers[p].SLIDER[l],true,k)}j=m+"_"+g;for(c=0;c<this.product.slider.ITEMS.length;c++){f=this.product.slider.ITEMS[c].getAttribute("data-value");if(f===j){BX.addClass(this.product.slider.ITEMS[c],"active")}else{if(BX.hasClass(this.product.slider.ITEMS[c],"active")){BX.removeClass(this.product.slider.ITEMS[c],"active")}}}}}}},setMainPictFromItem:function(d){if(this.node.imageContainer){var c=false,f={};if(this.offers[d]){if(this.offers[d].DETAIL_PICTURE){f=this.offers[d].DETAIL_PICTURE;c=true}else{if(this.offers[d].PREVIEW_PICTURE){f=this.offers[d].PREVIEW_PICTURE;c=true}}}if(!c){if(this.defaultPict.detail){f=this.defaultPict.detail;c=true}else{if(this.defaultPict.preview){f=this.defaultPict.preview;c=true}}}if(c){this.setCurrentImg(f,true,true)}}},toggleMainPictPopup:function(){if(BX.hasClass(this.obBigSlider,"popup")){this.hideMainPictPopup()}else{this.showMainPictPopup()}},showMainPictPopup:function(){this.config.useMagnifier&&this.disableMagnifier(false);BX.addClass(this.obBigSlider,"popup");this.node.imageContainer.style.cursor="";document.body.style.overflow="hidden"},hideMainPictPopup:function(){this.config.useMagnifier&&this.disableMagnifier(false);BX.removeClass(this.obBigSlider,"popup");this.node.imageContainer.style.cursor="zoom-in";document.body.style.overflow=""},closeByEscape:function(c){c=c||b.event;if(c.keyCode==27){this.hideMainPictPopup()}},startQuantityInterval:function(){var d=BX.proxy_context;var c=d.id===this.visual.QUANTITY_DOWN_ID?BX.proxy(this.quantityDown,this):BX.proxy(this.quantityUp,this);this.quantityDelay=setTimeout(BX.delegate(function(){this.quantityTimer=setInterval(c,150)},this),300)},clearQuantityInterval:function(){clearTimeout(this.quantityDelay);clearInterval(this.quantityTimer)},quantityUp:function(){var d=0,c=true;if(this.errorCode===0&&this.config.showQuantity&&this.canBuy&&!this.isGift){d=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10);if(!isNaN(d)){d+=this.stepQuantity;d=this.checkQuantityRange(d,"up");if(this.checkQuantity&&d>this.maxQuantity){c=false}if(c){if(this.isDblQuantity){d=Math.round(d*this.precisionFactor)/this.precisionFactor}this.obQuantity.value=d;this.setPrice()}}}},quantityDown:function(){var d=0,c=true;if(this.errorCode===0&&this.config.showQuantity&&this.canBuy&&!this.isGift){d=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10);if(!isNaN(d)){d-=this.stepQuantity;d=this.checkQuantityRange(d,"down");if(d<this.minQuantity){c=false}if(c){if(this.isDblQuantity){d=Math.round(d*this.precisionFactor)/this.precisionFactor}this.obQuantity.value=d;this.setPrice()}}}},quantityChange:function(){var d=0,c;if(this.errorCode===0&&this.config.showQuantity){if(this.canBuy){d=this.isDblQuantity?parseFloat(this.obQuantity.value):Math.round(this.obQuantity.value);if(!isNaN(d)){d=this.checkQuantityRange(d);if(this.checkQuantity){if(d>this.maxQuantity){d=this.maxQuantity}}this.checkPriceRange(d);c=Math.floor(Math.round(d*this.precisionFactor/this.stepQuantity)/this.precisionFactor)||1;d=c<=1?this.stepQuantity:c*this.stepQuantity;d=Math.round(d*this.precisionFactor)/this.precisionFactor;if(d<this.minQuantity){d=this.minQuantity}this.obQuantity.value=d}else{this.obQuantity.value=this.minQuantity}}else{this.obQuantity.value=this.minQuantity}this.setPrice()}},quantitySet:function(f){var d,j;var g=this.offers[f],c=this.offers[this.offerNum];if(this.errorCode===0){this.canBuy=g.CAN_BUY;this.currentPriceMode=g.ITEM_PRICE_MODE;this.currentPrices=g.ITEM_PRICES;this.currentPriceSelected=g.ITEM_PRICE_SELECTED;this.currentQuantityRanges=g.ITEM_QUANTITY_RANGES;this.currentQuantityRangeSelected=g.ITEM_QUANTITY_RANGE_SELECTED;if(this.canBuy){this.node.quantity&&BX.style(this.node.quantity,"display","");this.obBasketActions&&BX.style(this.obBasketActions,"display","");this.smallCardNodes.buyButton&&BX.style(this.smallCardNodes.buyButton,"display","");this.smallCardNodes.addButton&&BX.style(this.smallCardNodes.addButton,"display","");this.obNotAvail&&BX.style(this.obNotAvail,"display","none");this.smallCardNodes.notAvailableButton&&BX.style(this.smallCardNodes.notAvailableButton,"display","none");this.obSubscribe&&BX.style(this.obSubscribe,"display","none")}else{this.node.quantity&&BX.style(this.node.quantity,"display","none");this.obBasketActions&&BX.style(this.obBasketActions,"display","none");this.smallCardNodes.buyButton&&BX.style(this.smallCardNodes.buyButton,"display","none");this.smallCardNodes.addButton&&BX.style(this.smallCardNodes.addButton,"display","none");this.obNotAvail&&BX.style(this.obNotAvail,"display","");this.smallCardNodes.notAvailableButton&&BX.style(this.smallCardNodes.notAvailableButton,"display","");if(this.obSubscribe){if(g.CATALOG_SUBSCRIBE==="Y"){BX.style(this.obSubscribe,"display","");this.obSubscribe.setAttribute("data-item",g.ID);BX(this.visual.SUBSCRIBE_LINK+"_hidden").click()}else{BX.style(this.obSubscribe,"display","none")}}}this.isDblQuantity=g.QUANTITY_FLOAT;this.checkQuantity=g.CHECK_QUANTITY;if(this.isDblQuantity){this.stepQuantity=Math.round(parseFloat(g.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor;this.maxQuantity=parseFloat(g.MAX_QUANTITY);this.minQuantity=this.currentPriceMode==="Q"?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity}else{this.stepQuantity=parseInt(g.STEP_QUANTITY,10);this.maxQuantity=parseInt(g.MAX_QUANTITY,10);this.minQuantity=this.currentPriceMode==="Q"?parseInt(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity}if(this.config.showQuantity){var h=c.ITEM_PRICES.length&&c.ITEM_PRICES[c.ITEM_PRICE_SELECTED]&&c.ITEM_PRICES[c.ITEM_PRICE_SELECTED].MIN_QUANTITY!=this.minQuantity;if(this.isDblQuantity){j=Math.round(parseFloat(c.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor!==this.stepQuantity||h||c.MEASURE!==g.MEASURE||this.checkQuantity&&parseFloat(c.MAX_QUANTITY)>this.maxQuantity&&parseFloat(this.obQuantity.value)>this.maxQuantity}else{j=parseInt(c.STEP_QUANTITY,10)!==this.stepQuantity||h||c.MEASURE!==g.MEASURE||this.checkQuantity&&parseInt(c.MAX_QUANTITY,10)>this.maxQuantity&&parseInt(this.obQuantity.value,10)>this.maxQuantity}this.obQuantity.disabled=!this.canBuy;if(j){this.obQuantity.value=this.minQuantity}if(this.obMeasure){if(g.MEASURE){BX.adjust(this.obMeasure,{html:g.MEASURE})}else{BX.adjust(this.obMeasure,{html:""})}}}if(this.obQuantityLimit.all){if(!this.checkQuantity||this.maxQuantity==0){BX.adjust(this.obQuantityLimit.value,{html:""});BX.adjust(this.obQuantityLimit.all,{style:{display:"none"}})}else{if(this.config.showMaxQuantity==="M"){d=this.maxQuantity/this.stepQuantity>=this.config.relativeQuantityFactor?BX.message("RELATIVE_QUANTITY_MANY"):BX.message("RELATIVE_QUANTITY_FEW")}else{d=this.maxQuantity;if(g.MEASURE){d+=" "+g.MEASURE}}BX.adjust(this.obQuantityLimit.value,{html:d});BX.adjust(this.obQuantityLimit.all,{style:{display:""}})}}if(this.config.usePriceRanges&&this.obPriceRanges){if(this.currentPriceMode==="Q"&&g.PRICE_RANGES_HTML){var k=this.getEntity(this.obPriceRanges,"price-ranges-body"),l=this.getEntity(this.obPriceRanges,"price-ranges-ratio-header");if(k){k.innerHTML=g.PRICE_RANGES_HTML}if(l){l.innerHTML=g.PRICE_RANGES_RATIO_HTML}this.obPriceRanges.style.display=""}else{this.obPriceRanges.style.display="none"}}}},selectOfferProp:function(){var f=0,d="",j=[],g=null,c=BX.proxy_context,h;if(c&&c.hasAttribute("data-treevalue")){if(BX.hasClass(c,"selected")){return}if(typeof document.activeElement==="object"){document.activeElement.blur()}d=c.getAttribute("data-treevalue");j=d.split("_");this.searchOfferPropIndex(j[0],j[1]);g=BX.findChildren(c.parentNode,{tagName:"li"},false);if(g&&g.length){for(f=0;f<g.length;f++){BX.removeClass(g[f],"selected")}}BX.addClass(c,"selected");if(this.smallCardNodes.panel){h=this.smallCardNodes.panel.querySelector('[data-treevalue="'+d+'"]');if(h){g=this.smallCardNodes.panel.querySelectorAll('[data-sku-line="'+h.getAttribute("data-sku-line")+'"]');for(f=0;f<g.length;f++){g[f].style.display="none"}h.style.display=""}}if(this.isFacebookConversionCustomizeProductEventEnabled&&BX.Type.isArrayFilled(this.offers)&&BX.Type.isObject(this.offers[this.offerNum])){BX.ajax.runAction("sale.facebookconversion.customizeProduct",{data:{offerId:this.offers[this.offerNum]["ID"]}})}}},searchOfferPropIndex:function(v,j){var m="",w=false,p=[],c=[],d=-1,f,k,g={},q=[];for(f=0;f<this.treeProps.length;f++){if(this.treeProps[f].ID===v){d=f;break}}if(d>-1){for(f=0;f<d;f++){m="PROP_"+this.treeProps[f].ID;g[m]=this.selectedValues[m]}m="PROP_"+this.treeProps[d].ID;g[m]=j;for(f=d+1;f<this.treeProps.length;f++){m="PROP_"+this.treeProps[f].ID;w=this.getRowValues(g,m);if(!w){break}c=[];if(this.config.showAbsent){p=[];q=[];q=BX.clone(g,true);for(k=0;k<w.length;k++){q[m]=w[k];c[c.length]=w[k];if(this.getCanBuy(q)){p[p.length]=w[k]}}}else{p=w}if(this.selectedValues[m]&&BX.util.in_array(this.selectedValues[m],p)){g[m]=this.selectedValues[m]}else{if(this.config.showAbsent){g[m]=p.length?p[0]:c[0]}else{g[m]=p[0]}}this.updateRow(f,g[m],w,p)}this.selectedValues=g;this.changeInfo()}},updateRow:function(m,g,k,p){var l=0,c="",d=false,f=null;var j=this.getEntities(this.obTree,"sku-line-block");if(m>-1&&m<j.length){f=j[m].querySelectorAll("li");for(l=0;l<f.length;l++){c=f[l].getAttribute("data-onevalue");d=c===g;if(d){BX.addClass(f[l],"selected")}else{BX.removeClass(f[l],"selected")}if(BX.util.in_array(c,p)){BX.removeClass(f[l],"notallowed")}else{BX.addClass(f[l],"notallowed")}f[l].style.display=BX.util.in_array(c,k)?"":"none";if(d){j[m].style.display=c==0&&p.length==1?"none":""}}if(this.smallCardNodes.panel){f=this.smallCardNodes.panel.querySelectorAll('[data-sku-line="'+m+'"]');for(l=0;l<f.length;l++){c=f[l].getAttribute("data-onevalue");d=c===g;if(d){f[l].style.display=""}else{f[l].style.display="none"}if(BX.util.in_array(c,p)){BX.removeClass(f[l],"notallowed")}else{BX.addClass(f[l],"notallowed")}if(d){f[l].style.display=c==0&&p.length==1?"none":""}}}}},getRowValues:function(f,d){var j=[],g=0,c=0,h=false,k=true;if(f.length===0){for(g=0;g<this.offers.length;g++){if(!BX.util.in_array(this.offers[g].TREE[d],j)){j[j.length]=this.offers[g].TREE[d]}}h=true}else{for(g=0;g<this.offers.length;g++){k=true;for(c in f){if(f[c]!==this.offers[g].TREE[c]){k=false;break}}if(k){if(!BX.util.in_array(this.offers[g].TREE[d],j)){j[j.length]=this.offers[g].TREE[d]}h=true}}}return h?j:false},getCanBuy:function(f){var d,h=0,g=true,c=false;for(d=0;d<this.offers.length;d++){g=true;for(h in f){if(f[h]!==this.offers[d].TREE[h]){g=false;break}}if(g){if(this.offers[d].CAN_BUY){c=true;break}}}return c},setCurrent:function(){var f,d=0,j="",g=false,c=[],h={},k=[],l=this.offers[this.offerNum].TREE;for(f=0;f<this.treeProps.length;f++){j="PROP_"+this.treeProps[f].ID;g=this.getRowValues(h,j);if(!g){break}if(BX.util.in_array(l[j],g)){h[j]=l[j]}else{h[j]=g[0];this.offerNum=0}if(this.config.showAbsent){c=[];k=[];k=BX.clone(h,true);for(d=0;d<g.length;d++){k[j]=g[d];if(this.getCanBuy(k)){c[c.length]=g[d]}}}else{c=g}this.updateRow(f,h[j],g,c)}this.selectedValues=h;this.changeInfo()},changeInfo:function(){var f=-1,d=0,j=true,g={currentId:this.offerNum>-1?this.offers[this.offerNum].ID:0,newId:0};var c,h;for(c=0;c<this.offers.length;c++){j=true;for(d in this.selectedValues){if(this.selectedValues[d]!==this.offers[c].TREE[d]){j=false;break}}if(j){f=c;break}}if(f>-1){if(f!=this.offerNum){this.isGift=false}this.drawImages(this.offers[f].SLIDER);this.checkSliderControls(this.offers[f].SLIDER_COUNT);for(c=0;c<this.offers.length;c++){if(this.config.showOfferGroup&&this.offers[c].OFFER_GROUP){if(h=BX(this.visual.OFFER_GROUP+this.offers[c].ID)){h.style.display=c==f?"":"none"}}if(this.slider.controls[c].ID){if(c===f){this.product.slider=this.slider.controls[c];this.slider.controls[c].CONT&&BX.show(this.slider.controls[c].CONT)}else{this.slider.controls[c].CONT&&BX.hide(this.slider.controls[c].CONT)}}else{if(c===f){this.product.slider={}}}}if(this.offers[f].SLIDER_COUNT>0){this.setMainPict(this.offers[f].ID,this.offers[f].SLIDER[0].ID,true)}else{this.setMainPictFromItem(f)}if(this.offers[f].SLIDER_COUNT>1){this.initSlider()}else{this.stopSlider()}if(this.obDescription&&this.config.showSkuDescription==="Y"){this.changeSkuDescription(f)}if(this.config.showSkuProps){if(this.obSkuProps){if(!this.offers[f].DISPLAY_PROPERTIES){BX.adjust(this.obSkuProps,{style:{display:"none"},html:""})}else{BX.adjust(this.obSkuProps,{style:{display:""},html:this.offers[f].DISPLAY_PROPERTIES})}}if(this.obMainSkuProps){if(!this.offers[f].DISPLAY_PROPERTIES_MAIN_BLOCK){BX.adjust(this.obMainSkuProps,{style:{display:"none"},html:""})}else{BX.adjust(this.obMainSkuProps,{style:{display:""},html:this.offers[f].DISPLAY_PROPERTIES_MAIN_BLOCK})}}}this.quantitySet(f);this.setPrice();this.setCompared(this.offers[f].COMPARED);this.offerNum=f;this.fixFontCheck();this.setAnalyticsDataLayer("showDetail");this.incViewedCounter();g.newId=this.offers[this.offerNum].ID;BX.onCustomEvent("onCatalogStoreProductChange",[this.offers[this.offerNum].ID]);BX.onCustomEvent("onCatalogElementChangeOffer",[g]);g=null}},changeSkuDescription:function(d){var c="";var g="";var f="";if(this.offers[d].DETAIL_TEXT!==""){c=this.offers[d].DETAIL_TEXT_TYPE==="html"?this.offers[d].DETAIL_TEXT:"<p>"+this.offers[d].DETAIL_TEXT+"</p>"}else{if(this.product.detailText!==""){c=this.product.detailTextType==="html"?this.product.detailText:"<p>"+this.product.detailText+"</p>"}}if(this.offers[d].PREVIEW_TEXT!==""){g=this.offers[d].PREVIEW_TEXT_TYPE==="html"?this.offers[d].PREVIEW_TEXT:"<p>"+this.offers[d].PREVIEW_TEXT+"</p>"}else{if(this.product.previewText!==""){g=this.product.previewTextType==="html"?this.product.previewText:"<p>"+this.product.previewText+"</p>"}}if(g!==""&&(this.config.displayPreviewTextMode==="S"||this.config.displayPreviewTextMode==="E"&&c)){f+=g}if(c!==""){f+=c}BX.adjust(this.obDescription,{html:f})},drawImages:function(d){if(!this.node.imageContainer){return}var c,g,f=this.getEntities(this.node.imageContainer,"image");for(c in f){if(f.hasOwnProperty(c)&&BX.type.isDomNode(f[c])){BX.remove(f[c])}}for(c=0;c<d.length;c++){g=BX.create("IMG",{props:{src:d[c].SRC,alt:this.config.alt,title:this.config.title}});if(c==0){g.setAttribute("itemprop","image")}this.node.imageContainer.appendChild(BX.create("DIV",{attrs:{"data-entity":"image","data-id":d[c].ID},props:{className:"product-item-detail-slider-image"+(c==0?" active":"")},children:[g]}))}},restoreSticker:function(){if(this.previousStickerText){this.redrawSticker({text:this.previousStickerText})}else{this.hideSticker()}},hideSticker:function(){BX.hide(BX(this.visual.STICKER_ID))},redrawSticker:function(d){d=d||{};var c=d.text||"";var g=BX(this.visual.STICKER_ID);if(!g){return}BX.show(g);var f=g.getAttribute("title");if(f&&f!=c){this.previousStickerText=f}BX.adjust(g,{text:c,attrs:{title:c}})},checkQuantityRange:function(q,j){if(typeof q==="undefined"||this.currentPriceMode!=="Q"){return q}q=parseFloat(q);var m=q;var u,p,c,d,f,k;for(var g in this.currentQuantityRanges){if(this.currentQuantityRanges.hasOwnProperty(g)){u=this.currentQuantityRanges[g];if(parseFloat(q)>=parseFloat(u.SORT_FROM)&&(u.SORT_TO==="INF"||parseFloat(q)<=parseFloat(u.SORT_TO))){m=q;break}else{p=parseFloat(u.SORT_FROM)-q;c=Math.abs(p);d=parseFloat(u.SORT_TO)-q;f=Math.abs(d);if(k===undefined||k>c){if(j===undefined||j==="up"&&p>0||j==="down"&&p<0){k=c;m=parseFloat(u.SORT_FROM)}}if(k===undefined||k>f){if(j===undefined||j==="up"&&p>0||j==="down"&&p<0){k=f;m=parseFloat(u.SORT_TO)}}}}}return m},checkPriceRange:function(f){if(typeof f==="undefined"||this.currentPriceMode!=="Q"){return}var d,h=false;for(var g in this.currentQuantityRanges){if(this.currentQuantityRanges.hasOwnProperty(g)){d=this.currentQuantityRanges[g];if(parseFloat(f)>=parseFloat(d.SORT_FROM)&&(d.SORT_TO==="INF"||parseFloat(f)<=parseFloat(d.SORT_TO))){h=true;this.currentQuantityRangeSelected=d.HASH;break}}}if(!h&&(d=this.getMinPriceRange())){this.currentQuantityRangeSelected=d.HASH}for(var c in this.currentPrices){if(this.currentPrices.hasOwnProperty(c)){if(this.currentPrices[c].QUANTITY_HASH==this.currentQuantityRangeSelected){this.currentPriceSelected=c;break}}}},getMinPriceRange:function(){var d;for(var c in this.currentQuantityRanges){if(this.currentQuantityRanges.hasOwnProperty(c)){if(!d||parseInt(this.currentQuantityRanges[c].SORT_FROM)<parseInt(d.SORT_FROM)){d=this.currentQuantityRanges[c]}}}return d},checkQuantityControls:function(){if(!this.obQuantity){return}var d=this.checkQuantity&&parseFloat(this.obQuantity.value)+this.stepQuantity>this.maxQuantity,c=parseFloat(this.obQuantity.value)-this.stepQuantity<this.minQuantity;if(d){BX.addClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")}else{if(BX.hasClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")){BX.removeClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")}}if(c){BX.addClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")}else{if(BX.hasClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")){BX.removeClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")}}if(d&&c){this.obQuantity.setAttribute("disabled","disabled")}else{this.obQuantity.removeAttribute("disabled")}},setPrice:function(){var d="",c;if(this.obQuantity){this.checkPriceRange(this.obQuantity.value)}this.checkQuantityControls();c=this.currentPrices[this.currentPriceSelected];if(this.isGift){c.PRICE=0;c.DISCOUNT=c.BASE_PRICE;c.PERCENT=100}if(this.obPrice.price){if(c){BX.adjust(this.obPrice.price,{html:BX.Currency.currencyFormat(c.RATIO_PRICE,c.CURRENCY,true)});this.smallCardNodes.price&&BX.adjust(this.smallCardNodes.price,{html:BX.Currency.currencyFormat(c.RATIO_PRICE,c.CURRENCY,true)})}else{BX.adjust(this.obPrice.price,{html:""});this.smallCardNodes.price&&BX.adjust(this.smallCardNodes.price,{html:""})}if(c&&c.RATIO_PRICE!==c.RATIO_BASE_PRICE){if(this.config.showOldPrice){this.obPrice.full&&BX.adjust(this.obPrice.full,{style:{display:""},html:BX.Currency.currencyFormat(c.RATIO_BASE_PRICE,c.CURRENCY,true)});this.smallCardNodes.oldPrice&&BX.adjust(this.smallCardNodes.oldPrice,{style:{display:""},html:BX.Currency.currencyFormat(c.RATIO_BASE_PRICE,c.CURRENCY,true)});if(this.obPrice.discount){d=BX.message("ECONOMY_INFO_MESSAGE");d=d.replace("#ECONOMY#",BX.Currency.currencyFormat(c.RATIO_DISCOUNT,c.CURRENCY,true));BX.adjust(this.obPrice.discount,{style:{display:""},html:d})}}if(this.config.showPercent){this.obPrice.percent&&BX.adjust(this.obPrice.percent,{style:{display:""},html:-c.PERCENT+"%"})}}else{if(this.config.showOldPrice){this.obPrice.full&&BX.adjust(this.obPrice.full,{style:{display:"none"},html:""});this.smallCardNodes.oldPrice&&BX.adjust(this.smallCardNodes.oldPrice,{style:{display:"none"},html:""});this.obPrice.discount&&BX.adjust(this.obPrice.discount,{style:{display:"none"},html:""})}if(this.config.showPercent){this.obPrice.percent&&BX.adjust(this.obPrice.percent,{style:{display:"none"},html:""})}}if(this.obPrice.total){if(c&&this.obQuantity&&this.obQuantity.value!=this.stepQuantity){BX.adjust(this.obPrice.total,{html:BX.message("PRICE_TOTAL_PREFIX")+" <strong>"+BX.Currency.currencyFormat(c.PRICE*this.obQuantity.value,c.CURRENCY,true)+"</strong>",style:{display:""}})}else{BX.adjust(this.obPrice.total,{html:"",style:{display:"none"}})}}}},compare:function(f){var d=this.obCompare.querySelector('[data-entity="compare-checkbox"]'),j=BX.getEventTarget(f),g=true;if(d){g=j===d?d.checked:!d.checked}var c=g?this.compareData.compareUrl:this.compareData.compareDeleteUrl,h;if(c){if(j!==d){BX.PreventDefault(f);this.setCompared(g)}switch(this.productType){case 0:case 1:case 2:h=c.replace("#ID#",this.product.id.toString());break;case 3:h=c.replace("#ID#",this.offers[this.offerNum].ID);break}BX.ajax({method:"POST",dataType:g?"json":"html",url:h+(h.indexOf("?")!==-1?"&":"?")+"ajax_action=Y",onsuccess:g?BX.proxy(this.compareResult,this):BX.proxy(this.compareDeleteResult,this)})}},compareResult:function(c){var f,d;if(this.obPopupWin){this.obPopupWin.close()}if(!BX.type.isPlainObject(c)){return}this.initPopupWindow();if(this.offers.length>0){this.offers[this.offerNum].COMPARED=c.STATUS==="OK"}if(c.STATUS==="OK"){BX.onCustomEvent("OnCompareChange");f='<div style="width: 100%; margin: 0; text-align: center;"><p>'+BX.message("COMPARE_MESSAGE_OK")+"</p></div>";if(this.config.showClosePopup){d=[new a({text:BX.message("BTN_MESSAGE_COMPARE_REDIRECT"),events:{click:BX.delegate(this.compareRedirect,this)},style:{marginRight:"10px"}}),new a({text:BX.message("BTN_MESSAGE_DETAIL_CLOSE_POPUP"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}else{d=[new a({text:BX.message("BTN_MESSAGE_COMPARE_REDIRECT"),events:{click:BX.delegate(this.compareRedirect,this)}})]}}else{f='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(c.MESSAGE?c.MESSAGE:BX.message("COMPARE_UNKNOWN_ERROR"))+"</p></div>";d=[new a({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}this.obPopupWin.setTitleBar(BX.message("COMPARE_TITLE"));this.obPopupWin.setContent(f);this.obPopupWin.setButtons(d);this.obPopupWin.show()},compareDeleteResult:function(){BX.onCustomEvent("OnCompareChange");if(this.offers&&this.offers.length){this.offers[this.offerNum].COMPARED=false}},setCompared:function(d){if(!this.obCompare){return}var c=this.getEntity(this.obCompare,"compare-checkbox");if(c){c.checked=d}},setCompareInfo:function(d){if(!BX.type.isArray(d)){return}for(var c in this.offers){if(this.offers.hasOwnProperty(c)){this.offers[c].COMPARED=BX.util.in_array(this.offers[c].ID,d)}}},compareRedirect:function(){if(this.compareData.comparePath){location.href=this.compareData.comparePath}else{this.obPopupWin.close()}},checkDeletedCompare:function(d){switch(this.productType){case 0:case 1:case 2:if(this.product.id==d){this.setCompared(false)}break;case 3:var c=this.offers.length;while(c--){if(this.offers[c].ID==d){this.offers[c].COMPARED=false;if(this.offerNum==c){this.setCompared(false)}break}}}},initBasketUrl:function(){this.basketUrl=this.basketMode==="ADD"?this.basketData.add_url:this.basketData.buy_url;switch(this.productType){case 1:case 2:this.basketUrl=this.basketUrl.replace("#ID#",this.product.id.toString());break;case 3:this.basketUrl=this.basketUrl.replace("#ID#",this.offers[this.offerNum].ID);break}this.basketParams={ajax_basket:"Y"};if(this.config.showQuantity){this.basketParams[this.basketData.quantity]=this.obQuantity.value}if(this.basketData.sku_props){this.basketParams[this.basketData.sku_props_var]=this.basketData.sku_props}},fillBasketProps:function(){if(!this.visual.BASKET_PROP_DIV){return}var d=0,c=null,g=false,f=null;if(this.basketData.useProps&&!this.basketData.emptyProps){if(this.obPopupWin&&this.obPopupWin.contentContainer){f=this.obPopupWin.contentContainer}}else{f=BX(this.visual.BASKET_PROP_DIV)}if(f){c=f.getElementsByTagName("select");if(c&&c.length){for(d=0;d<c.length;d++){if(!c[d].disabled){switch(c[d].type.toLowerCase()){case"select-one":this.basketParams[c[d].name]=c[d].value;g=true;break;default:break}}}}c=f.getElementsByTagName("input");if(c&&c.length){for(d=0;d<c.length;d++){if(!c[d].disabled){switch(c[d].type.toLowerCase()){case"hidden":this.basketParams[c[d].name]=c[d].value;g=true;break;case"radio":if(c[d].checked){this.basketParams[c[d].name]=c[d].value;g=true}break;default:break}}}}}if(!g){this.basketParams[this.basketData.props]=[];this.basketParams[this.basketData.props][0]=0}},sendToBasket:function(){if(!this.canBuy){return}this.initBasketUrl();this.fillBasketProps();BX.ajax({method:"POST",dataType:"json",url:this.basketUrl,data:this.basketParams,onsuccess:BX.proxy(this.basketResult,this)})},add2Basket:function(){this.basketMode="ADD";this.basket()},buyBasket:function(){this.basketMode="BUY";this.basket()},basket:function(){var c="";if(!this.canBuy){return}switch(this.productType){case 1:case 2:if(this.basketData.useProps&&!this.basketData.emptyProps){this.initPopupWindow();this.obPopupWin.setTitleBar(BX.message("TITLE_BASKET_PROPS"));if(BX(this.visual.BASKET_PROP_DIV)){c=BX(this.visual.BASKET_PROP_DIV).innerHTML}this.obPopupWin.setContent(c);this.obPopupWin.setButtons([new a({text:BX.message("BTN_SEND_PROPS"),events:{click:BX.delegate(this.sendToBasket,this)}})]);this.obPopupWin.show()}else{this.sendToBasket()}break;case 3:this.sendToBasket();break}},basketResult:function(d){var g,f,c;if(this.obPopupWin){this.obPopupWin.close()}if(!BX.type.isPlainObject(d)){return}if(d.STATUS==="OK"){this.setAnalyticsDataLayer("addToCart")}if(d.STATUS==="OK"&&this.basketMode==="BUY"){this.basketRedirect()}else{this.initPopupWindow();if(d.STATUS==="OK"){BX.onCustomEvent("OnBasketChange");switch(this.productType){case 1:case 2:c=this.product.pict.SRC;break;case 3:c=this.offers[this.offerNum].PREVIEW_PICTURE?this.offers[this.offerNum].PREVIEW_PICTURE.SRC:this.defaultPict.pict.SRC;break}g='<div style="width: 100%; margin: 0; text-align: center;"><img src="'+c+'" height="130" style="max-height:130px"><p>'+this.product.name+"</p></div>";if(this.config.showClosePopup){f=[new a({text:BX.message("BTN_MESSAGE_DETAIL_BASKET_REDIRECT"),events:{click:BX.delegate(this.basketRedirect,this)},style:{marginRight:"10px"}}),new a({text:BX.message("BTN_MESSAGE_DETAIL_CLOSE_POPUP"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}else{f=[new a({text:BX.message("BTN_MESSAGE_DETAIL_BASKET_REDIRECT"),events:{click:BX.delegate(this.basketRedirect,this)}})]}}else{g='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(d.MESSAGE?d.MESSAGE:BX.message("BASKET_UNKNOWN_ERROR"))+"</p></div>";f=[new a({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}this.obPopupWin.setTitleBar(d.STATUS==="OK"?BX.message("TITLE_SUCCESSFUL"):BX.message("TITLE_ERROR"));this.obPopupWin.setContent(g);this.obPopupWin.setButtons(f);this.obPopupWin.show()}},basketRedirect:function(){location.href=this.basketData.basketUrl?this.basketData.basketUrl:BX.message("BASKET_URL")},initPopupWindow:function(){if(this.obPopupWin){return}this.obPopupWin=BX.PopupWindowManager.create("CatalogElementBasket_"+this.visual.ID,null,{autoHide:false,offsetLeft:0,offsetTop:0,overlay:true,closeByEsc:true,titleBar:true,closeIcon:true,contentColor:"white",className:this.config.templateTheme?"bx-"+this.config.templateTheme:""})},incViewedCounter:function(){if(this.currentIsSet&&!this.updateViewedCount){switch(this.productType){case 1:case 2:this.viewedCounter.params.PRODUCT_ID=this.product.id;this.viewedCounter.params.PARENT_ID=this.product.id;break;case 3:this.viewedCounter.params.PARENT_ID=this.product.id;this.viewedCounter.params.PRODUCT_ID=this.offers[this.offerNum].ID;break;default:return}this.viewedCounter.params.SITE_ID=BX.message("SITE_ID");this.updateViewedCount=true;BX.ajax.post(this.viewedCounter.path,this.viewedCounter.params,BX.delegate(function(){this.updateViewedCount=false},this))}},allowViewedCount:function(c){this.currentIsSet=true;if(c){this.incViewedCounter()}},fixFontCheck:function(){if(BX.type.isDomNode(this.obPrice.price)){BX.FixFontSize&&BX.FixFontSize.init({objList:[{node:this.obPrice.price,maxFontSize:28,smallestValue:false,scaleBy:this.obPrice.price.parentNode}],onAdaptiveResize:true})}}}})(window);(function(a){if(a.JCIblockVoteStars){return}a.JCIblockVoteStars=function(b){this.progressObj=null;this.ratingObj=null;this.starsObj=null;this.progressId="";this.ratingId="";this.starsId="";this.ajaxParams={};this.siteId="";this.voteData={element:0,percent:0,count:0};this.config={readOnly:false,alreadyVoted:true,request:false};if(BX.type.isPlainObject(b)){if(BX.type.isNotEmptyString(b.progressId)){this.progressId=b.progressId}if(BX.type.isNotEmptyString(b.ratingId)){this.ratingId=b.ratingId}if(BX.type.isNotEmptyString(b.starsId)){this.starsId=b.starsId}if(BX.type.isNotEmptyString(b.ajaxUrl)){this.ajaxUrl=b.ajaxUrl}if(BX.type.isNotEmptyString(b.checkVoteUrl)){this.checkVoteUrl=b.checkVoteUrl}if(BX.type.isPlainObject(b.ajaxParams)){this.ajaxParams=b.ajaxParams}if(BX.type.isNotEmptyString(b.siteId)){this.siteId=b.siteId}if(BX.type.isPlainObject(b.voteData)){if(BX.type.isNumber(b.voteData.element)){this.voteData.element=b.voteData.element}if(BX.type.isNumber(b.voteData.percent)){this.voteData.percent=this.preparePercent(b.voteData.percent)}if(BX.type.isNumber(b.voteData.count)){this.voteData.count=b.voteData.count}}if(BX.type.isBoolean(b.readOnly)){this.config.readOnly=b.readOnly}}BX.ready(BX.proxy(this.init,this))};a.JCIblockVoteStars.prototype.init=function(){if(BX.type.isNotEmptyString(this.progressId)){this.progressObj=BX(this.progressId)}if(BX.type.isNotEmptyString(this.ratingId)){this.ratingObj=BX(this.ratingId)}if(BX.type.isNotEmptyString(this.starsId)){this.starsObj=BX(this.starsId)}this.showProgress(this.voteData.percent);this.showVotes();this.checkVote()};a.JCIblockVoteStars.prototype.checkVote=function(){if(this.config.readOnly||this.voteData.element<=0){return}BX.ajax({timeout:30,method:"POST",dataType:"json",url:this.checkVoteUrl,data:{sessid:BX.bitrix_sessid(),checkVote:"Y",vote_id:this.voteData.element,site_id:this.siteId},onsuccess:BX.proxy(this.checkVoteResult,this)})};a.JCIblockVoteStars.prototype.checkVoteResult=function(b){if(BX.type.isPlainObject(b)){if(b.success){this.config.alreadyVoted=b.voted}}if(this.config.readOnly||this.config.alreadyVoted||this.voteData.element<=0){return}if(BX.type.isElementNode(this.starsObj)){BX.bind(this.starsObj,"mousemove",BX.proxy(this.handlerMouseMove,this));BX.bind(this.starsObj,"mouseout",BX.proxy(this.handlerMouseOut,this));BX.bind(this.starsObj,"click",BX.proxy(this.handlerClick,this))}};a.JCIblockVoteStars.prototype.destroy=function(){if(BX.type.isElementNode(this.progressObj)){BX.unbindAll(this.progressObj)}this.progressObj=null;if(BX.type.isElementNode(this.ratingObj)){BX.unbindAll(this.ratingObj)}this.ratingObj=null;if(BX.type.isElementNode(this.starsObj)){BX.unbindAll(this.starsObj)}this.starsObj=null};a.JCIblockVoteStars.prototype.preparePercent=function(b){b=parseInt(b,10);if(isNaN(b)){b=0}else{if(b>100){b=100}else{if(b<0){b=0}}}return b};a.JCIblockVoteStars.prototype.showProgress=function(b){if(!BX.type.isElementNode(this.progressObj)){return}BX.style(this.progressObj,"width",b.toString()+"%")};a.JCIblockVoteStars.prototype.showVotes=function(){if(!BX.type.isElementNode(this.ratingObj)){return}this.ratingObj.innerHTML="( "+this.voteData.count+" )"};a.JCIblockVoteStars.prototype.handlerMouseMove=function(d){var c,b;if(this.config.readOnly||this.config.alreadyVoted||this.config.request){return}d=d||a.event;if(!BX.type.isElementNode(this.starsObj)){return}c=BX.pos(this.starsObj);b=(d.pageX-c.left)/c.width*5;this.showProgress(this.preparePercent(Math.ceil(b)*20))};a.JCIblockVoteStars.prototype.handlerMouseOut=function(){if(this.config.readOnly||this.config.alreadyVoted||this.config.request){return}this.showProgress(this.voteData.percent)};a.JCIblockVoteStars.prototype.handlerClick=function(d){var c,b;if(this.config.readOnly||this.config.alreadyVoted||this.config.request){return}this.config.request=true;d=d||a.event;if(!BX.type.isElementNode(this.starsObj)){return}c=BX.pos(this.starsObj);b=parseInt(Math.ceil((d.pageX-c.left)/c.width*5),10);if(isNaN(b)){return}this.ajaxParams.rating=b-1;this.ajaxParams.vote="Y";this.ajaxParams.vote_id=this.voteData.element;this.ajaxParams.sessid=BX.bitrix_sessid();this.ajaxParams.site_id=this.siteId;BX.ajax({timeout:30,method:"POST",dataType:"json",url:this.ajaxUrl,data:this.ajaxParams,onsuccess:BX.proxy(this.clickResult,this)})};a.JCIblockVoteStars.prototype.clickResult=function(b){this.config.request=false;if(BX.type.isPlainObject(b)){this.config.alreadyVoted=true;this.voteData.percent=this.preparePercent(b.value*20);this.voteData.count=b.votes;this.showProgress(this.voteData.percent);this.showVotes()}}})(window);(function(a){if(!!a.JCCatalogSocnetsComments){return}a.JCCatalogSocnetsComments=function(b){var c;this.errorCode=0;this.params={};this.serviceList={blog:false,facebook:false,vk:false};this.settings={blog:{ajaxUrl:"",ajaxParams:{},contID:"bx-cat-soc-comments-blg"},facebook:{contID:"bx-cat-soc-comments-fb",contWidthID:"",parentContID:"soc_comments",facebookJSDK:"facebook-jssdk",facebookPath:""},vk:{}};this.services={blog:{obBlogCont:null},facebook:{obFBCont:null,obFBContWidth:null,obFBParentCont:null,obFBjSDK:null,currentWidth:0}};this.activeTabId="";this.currentTab=-1;this.tabsContId="";this.tabList=[];this.obTabList=[];if(typeof b==="object"){this.params=b;if(!!this.params.serviceList&&typeof this.params.serviceList==="object"){for(c in this.serviceList){if(this.serviceList.hasOwnProperty(c)&&!!this.params.serviceList[c]){this.serviceList[c]=true}}}if(this.serviceList.blog){this.initParams("blog")}if(this.serviceList.facebook){this.initParams("facebook")}if(typeof this.params.tabs==="object"){this.activeTabId=this.params.tabs.activeTabId;this.tabsContId=this.params.tabs.tabsContId;this.tabList=this.params.tabs.tabList}}else{this.errorCode=-1}if(this.errorCode===0){BX.ready(BX.proxy(this.Init,this))}};a.JCCatalogSocnetsComments.prototype.initParams=function(b){var c;if(!!this.params.settings&&typeof this.params.settings==="object"&&typeof this.params.settings[b]==="object"){for(c in this.settings[b]){if(this.settings[b].hasOwnProperty(c)&&!!this.params.settings[b][c]){this.settings[b][c]=this.params.settings[b][c]}}}};a.JCCatalogSocnetsComments.prototype.Init=function(){if(!this.tabList||!BX.type.isArray(this.tabList)||this.tabList.length===0){this.errorCode=-1;return}var b,c;for(b=0;b<this.tabList.length;b++){c=this.tabsContId+this.tabList[b];this.obTabList[b]={id:this.tabList[b],tabId:c,contId:c+"_cont",tab:BX(c),cont:BX(c+"_cont")};if(!this.obTabList[b].tab||!this.obTabList[b].cont){this.errorCode=-2;break}if(this.activeTabId===this.tabList[b]){this.currentTab=b}BX.bind(this.obTabList[b].tab,"click",BX.proxy(this.onClick,this))}if(this.serviceList.blog){this.services.blog.obBlogCont=BX(this.settings.blog.contID);if(!this.services.blog.obBlogCont){this.serviceList.blog=false;this.errorCode=-16}}if(this.serviceList.facebook){this.services.facebook.obFBCont=BX(this.settings.facebook.contID);if(!this.services.facebook.obFBCont){this.serviceList.facebook=false;this.errorCode=-32}else{this.services.facebook.obFBContWidth=this.services.facebook.obFBCont.firstChild}this.services.facebook.obFBParentCont=BX(this.settings.facebook.parentContID)}if(this.errorCode===0){this.showActiveTab();if(this.serviceList.blog){this.loadBlog()}if(this.serviceList.facebook){this.loadFB()}}this.params={}};a.JCCatalogSocnetsComments.prototype.loadBlog=function(){var b;if(this.errorCode!==0||!this.serviceList.blog||this.settings.blog.ajaxUrl.length===0){return}b=this.settings.blog.ajaxParams;b.sessid=BX.bitrix_sessid();BX.ajax({timeout:30,method:"POST",dataType:"html",url:this.settings.blog.ajaxUrl,data:b,onsuccess:BX.proxy(this.loadBlogResult,this)})};a.JCCatalogSocnetsComments.prototype.loadBlogResult=function(b){if(BX.type.isNotEmptyString(b)){BX.adjust(this.services.blog.obBlogCont,{html:b})}};a.JCCatalogSocnetsComments.prototype.loadFB=function(){var b;if(this.services.facebook.obFBParentCont&&this.services.facebook.obFBContWidth){b=parseInt(this.services.facebook.obFBParentCont.offsetWidth,10);if(!isNaN(b)&&b>20){BX.adjust(this.services.facebook.obFBContWidth,{attrs:{"data-width":b-20}});this.services.facebook.currentWidth=b}if(!this.services.facebook.obFBjSDK){this.services.facebook.obFBjSDK=true;BX.defer(BX.proxy(function(f,g,d,j){var h,c=f.getElementsByTagName(g)[0];if(f.getElementById(d)){return}h=f.createElement(g);h.id=d;h.src=j;c.parentNode.insertBefore(h,c)}(document,"script",this.settings.facebook.facebookJSDK,this.settings.facebook.facebookPath),this))}}};a.JCCatalogSocnetsComments.prototype.getFBParentWidth=function(){var b=0;if(!!this.services.facebook.obFBParentCont){b=parseInt(this.services.facebook.obFBParentCont.offsetWidth,10);if(isNaN(b)){b=0}}return b};a.JCCatalogSocnetsComments.prototype.setFBWidth=function(c){var d=null,b,e;if(this.serviceList.facebook&&this.services.facebook.currentWidth!==c&&c>20&&!!this.services.facebook.obFBContWidth){if(!!this.services.facebook.obFBContWidth.firstChild&&!!this.services.facebook.obFBContWidth.firstChild.fitrstChild){d=this.services.facebook.obFBContWidth.firstChild.fitrstChild;if(!!d){b=d.getAttribute("src");e=b.replace(/width=(\d+)/gi,"width="+c);BX.adjust(this.services.facebook.obFBContWidth,{attrs:{"data-width":c-20}});this.services.facebook.currentWidth=c;BX.style(this.services.facebook.obFBContWidth.firstChild,"width",c+"px");BX.adjust(d,{attrs:{src:e},style:{width:c+"px"}})}}}};a.JCCatalogSocnetsComments.prototype.onResize=function(){if(this.serviceList.facebook){this.setFBWidth(this.getFBParentWidth())}};a.JCCatalogSocnetsComments.prototype.onClick=function(){var c=BX.proxy_context,d=-1,b;for(b=0;b<this.obTabList.length;b++){if(c.id===this.obTabList[b].tabId){d=b;break}}if(d>-1){if(d!==this.currentTab){this.hideActiveTab();this.currentTab=d;this.showActiveTab()}}};a.JCCatalogSocnetsComments.prototype.hideActiveTab=function(){BX.removeClass(this.obTabList[this.currentTab].tab,"active");BX.addClass(this.obTabList[this.currentTab].cont,"tab-off");BX.addClass(this.obTabList[this.currentTab].cont,"hidden")};a.JCCatalogSocnetsComments.prototype.showActiveTab=function(){BX.onCustomEvent("onAfterBXCatTabsSetActive_"+this.tabsContId,[{activeTab:this.obTabList[this.currentTab].id}]);BX.addClass(this.obTabList[this.currentTab].tab,"active");BX.removeClass(this.obTabList[this.currentTab].cont,"tab-off");BX.removeClass(this.obTabList[this.currentTab].cont,"hidden")}})(window);(function(a){})(window);function bx_sale_prediction_product_detail_load(c,b,d){b=b||{};d=d||{};BX.ajax({url:"/bitrix/components/bitrix/sale.prediction.product.detail/ajax.php",method:"POST",data:BX.merge(b,d),dataType:"html",processData:false,start:true,onsuccess:function(f){var g=BX.processHTML(f);BX(c).innerHTML=g.HTML;BX.ajax.processScripts(g.SCRIPT)}})}(function(){if(!!window.JCCatalogSectionComponent){return}window.JCCatalogSectionComponent=function(b){this.formPosting=false;this.siteId=b.siteId||"";this.ajaxId=b.ajaxId||"";this.template=b.template||"";this.componentPath=b.componentPath||"";this.parameters=b.parameters||"";if(b.navParams){this.navParams={NavNum:b.navParams.NavNum||1,NavPageNomer:parseInt(b.navParams.NavPageNomer)||1,NavPageCount:parseInt(b.navParams.NavPageCount)||1}}this.bigData=b.bigData||{enabled:false};this.container=document.querySelector('[data-entity="'+b.container+'"]');this.showMoreButton=null;this.showMoreButtonMessage=null;if(this.bigData.enabled&&BX.util.object_keys(this.bigData.rows).length>0){BX.cookie_prefix=this.bigData.js.cookiePrefix||"";BX.cookie_domain=this.bigData.js.cookieDomain||"";BX.current_server_time=this.bigData.js.serverTime;BX.ready(BX.delegate(this.bigDataLoad,this))}if(b.initiallyShowHeader){BX.ready(BX.delegate(this.showHeader,this))}if(b.deferredLoad){BX.ready(BX.delegate(this.deferredLoad,this))}if(b.lazyLoad){this.showMoreButton=document.querySelector('[data-use="show-more-'+this.navParams.NavNum+'"]');this.showMoreButtonMessage=this.showMoreButton.innerHTML;BX.bind(this.showMoreButton,"click",BX.proxy(this.showMore,this))}if(b.loadOnScroll){BX.bind(window,"scroll",BX.proxy(this.loadOnScroll,this))}};window.JCCatalogSectionComponent.prototype={checkButton:function(){if(this.showMoreButton){if(this.navParams.NavPageNomer==this.navParams.NavPageCount){BX.remove(this.showMoreButton)}else{this.container.appendChild(this.showMoreButton)}}},enableButton:function(){if(this.showMoreButton){BX.removeClass(this.showMoreButton,"disabled");this.showMoreButton.innerHTML=this.showMoreButtonMessage}},disableButton:function(){if(this.showMoreButton){BX.addClass(this.showMoreButton,"disabled");this.showMoreButton.innerHTML=BX.message("BTN_MESSAGE_LAZY_LOAD_WAITER")}},loadOnScroll:function(){var c=BX.GetWindowScrollPos().scrollTop,d=BX.pos(this.container).bottom;if(c+window.innerHeight>d){this.showMore()}},showMore:function(){if(this.navParams.NavPageNomer<this.navParams.NavPageCount){var b={};b.action="showMore";b["PAGEN_"+this.navParams.NavNum]=this.navParams.NavPageNomer+1;if(!this.formPosting){this.formPosting=true;this.disableButton();this.sendRequest(b)}}},bigDataLoad:function(){var e="https://analytics.bitrix.info/crecoms/v1_0/recoms.php",d=BX.ajax.prepareData(this.bigData.params);if(d){e+=(e.indexOf("?")!==-1?"&":"?")+d}var f=BX.delegate(function(a){this.sendRequest({action:"deferredLoad",bigData:"Y",items:a&&a.items||[],rid:a&&a.id,count:this.bigData.count,rowsRange:this.bigData.rowsRange,shownIds:this.bigData.shownIds})},this);BX.ajax({method:"GET",dataType:"json",url:e,timeout:3,onsuccess:f,onfailure:f})},deferredLoad:function(){this.sendRequest({action:"deferredLoad"})},sendRequest:function(c){var d={siteId:this.siteId,template:this.template,parameters:this.parameters};if(this.ajaxId){d.AJAX_ID=this.ajaxId}BX.ajax({url:this.componentPath+"/ajax.php"+(document.location.href.indexOf("clear_cache=Y")!==-1?"?clear_cache=Y":""),method:"POST",dataType:"json",timeout:60,data:BX.merge(d,c),onsuccess:BX.delegate(function(a){if(!a||!a.JS){return}BX.ajax.processScripts(BX.processHTML(a.JS).SCRIPT,false,BX.delegate(function(){this.showAction(a,c)},this))},this)})},showAction:function(d,c){if(!c){return}switch(c.action){case"showMore":this.processShowMoreAction(d);break;case"deferredLoad":this.processDeferredLoadAction(d,c.bigData==="Y");break}},processShowMoreAction:function(b){this.formPosting=false;this.enableButton();if(b){this.navParams.NavPageNomer++;this.processItems(b.items);this.processPagination(b.pagination);this.processEpilogue(b.epilogue);this.checkButton()}},processDeferredLoadAction:function(d,f){if(!d){return}var e=f?this.bigData.rows:{};this.processItems(d.items,BX.util.array_keys(e))},processItems:function(k,i){if(!k){return}var j=BX.processHTML(k,false),m=BX.create("DIV");var n,h,l;m.innerHTML=j.HTML;n=m.querySelectorAll('[data-entity="items-row"]');if(n.length){this.showHeader(true);for(h in n){if(n.hasOwnProperty(h)){l=i?this.container.querySelectorAll('[data-entity="items-row"]'):false;n[h].style.opacity=0;if(l&&BX.type.isDomNode(l[i[h]])){l[i[h]].parentNode.insertBefore(n[h],l[i[h]])}else{this.container.appendChild(n[h])}}}new BX.easing({duration:2000,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(a){for(var b in n){if(n.hasOwnProperty(b)){n[b].style.opacity=a.opacity/100}}},complete:function(){for(var a in n){if(n.hasOwnProperty(a)){n[a].removeAttribute("style")}}}}).animate()}BX.ajax.processScripts(j.SCRIPT)},processPagination:function(f){if(!f){return}var e=document.querySelectorAll('[data-pagination-num="'+this.navParams.NavNum+'"]');for(var d in e){if(e.hasOwnProperty(d)){e[d].innerHTML=f}}},processEpilogue:function(d){if(!d){return}var c=BX.processHTML(d,false);BX.ajax.processScripts(c.SCRIPT)},showHeader:function(d){var e=BX.findParent(this.container,{attr:{"data-entity":"parent-container"}}),f;if(e&&BX.type.isDomNode(e)){f=e.querySelector('[data-entity="header"]');if(f&&f.getAttribute("data-showed")!="true"){f.style.display="";if(d){new BX.easing({duration:2000,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(a){f.style.opacity=a.opacity/100},complete:function(){f.removeAttribute("style");f.setAttribute("data-showed","true")}}).animate()}else{f.style.opacity=100}}}}}})();(function(){if(!!window.JCCatalogProductsViewedComponent){return}window.JCCatalogProductsViewedComponent=function(a){this.container=document.querySelector('[data-entity="'+a.container+'"]');if(a.initiallyShowHeader){BX.ready(BX.delegate(this.showHeader,this))}};window.JCCatalogProductsViewedComponent.prototype={showHeader:function(b){var c=BX.findParent(this.container,{attr:{"data-entity":"parent-container"}}),a;if(c&&BX.type.isDomNode(c)){a=c.querySelector('[data-entity="header"]');if(a&&a.getAttribute("data-showed")!="true"){a.style.display="";if(b){new BX.easing({duration:2000,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(d){a.style.opacity=d.opacity/100},complete:function(){a.removeAttribute("style");a.setAttribute("data-showed","true")}}).animate()}else{a.style.opacity=100}}}}}})();(function(b){if(b.JCCatalogItem){return}var a=function(c){a.superclass.constructor.apply(this,arguments);this.buttonNode=BX.create("span",{props:{className:"btn btn-default btn-buy btn-sm",id:this.id},style:typeof c.style==="object"?c.style:{},text:c.text,events:this.contextEvents});if(BX.browser.IsIE()){this.buttonNode.setAttribute("hideFocus","hidefocus")}};BX.extend(a,BX.PopupWindowButton);b.JCCatalogItem=function(c){this.productType=0;this.showQuantity=true;this.showAbsent=true;this.secondPict=false;this.showOldPrice=false;this.showMaxQuantity="N";this.relativeQuantityFactor=5;this.showPercent=false;this.showSkuProps=false;this.basketAction="ADD";this.showClosePopup=false;this.useCompare=false;this.showSubscription=false;this.visual={ID:"",PICT_ID:"",SECOND_PICT_ID:"",PICT_SLIDER_ID:"",QUANTITY_ID:"",QUANTITY_UP_ID:"",QUANTITY_DOWN_ID:"",PRICE_ID:"",PRICE_OLD_ID:"",DSC_PERC:"",SECOND_DSC_PERC:"",DISPLAY_PROP_DIV:"",BASKET_PROP_DIV:"",SUBSCRIBE_ID:""};this.product={checkQuantity:false,maxQuantity:0,stepQuantity:1,isDblQuantity:false,canBuy:true,name:"",pict:{},id:0,addUrl:"",buyUrl:""};this.basketMode="";this.basketData={useProps:false,emptyProps:false,quantity:"quantity",props:"prop",basketUrl:"",sku_props:"",sku_props_var:"basket_props",add_url:"",buy_url:""};this.compareData={compareUrl:"",compareDeleteUrl:"",comparePath:""};this.defaultPict={pict:null,secondPict:null};this.defaultSliderOptions={interval:3000,wrap:true};this.slider={options:{},items:[],active:null,sliding:null,paused:null,interval:null,progress:null};this.touch=null;this.quantityDelay=null;this.quantityTimer=null;this.checkQuantity=false;this.maxQuantity=0;this.minQuantity=0;this.stepQuantity=1;this.isDblQuantity=false;this.canBuy=true;this.precision=6;this.precisionFactor=Math.pow(10,this.precision);this.bigData=false;this.fullDisplayMode=false;this.viewMode="";this.templateTheme="";this.currentPriceMode="";this.currentPrices=[];this.currentPriceSelected=0;this.currentQuantityRanges=[];this.currentQuantityRangeSelected=0;this.offers=[];this.offerNum=0;this.treeProps=[];this.selectedValues={};this.obProduct=null;this.blockNodes={};this.obQuantity=null;this.obQuantityUp=null;this.obQuantityDown=null;this.obQuantityLimit={};this.obPict=null;this.obSecondPict=null;this.obPictSlider=null;this.obPictSliderIndicator=null;this.obPrice=null;this.obTree=null;this.obBuyBtn=null;this.obBasketActions=null;this.obNotAvail=null;this.obSubscribe=null;this.obDscPerc=null;this.obSecondDscPerc=null;this.obSkuProps=null;this.obMeasure=null;this.obCompare=null;this.obPopupWin=null;this.basketUrl="";this.basketParams={};this.isTouchDevice=BX.hasClass(document.documentElement,"bx-touch");this.hoverTimer=null;this.hoverStateChangeForbidden=false;this.mouseX=null;this.mouseY=null;this.useEnhancedEcommerce=false;this.dataLayerName="dataLayer";this.brandProperty=false;this.errorCode=0;if(typeof c==="object"){if(c.PRODUCT_TYPE){this.productType=parseInt(c.PRODUCT_TYPE,10)}this.showQuantity=c.SHOW_QUANTITY;this.showAbsent=c.SHOW_ABSENT;this.secondPict=c.SECOND_PICT;this.showOldPrice=c.SHOW_OLD_PRICE;this.showMaxQuantity=c.SHOW_MAX_QUANTITY;this.relativeQuantityFactor=parseInt(c.RELATIVE_QUANTITY_FACTOR);this.showPercent=c.SHOW_DISCOUNT_PERCENT;this.showSkuProps=c.SHOW_SKU_PROPS;this.showSubscription=c.USE_SUBSCRIBE;if(c.ADD_TO_BASKET_ACTION){this.basketAction=c.ADD_TO_BASKET_ACTION}this.showClosePopup=c.SHOW_CLOSE_POPUP;this.useCompare=c.DISPLAY_COMPARE;this.fullDisplayMode=c.PRODUCT_DISPLAY_MODE==="Y";this.bigData=c.BIG_DATA;this.viewMode=c.VIEW_MODE||"";this.templateTheme=c.TEMPLATE_THEME||"";this.useEnhancedEcommerce=c.USE_ENHANCED_ECOMMERCE==="Y";this.dataLayerName=c.DATA_LAYER_NAME;this.brandProperty=c.BRAND_PROPERTY;this.visual=c.VISUAL;switch(this.productType){case 0:case 1:case 2:if(c.PRODUCT&&typeof c.PRODUCT==="object"){this.currentPriceMode=c.PRODUCT.ITEM_PRICE_MODE;this.currentPrices=c.PRODUCT.ITEM_PRICES;this.currentPriceSelected=c.PRODUCT.ITEM_PRICE_SELECTED;this.currentQuantityRanges=c.PRODUCT.ITEM_QUANTITY_RANGES;this.currentQuantityRangeSelected=c.PRODUCT.ITEM_QUANTITY_RANGE_SELECTED;if(this.showQuantity){this.product.checkQuantity=c.PRODUCT.CHECK_QUANTITY;this.product.isDblQuantity=c.PRODUCT.QUANTITY_FLOAT;if(this.product.checkQuantity){this.product.maxQuantity=this.product.isDblQuantity?parseFloat(c.PRODUCT.MAX_QUANTITY):parseInt(c.PRODUCT.MAX_QUANTITY,10)}this.product.stepQuantity=this.product.isDblQuantity?parseFloat(c.PRODUCT.STEP_QUANTITY):parseInt(c.PRODUCT.STEP_QUANTITY,10);this.checkQuantity=this.product.checkQuantity;this.isDblQuantity=this.product.isDblQuantity;this.stepQuantity=this.product.stepQuantity;this.maxQuantity=this.product.maxQuantity;this.minQuantity=this.currentPriceMode==="Q"?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity;if(this.isDblQuantity){this.stepQuantity=Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor}}this.product.canBuy=c.PRODUCT.CAN_BUY;if(c.PRODUCT.MORE_PHOTO_COUNT){this.product.morePhotoCount=c.PRODUCT.MORE_PHOTO_COUNT;this.product.morePhoto=c.PRODUCT.MORE_PHOTO}if(c.PRODUCT.RCM_ID){this.product.rcmId=c.PRODUCT.RCM_ID}this.canBuy=this.product.canBuy;this.product.name=c.PRODUCT.NAME;this.product.pict=c.PRODUCT.PICT;this.product.id=c.PRODUCT.ID;this.product.DETAIL_PAGE_URL=c.PRODUCT.DETAIL_PAGE_URL;if(c.PRODUCT.ADD_URL){this.product.addUrl=c.PRODUCT.ADD_URL}if(c.PRODUCT.BUY_URL){this.product.buyUrl=c.PRODUCT.BUY_URL}if(c.BASKET&&typeof c.BASKET==="object"){this.basketData.useProps=c.BASKET.ADD_PROPS;this.basketData.emptyProps=c.BASKET.EMPTY_PROPS}}else{this.errorCode=-1}break;case 3:if(c.PRODUCT&&typeof c.PRODUCT==="object"){this.product.name=c.PRODUCT.NAME;this.product.id=c.PRODUCT.ID;this.product.DETAIL_PAGE_URL=c.PRODUCT.DETAIL_PAGE_URL;this.product.morePhotoCount=c.PRODUCT.MORE_PHOTO_COUNT;this.product.morePhoto=c.PRODUCT.MORE_PHOTO;if(c.PRODUCT.RCM_ID){this.product.rcmId=c.PRODUCT.RCM_ID}}if(c.OFFERS&&BX.type.isArray(c.OFFERS)){this.offers=c.OFFERS;this.offerNum=0;if(c.OFFER_SELECTED){this.offerNum=parseInt(c.OFFER_SELECTED,10)}if(isNaN(this.offerNum)){this.offerNum=0}if(c.TREE_PROPS){this.treeProps=c.TREE_PROPS}if(c.DEFAULT_PICTURE){this.defaultPict.pict=c.DEFAULT_PICTURE.PICTURE;this.defaultPict.secondPict=c.DEFAULT_PICTURE.PICTURE_SECOND}}break;default:this.errorCode=-1}if(c.BASKET&&typeof c.BASKET==="object"){if(c.BASKET.QUANTITY){this.basketData.quantity=c.BASKET.QUANTITY}if(c.BASKET.PROPS){this.basketData.props=c.BASKET.PROPS}if(c.BASKET.BASKET_URL){this.basketData.basketUrl=c.BASKET.BASKET_URL}if(3===this.productType){if(c.BASKET.SKU_PROPS){this.basketData.sku_props=c.BASKET.SKU_PROPS}}if(c.BASKET.ADD_URL_TEMPLATE){this.basketData.add_url=c.BASKET.ADD_URL_TEMPLATE}if(c.BASKET.BUY_URL_TEMPLATE){this.basketData.buy_url=c.BASKET.BUY_URL_TEMPLATE}if(this.basketData.add_url===""&&this.basketData.buy_url===""){this.errorCode=-1024}}if(this.useCompare){if(c.COMPARE&&typeof c.COMPARE==="object"){if(c.COMPARE.COMPARE_PATH){this.compareData.comparePath=c.COMPARE.COMPARE_PATH}if(c.COMPARE.COMPARE_URL_TEMPLATE){this.compareData.compareUrl=c.COMPARE.COMPARE_URL_TEMPLATE}else{this.useCompare=false}if(c.COMPARE.COMPARE_DELETE_URL_TEMPLATE){this.compareData.compareDeleteUrl=c.COMPARE.COMPARE_DELETE_URL_TEMPLATE}else{this.useCompare=false}}else{this.useCompare=false}}this.isFacebookConversionCustomizeProductEventEnabled=c.IS_FACEBOOK_CONVERSION_CUSTOMIZE_PRODUCT_EVENT_ENABLED}if(this.errorCode===0){BX.ready(BX.delegate(this.init,this))}};b.JCCatalogItem.prototype={init:function(){var d=0,c=null;this.obProduct=BX(this.visual.ID);if(!this.obProduct){this.errorCode=-1}this.obPict=BX(this.visual.PICT_ID);if(!this.obPict){this.errorCode=-2}if(this.secondPict&&this.visual.SECOND_PICT_ID){this.obSecondPict=BX(this.visual.SECOND_PICT_ID)}this.obPictSlider=BX(this.visual.PICT_SLIDER_ID);this.obPictSliderIndicator=BX(this.visual.PICT_SLIDER_ID+"_indicator");this.obPictSliderProgressBar=BX(this.visual.PICT_SLIDER_ID+"_progress_bar");if(!this.obPictSlider){this.errorCode=-4}this.obPrice=BX(this.visual.PRICE_ID);this.obPriceOld=BX(this.visual.PRICE_OLD_ID);this.obPriceTotal=BX(this.visual.PRICE_TOTAL_ID);if(!this.obPrice){this.errorCode=-16}if(this.showQuantity&&this.visual.QUANTITY_ID){this.obQuantity=BX(this.visual.QUANTITY_ID);this.blockNodes.quantity=this.obProduct.querySelector('[data-entity="quantity-block"]');if(!this.isTouchDevice){BX.bind(this.obQuantity,"focus",BX.proxy(this.onFocus,this));BX.bind(this.obQuantity,"blur",BX.proxy(this.onBlur,this))}if(this.visual.QUANTITY_UP_ID){this.obQuantityUp=BX(this.visual.QUANTITY_UP_ID)}if(this.visual.QUANTITY_DOWN_ID){this.obQuantityDown=BX(this.visual.QUANTITY_DOWN_ID)}}if(this.visual.QUANTITY_LIMIT&&this.showMaxQuantity!=="N"){this.obQuantityLimit.all=BX(this.visual.QUANTITY_LIMIT);if(this.obQuantityLimit.all){this.obQuantityLimit.value=this.obQuantityLimit.all.querySelector('[data-entity="quantity-limit-value"]');if(!this.obQuantityLimit.value){this.obQuantityLimit.all=null}}}if(this.productType===3&&this.fullDisplayMode){if(this.visual.TREE_ID){this.obTree=BX(this.visual.TREE_ID);if(!this.obTree){this.errorCode=-256}}if(this.visual.QUANTITY_MEASURE){this.obMeasure=BX(this.visual.QUANTITY_MEASURE)}}this.obBasketActions=BX(this.visual.BASKET_ACTIONS_ID);if(this.obBasketActions){if(this.visual.BUY_ID){this.obBuyBtn=BX(this.visual.BUY_ID)}}this.obNotAvail=BX(this.visual.NOT_AVAILABLE_MESS);if(this.showSubscription){this.obSubscribe=BX(this.visual.SUBSCRIBE_ID)}if(this.showPercent){if(this.visual.DSC_PERC){this.obDscPerc=BX(this.visual.DSC_PERC)}if(this.secondPict&&this.visual.SECOND_DSC_PERC){this.obSecondDscPerc=BX(this.visual.SECOND_DSC_PERC)}}if(this.showSkuProps){if(this.visual.DISPLAY_PROP_DIV){this.obSkuProps=BX(this.visual.DISPLAY_PROP_DIV)}}if(this.errorCode===0){if(this.isTouchDevice){BX.bind(this.obPictSlider,"touchstart",BX.proxy(this.touchStartEvent,this));BX.bind(this.obPictSlider,"touchend",BX.proxy(this.touchEndEvent,this));BX.bind(this.obPictSlider,"touchcancel",BX.proxy(this.touchEndEvent,this))}else{if(this.viewMode==="CARD"){BX.bind(this.obProduct,"mouseenter",BX.proxy(this.hoverOn,this));BX.bind(this.obProduct,"mouseleave",BX.proxy(this.hoverOff,this))}BX.bind(this.obProduct,"mouseenter",BX.proxy(this.cycleSlider,this));BX.bind(this.obProduct,"mouseleave",BX.proxy(this.stopSlider,this))}if(this.bigData){var h=BX.findChildren(this.obProduct,{tag:"a"},true);if(h){for(d in h){if(h.hasOwnProperty(d)){if(h[d].getAttribute("href")==this.product.DETAIL_PAGE_URL){BX.bind(h[d],"click",BX.proxy(this.rememberProductRecommendation,this))}}}}}if(this.showQuantity){var f=this.isTouchDevice?"touchstart":"mousedown";var g=this.isTouchDevice?"touchend":"mouseup";if(this.obQuantityUp){BX.bind(this.obQuantityUp,f,BX.proxy(this.startQuantityInterval,this));BX.bind(this.obQuantityUp,g,BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityUp,"mouseout",BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityUp,"click",BX.delegate(this.quantityUp,this))}if(this.obQuantityDown){BX.bind(this.obQuantityDown,f,BX.proxy(this.startQuantityInterval,this));BX.bind(this.obQuantityDown,g,BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityDown,"mouseout",BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityDown,"click",BX.delegate(this.quantityDown,this))}if(this.obQuantity){BX.bind(this.obQuantity,"change",BX.delegate(this.quantityChange,this))}}switch(this.productType){case 0:case 1:case 2:if(parseInt(this.product.morePhotoCount)>1&&this.obPictSlider){this.initializeSlider()}this.checkQuantityControls();break;case 3:if(this.offers.length>0){c=BX.findChildren(this.obTree,{tagName:"li"},true);if(c&&c.length){for(d=0;d<c.length;d++){BX.bind(c[d],"click",BX.delegate(this.selectOfferProp,this))}}this.setCurrent()}else{if(parseInt(this.product.morePhotoCount)>1&&this.obPictSlider){this.initializeSlider()}}break}if(this.obBuyBtn){if(this.basketAction==="ADD"){BX.bind(this.obBuyBtn,"click",BX.proxy(this.add2Basket,this))}else{BX.bind(this.obBuyBtn,"click",BX.proxy(this.buyBasket,this))}}if(this.useCompare){this.obCompare=BX(this.visual.COMPARE_LINK_ID);if(this.obCompare){BX.bind(this.obCompare,"click",BX.proxy(this.compare,this))}BX.addCustomEvent("onCatalogDeleteCompare",BX.proxy(this.checkDeletedCompare,this))}}},setAnalyticsDataLayer:function(j){if(!this.useEnhancedEcommerce||!this.dataLayerName){return}var m={},t={},c=[],p,d,k,f,g,q;switch(this.productType){case 0:case 1:case 2:m={id:this.product.id,name:this.product.name,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,brand:BX.type.isArray(this.brandProperty)?this.brandProperty.join("/"):this.brandProperty};break;case 3:for(p in this.offers[this.offerNum].TREE){if(this.offers[this.offerNum].TREE.hasOwnProperty(p)){f=p.substring(5);g=this.offers[this.offerNum].TREE[p];for(d in this.treeProps){if(this.treeProps.hasOwnProperty(d)&&this.treeProps[d].ID==f){for(k in this.treeProps[d].VALUES){q=this.treeProps[d].VALUES[k];if(q.ID==g){c.push(q.NAME);break}}}}}}m={id:this.offers[this.offerNum].ID,name:this.offers[this.offerNum].NAME,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,brand:BX.type.isArray(this.brandProperty)?this.brandProperty.join("/"):this.brandProperty,variant:c.join("/")};break}switch(j){case"addToCart":t={ecommerce:{currencyCode:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].CURRENCY||"",add:{products:[{name:m.name||"",id:m.id||"",price:m.price||0,brand:m.brand||"",category:m.category||"",variant:m.variant||"",quantity:this.showQuantity&&this.obQuantity?this.obQuantity.value:1}]}}};break}b[this.dataLayerName]=b[this.dataLayerName]||[];b[this.dataLayerName].push(t)},hoverOn:function(c){clearTimeout(this.hoverTimer);this.obProduct.style.height=getComputedStyle(this.obProduct).height;BX.addClass(this.obProduct,"hover");BX.PreventDefault(c)},hoverOff:function(c){if(this.hoverStateChangeForbidden){return}BX.removeClass(this.obProduct,"hover");this.hoverTimer=setTimeout(BX.delegate(function(){this.obProduct.style.height="auto"},this),300);BX.PreventDefault(c)},onFocus:function(){this.hoverStateChangeForbidden=true;BX.bind(document,"mousemove",BX.proxy(this.captureMousePosition,this))},onBlur:function(){this.hoverStateChangeForbidden=false;BX.unbind(document,"mousemove",BX.proxy(this.captureMousePosition,this));var c=document.elementFromPoint(this.mouseX,this.mouseY);if(!c||!this.obProduct.contains(c)){this.hoverOff()}},captureMousePosition:function(c){this.mouseX=c.clientX;this.mouseY=c.clientY},getCookie:function(d){var c=document.cookie.match(new RegExp("(?:^|; )"+d.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return c?decodeURIComponent(c[1]):null},rememberProductRecommendation:function(){var f=BX.cookie_prefix+"_RCM_PRODUCT_LOG",d=this.getCookie(f),l=false;var j=[],k;if(d){j=d.split(".")}var c=j.length;while(c--){k=j[c].split("-");if(k[0]==this.product.id){k=j[c].split("-");k[1]=this.product.rcmId;k[2]=BX.current_server_time;j[c]=k.join("-");l=true}else{if(BX.current_server_time-k[2]>3600*24*30){j.splice(c,1)}}}if(!l){j.push([this.product.id,this.product.rcmId,BX.current_server_time].join("-"))}var m=j.join("."),g=new Date((new Date).getTime()+1000*3600*24*365*10).toUTCString();document.cookie=f+"="+m+"; path=/; expires="+g+"; domain="+BX.cookie_domain},startQuantityInterval:function(){var d=BX.proxy_context;var c=d.id===this.visual.QUANTITY_DOWN_ID?BX.proxy(this.quantityDown,this):BX.proxy(this.quantityUp,this);this.quantityDelay=setTimeout(BX.delegate(function(){this.quantityTimer=setInterval(c,150)},this),300)},clearQuantityInterval:function(){clearTimeout(this.quantityDelay);clearInterval(this.quantityTimer)},quantityUp:function(){var d=0,c=true;if(this.errorCode===0&&this.showQuantity&&this.canBuy){d=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10);if(!isNaN(d)){d+=this.stepQuantity;if(this.checkQuantity){if(d>this.maxQuantity){c=false}}if(c){if(this.isDblQuantity){d=Math.round(d*this.precisionFactor)/this.precisionFactor}this.obQuantity.value=d;this.setPrice()}}}},quantityDown:function(){var d=0,c=true;if(this.errorCode===0&&this.showQuantity&&this.canBuy){d=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10);if(!isNaN(d)){d-=this.stepQuantity;this.checkPriceRange(d);if(d<this.minQuantity){c=false}if(c){if(this.isDblQuantity){d=Math.round(d*this.precisionFactor)/this.precisionFactor}this.obQuantity.value=d;this.setPrice()}}}},quantityChange:function(){var d=0,c;if(this.errorCode===0&&this.showQuantity){if(this.canBuy){d=this.isDblQuantity?parseFloat(this.obQuantity.value):Math.round(this.obQuantity.value);if(!isNaN(d)){if(this.checkQuantity){if(d>this.maxQuantity){d=this.maxQuantity}}this.checkPriceRange(d);c=Math.floor(Math.round(d*this.precisionFactor/this.stepQuantity)/this.precisionFactor)||1;d=c<=1?this.stepQuantity:c*this.stepQuantity;d=Math.round(d*this.precisionFactor)/this.precisionFactor;if(d<this.minQuantity){d=this.minQuantity}this.obQuantity.value=d}else{this.obQuantity.value=this.minQuantity}}else{this.obQuantity.value=this.minQuantity}this.setPrice()}},quantitySet:function(f){var d,j;var g=this.offers[f],h=this.offers[this.offerNum];if(this.errorCode===0){this.canBuy=g.CAN_BUY;this.currentPriceMode=g.ITEM_PRICE_MODE;this.currentPrices=g.ITEM_PRICES;this.currentPriceSelected=g.ITEM_PRICE_SELECTED;this.currentQuantityRanges=g.ITEM_QUANTITY_RANGES;this.currentQuantityRangeSelected=g.ITEM_QUANTITY_RANGE_SELECTED;if(this.canBuy){if(this.blockNodes.quantity){BX.style(this.blockNodes.quantity,"display","")}if(this.obBasketActions){BX.style(this.obBasketActions,"display","")}if(this.obNotAvail){BX.style(this.obNotAvail,"display","none")}if(this.obSubscribe){BX.style(this.obSubscribe,"display","none")}}else{if(this.blockNodes.quantity){BX.style(this.blockNodes.quantity,"display","none")}if(this.obBasketActions){BX.style(this.obBasketActions,"display","none")}if(this.obNotAvail){BX.style(this.obNotAvail,"display","")}if(this.obSubscribe){if(g.CATALOG_SUBSCRIBE==="Y"){BX.style(this.obSubscribe,"display","");this.obSubscribe.setAttribute("data-item",g.ID);BX(this.visual.SUBSCRIBE_ID+"_hidden").click()}else{BX.style(this.obSubscribe,"display","none")}}}this.isDblQuantity=g.QUANTITY_FLOAT;this.checkQuantity=g.CHECK_QUANTITY;if(this.isDblQuantity){this.stepQuantity=Math.round(parseFloat(g.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor;this.maxQuantity=parseFloat(g.MAX_QUANTITY);this.minQuantity=this.currentPriceMode==="Q"?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity}else{this.stepQuantity=parseInt(g.STEP_QUANTITY,10);this.maxQuantity=parseInt(g.MAX_QUANTITY,10);this.minQuantity=this.currentPriceMode==="Q"?parseInt(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity}if(this.showQuantity){var c=h.ITEM_PRICES.length&&h.ITEM_PRICES[h.ITEM_PRICE_SELECTED]&&h.ITEM_PRICES[h.ITEM_PRICE_SELECTED].MIN_QUANTITY!=this.minQuantity;if(this.isDblQuantity){d=Math.round(parseFloat(h.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor!==this.stepQuantity||c||h.MEASURE!==g.MEASURE||this.checkQuantity&&parseFloat(h.MAX_QUANTITY)>this.maxQuantity&&parseFloat(this.obQuantity.value)>this.maxQuantity}else{d=parseInt(h.STEP_QUANTITY,10)!==this.stepQuantity||c||h.MEASURE!==g.MEASURE||this.checkQuantity&&parseInt(h.MAX_QUANTITY,10)>this.maxQuantity&&parseInt(this.obQuantity.value,10)>this.maxQuantity}this.obQuantity.disabled=!this.canBuy;if(d){this.obQuantity.value=this.minQuantity}if(this.obMeasure){if(g.MEASURE){BX.adjust(this.obMeasure,{html:g.MEASURE})}else{BX.adjust(this.obMeasure,{html:""})}}}if(this.obQuantityLimit.all){if(!this.checkQuantity||this.maxQuantity==0){BX.adjust(this.obQuantityLimit.value,{html:""});BX.adjust(this.obQuantityLimit.all,{style:{display:"none"}})}else{if(this.showMaxQuantity==="M"){j=this.maxQuantity/this.stepQuantity>=this.relativeQuantityFactor?BX.message("RELATIVE_QUANTITY_MANY"):BX.message("RELATIVE_QUANTITY_FEW")}else{j=this.maxQuantity;if(g.MEASURE){j+=" "+g.MEASURE}}BX.adjust(this.obQuantityLimit.value,{html:j});BX.adjust(this.obQuantityLimit.all,{style:{display:""}})}}}},initializeSlider:function(){var d=this.obPictSlider.getAttribute("data-slider-wrap");if(d){this.slider.options.wrap=d==="true"}else{this.slider.options.wrap=this.defaultSliderOptions.wrap}if(this.isTouchDevice){this.slider.options.interval=false}else{this.slider.options.interval=parseInt(this.obPictSlider.getAttribute("data-slider-interval"))||this.defaultSliderOptions.interval;if(this.slider.options.interval<700){this.slider.options.interval=700}if(this.obPictSliderIndicator){var c=this.obPictSliderIndicator.querySelectorAll("[data-go-to]");for(var f in c){if(c.hasOwnProperty(f)){BX.bind(c[f],"click",BX.proxy(this.sliderClickHandler,this))}}}if(this.obPictSliderProgressBar){if(this.slider.progress){this.resetProgress();this.cycleSlider()}else{this.slider.progress=new BX.easing({transition:BX.easing.transitions.linear,step:BX.delegate(function(e){this.obPictSliderProgressBar.style.width=e.width/10+"%"},this)})}}}},checkTouch:function(c){if(!c||!c.changedTouches){return false}return c.changedTouches[0].identifier===this.touch.identifier},touchStartEvent:function(c){if(c.touches.length!=1){return}this.touch=c.changedTouches[0]},touchEndEvent:function(d){if(!this.checkTouch(d)){return}var c=this.touch.pageX-d.changedTouches[0].pageX,f=this.touch.pageY-d.changedTouches[0].pageY;if(Math.abs(c)>=Math.abs(f)+10){if(c>0){this.slideNext()}if(c<0){this.slidePrev()}}},sliderClickHandler:function(d){var c=BX.getEventTarget(d),f=c.getAttribute("data-go-to");if(f){this.slideTo(f)}BX.PreventDefault(d)},slideNext:function(){if(this.slider.sliding){return}return this.slide("next")},slidePrev:function(){if(this.slider.sliding){return}return this.slide("prev")},slideTo:function(d){this.slider.active=BX.findChild(this.obPictSlider,{className:"item active"},true,false);this.slider.progress&&(this.slider.interval=true);var c=this.getItemIndex(this.slider.active);if(d>this.slider.items.length-1||d<0){return}if(this.slider.sliding){return false}if(c==d){this.stopSlider();this.cycleSlider();return}return this.slide(d>c?"next":"prev",this.eq(this.slider.items,d))},slide:function(f,d){var j=BX.findChild(this.obPictSlider,{className:"item active"},true,false),g=this.slider.interval,h=f==="next"?"left":"right";d=d||this.getItemForDirection(f,j);if(BX.hasClass(d,"active")){return this.slider.sliding=false}this.slider.sliding=true;g&&this.stopSlider();if(this.obPictSliderIndicator){BX.removeClass(this.obPictSliderIndicator.querySelector(".active"),"active");var c=this.obPictSliderIndicator.querySelectorAll("[data-go-to]")[this.getItemIndex(d)];c&&BX.addClass(c,"active")}if(BX.hasClass(this.obPictSlider,"slide")&&!BX.browser.IsIE()){var k=this;BX.addClass(d,f);d.offsetWidth;BX.addClass(j,h);BX.addClass(d,h);setTimeout(function(){BX.addClass(d,"active");BX.removeClass(j,"active");BX.removeClass(j,h);BX.removeClass(d,f);BX.removeClass(d,h);k.slider.sliding=false},700)}else{BX.addClass(d,"active");this.slider.sliding=false}this.obPictSliderProgressBar&&this.resetProgress();g&&this.cycleSlider()},stopSlider:function(d){d||(this.slider.paused=true);this.slider.interval&&clearInterval(this.slider.interval);if(this.slider.progress){this.slider.progress.stop();var c=parseInt(this.obPictSliderProgressBar.style.width);this.slider.progress.options.duration=this.slider.options.interval*c/200;this.slider.progress.options.start={width:c*10};this.slider.progress.options.finish={width:0};this.slider.progress.options.complete=null;this.slider.progress.animate()}},cycleSlider:function(d){d||(this.slider.paused=false);this.slider.interval&&clearInterval(this.slider.interval);if(this.slider.options.interval&&!this.slider.paused){if(this.slider.progress){this.slider.progress.stop();var c=parseInt(this.obPictSliderProgressBar.style.width);this.slider.progress.options.duration=this.slider.options.interval*(100-c)/100;this.slider.progress.options.start={width:c*10};this.slider.progress.options.finish={width:1000};this.slider.progress.options.complete=BX.delegate(function(){this.slider.interval=true;this.slideNext()},this);this.slider.progress.animate()}else{this.slider.interval=setInterval(BX.proxy(this.slideNext,this),this.slider.options.interval)}}},resetProgress:function(){this.slider.progress&&this.slider.progress.stop();this.obPictSliderProgressBar.style.width=0},getItemForDirection:function(f,d){var j=this.getItemIndex(d),g=f==="prev"&&j===0||f==="next"&&j==this.slider.items.length-1;if(g&&!this.slider.options.wrap){return d}var h=f==="prev"?-1:1,c=(j+h)%this.slider.items.length;return this.eq(this.slider.items,c)},getItemIndex:function(c){this.slider.items=BX.findChildren(c.parentNode,{className:"item"},true);return this.slider.items.indexOf(c||this.slider.active)},eq:function(d,c){var g=d.length,f=+c+(c<0?g:0);return f>=0&&f<g?d[f]:{}},selectOfferProp:function(){var f=0,d="",j="",g=[],h=null,c=BX.proxy_context;if(c&&c.hasAttribute("data-treevalue")){if(BX.hasClass(c,"selected")){return}j=c.getAttribute("data-treevalue");g=j.split("_");if(this.searchOfferPropIndex(g[0],g[1])){h=BX.findChildren(c.parentNode,{tagName:"li"},false);if(h&&0<h.length){for(f=0;f<h.length;f++){d=h[f].getAttribute("data-onevalue");if(d===g[1]){BX.addClass(h[f],"selected")}else{BX.removeClass(h[f],"selected")}}}if(this.isFacebookConversionCustomizeProductEventEnabled&&BX.Type.isArrayFilled(this.offers)&&BX.Type.isObject(this.offers[this.offerNum])){BX.ajax.runAction("sale.facebookconversion.customizeProduct",{data:{offerId:this.offers[this.offerNum]["ID"]}})}}}},searchOfferPropIndex:function(v,j){var m="",w=false,c,p,d=[],k=[],f=-1,g={},q=[];for(c=0;c<this.treeProps.length;c++){if(this.treeProps[c].ID===v){f=c;break}}if(-1<f){for(c=0;c<f;c++){m="PROP_"+this.treeProps[c].ID;g[m]=this.selectedValues[m]}m="PROP_"+this.treeProps[f].ID;w=this.getRowValues(g,m);if(!w){return false}if(!BX.util.in_array(j,w)){return false}g[m]=j;for(c=f+1;c<this.treeProps.length;c++){m="PROP_"+this.treeProps[c].ID;w=this.getRowValues(g,m);if(!w){return false}k=[];if(this.showAbsent){d=[];q=[];q=BX.clone(g,true);for(p=0;p<w.length;p++){q[m]=w[p];k[k.length]=w[p];if(this.getCanBuy(q)){d[d.length]=w[p]}}}else{d=w}if(this.selectedValues[m]&&BX.util.in_array(this.selectedValues[m],d)){g[m]=this.selectedValues[m]}else{if(this.showAbsent){g[m]=d.length>0?d[0]:k[0]}else{g[m]=d[0]}}this.updateRow(c,g[m],w,d)}this.selectedValues=g;this.changeInfo()}return true},updateRow:function(q,j,m,u){var c=0,p="",d=false,k=null;var f=this.obTree.querySelectorAll('[data-entity="sku-line-block"]'),g;if(q>-1&&q<f.length){g=f[q].querySelector("ul");k=BX.findChildren(g,{tagName:"li"},false);if(k&&0<k.length){for(c=0;c<k.length;c++){p=k[c].getAttribute("data-onevalue");d=p===j;if(d){BX.addClass(k[c],"selected")}else{BX.removeClass(k[c],"selected")}if(BX.util.in_array(p,u)){BX.removeClass(k[c],"notallowed")}else{BX.addClass(k[c],"notallowed")}k[c].style.display=BX.util.in_array(p,m)?"":"none";if(d){f[q].style.display=p==0&&u.length==1?"none":""}}}}},getRowValues:function(f,d){var j=0,g,h=[],c=false,k=true;if(0===f.length){for(j=0;j<this.offers.length;j++){if(!BX.util.in_array(this.offers[j].TREE[d],h)){h[h.length]=this.offers[j].TREE[d]}}c=true}else{for(j=0;j<this.offers.length;j++){k=true;for(g in f){if(f[g]!==this.offers[j].TREE[g]){k=false;break}}if(k){if(!BX.util.in_array(this.offers[j].TREE[d],h)){h[h.length]=this.offers[j].TREE[d]}c=true}}}return c?h:false},getCanBuy:function(d){var c,h,f=false,g=true;for(c=0;c<this.offers.length;c++){g=true;for(h in d){if(d[h]!==this.offers[c].TREE[h]){g=false;break}}if(g){if(this.offers[c].CAN_BUY){f=true;break}}}return f},setCurrent:function(){var f,d=0,l=[],j="",k=false,c={},m=[],g=this.offers[this.offerNum].TREE;for(f=0;f<this.treeProps.length;f++){j="PROP_"+this.treeProps[f].ID;k=this.getRowValues(c,j);if(!k){break}if(BX.util.in_array(g[j],k)){c[j]=g[j]}else{c[j]=k[0];this.offerNum=0}if(this.showAbsent){l=[];m=[];m=BX.clone(c,true);for(d=0;d<k.length;d++){m[j]=k[d];if(this.getCanBuy(m)){l[l.length]=k[d]}}}else{l=k}this.updateRow(f,c[j],k,l)}this.selectedValues=c;this.changeInfo()},changeInfo:function(){var d,c,h=-1,f=true,g;for(d=0;d<this.offers.length;d++){f=true;for(c in this.selectedValues){if(this.selectedValues[c]!==this.offers[d].TREE[c]){f=false;break}}if(f){h=d;break}}if(h>-1){if(parseInt(this.offers[h].MORE_PHOTO_COUNT)>1&&this.obPictSlider){if(this.obPict){this.obPict.style.display="none"}if(this.obSecondPict){this.obSecondPict.style.display="none"}BX.cleanNode(this.obPictSlider);for(d in this.offers[h].MORE_PHOTO){if(this.offers[h].MORE_PHOTO.hasOwnProperty(d)){this.obPictSlider.appendChild(BX.create("SPAN",{props:{className:"product-item-image-slide item"+(d==0?" active":"")},style:{backgroundImage:"url('"+this.offers[h].MORE_PHOTO[d].SRC+"')"}}))}}if(this.obPictSliderIndicator){BX.cleanNode(this.obPictSliderIndicator);for(d in this.offers[h].MORE_PHOTO){if(this.offers[h].MORE_PHOTO.hasOwnProperty(d)){this.obPictSliderIndicator.appendChild(BX.create("DIV",{attrs:{"data-go-to":d},props:{className:"product-item-image-slider-control"+(d==0?" active":"")}}));this.obPictSliderIndicator.appendChild(document.createTextNode(" "))}}this.obPictSliderIndicator.style.display=""}if(this.obPictSliderProgressBar){this.obPictSliderProgressBar.style.display=""}this.obPictSlider.style.display="";this.initializeSlider()}else{if(this.obPictSlider){this.obPictSlider.style.display="none"}if(this.obPictSliderIndicator){this.obPictSliderIndicator.style.display="none"}if(this.obPictSliderProgressBar){this.obPictSliderProgressBar.style.display="none"}if(this.obPict){if(this.offers[h].PREVIEW_PICTURE){BX.adjust(this.obPict,{style:{backgroundImage:"url('"+this.offers[h].PREVIEW_PICTURE.SRC+"')"}})}else{BX.adjust(this.obPict,{style:{backgroundImage:"url('"+this.defaultPict.pict.SRC+"')"}})}this.obPict.style.display=""}if(this.secondPict&&this.obSecondPict){if(this.offers[h].PREVIEW_PICTURE_SECOND){BX.adjust(this.obSecondPict,{style:{backgroundImage:"url('"+this.offers[h].PREVIEW_PICTURE_SECOND.SRC+"')"}})}else{if(this.offers[h].PREVIEW_PICTURE.SRC){BX.adjust(this.obSecondPict,{style:{backgroundImage:"url('"+this.offers[h].PREVIEW_PICTURE.SRC+"')"}})}else{if(this.defaultPict.secondPict){BX.adjust(this.obSecondPict,{style:{backgroundImage:"url('"+this.defaultPict.secondPict.SRC+"')"}})}else{BX.adjust(this.obSecondPict,{style:{backgroundImage:"url('"+this.defaultPict.pict.SRC+"')"}})}}}this.obSecondPict.style.display=""}}if(this.showSkuProps&&this.obSkuProps){if(this.offers[h].DISPLAY_PROPERTIES.length){BX.adjust(this.obSkuProps,{style:{display:""},html:this.offers[h].DISPLAY_PROPERTIES})}else{BX.adjust(this.obSkuProps,{style:{display:"none"},html:""})}}this.quantitySet(h);this.setPrice();this.setCompared(this.offers[h].COMPARED);this.offerNum=h}},checkPriceRange:function(d){if(typeof d==="undefined"||this.currentPriceMode!="Q"){return}var c,h=false;for(var f in this.currentQuantityRanges){if(this.currentQuantityRanges.hasOwnProperty(f)){c=this.currentQuantityRanges[f];if(parseInt(d)>=parseInt(c.SORT_FROM)&&(c.SORT_TO=="INF"||parseInt(d)<=parseInt(c.SORT_TO))){h=true;this.currentQuantityRangeSelected=c.HASH;break}}}if(!h&&(c=this.getMinPriceRange())){this.currentQuantityRangeSelected=c.HASH}for(var g in this.currentPrices){if(this.currentPrices.hasOwnProperty(g)){if(this.currentPrices[g].QUANTITY_HASH==this.currentQuantityRangeSelected){this.currentPriceSelected=g;break}}}},getMinPriceRange:function(){var d;for(var c in this.currentQuantityRanges){if(this.currentQuantityRanges.hasOwnProperty(c)){if(!d||parseInt(this.currentQuantityRanges[c].SORT_FROM)<parseInt(d.SORT_FROM)){d=this.currentQuantityRanges[c]}}}return d},checkQuantityControls:function(){if(!this.obQuantity){return}var d=this.checkQuantity&&parseFloat(this.obQuantity.value)+this.stepQuantity>this.maxQuantity,c=parseFloat(this.obQuantity.value)-this.stepQuantity<this.minQuantity;if(d){BX.addClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")}else{if(BX.hasClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")){BX.removeClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")}}if(c){BX.addClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")}else{if(BX.hasClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")){BX.removeClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")}}if(d&&c){this.obQuantity.setAttribute("disabled","disabled")}else{this.obQuantity.removeAttribute("disabled")}},setPrice:function(){var d,c;if(this.obQuantity){this.checkPriceRange(this.obQuantity.value)}this.checkQuantityControls();c=this.currentPrices[this.currentPriceSelected];if(this.obPrice){if(c){BX.adjust(this.obPrice,{html:BX.Currency.currencyFormat(c.RATIO_PRICE,c.CURRENCY,true)})}else{BX.adjust(this.obPrice,{html:""})}if(this.showOldPrice&&this.obPriceOld){if(c&&c.RATIO_PRICE!==c.RATIO_BASE_PRICE){BX.adjust(this.obPriceOld,{style:{display:""},html:BX.Currency.currencyFormat(c.RATIO_BASE_PRICE,c.CURRENCY,true)})}else{BX.adjust(this.obPriceOld,{style:{display:"none"},html:""})}}if(this.obPriceTotal){if(c&&this.obQuantity&&this.obQuantity.value!=this.stepQuantity){BX.adjust(this.obPriceTotal,{html:BX.message("PRICE_TOTAL_PREFIX")+" <strong>"+BX.Currency.currencyFormat(c.PRICE*this.obQuantity.value,c.CURRENCY,true)+"</strong>",style:{display:""}})}else{BX.adjust(this.obPriceTotal,{html:"",style:{display:"none"}})}}if(this.showPercent){if(c&&parseInt(c.PERCENT)>0){d={style:{display:""},html:-c.PERCENT+"%"}}else{d={style:{display:"none"},html:""}}if(this.obDscPerc){BX.adjust(this.obDscPerc,d)}if(this.obSecondDscPerc){BX.adjust(this.obSecondDscPerc,d)}}}},compare:function(f){var d=this.obCompare.querySelector('[data-entity="compare-checkbox"]'),j=BX.getEventTarget(f),g=true;if(d){g=j===d?d.checked:!d.checked}var h=g?this.compareData.compareUrl:this.compareData.compareDeleteUrl,c;if(h){if(j!==d){BX.PreventDefault(f);this.setCompared(g)}switch(this.productType){case 0:case 1:case 2:c=h.replace("#ID#",this.product.id.toString());break;case 3:c=h.replace("#ID#",this.offers[this.offerNum].ID);break}BX.ajax({method:"POST",dataType:g?"json":"html",url:c+(c.indexOf("?")!==-1?"&":"?")+"ajax_action=Y",onsuccess:g?BX.proxy(this.compareResult,this):BX.proxy(this.compareDeleteResult,this)})}},compareResult:function(c){var f,d;if(this.obPopupWin){this.obPopupWin.close()}if(!BX.type.isPlainObject(c)){return}this.initPopupWindow();if(this.offers.length>0){this.offers[this.offerNum].COMPARED=c.STATUS==="OK"}if(c.STATUS==="OK"){BX.onCustomEvent("OnCompareChange");f='<div style="width: 100%; margin: 0; text-align: center;"><p>'+BX.message("COMPARE_MESSAGE_OK")+"</p></div>";if(this.showClosePopup){d=[new a({text:BX.message("BTN_MESSAGE_COMPARE_REDIRECT"),events:{click:BX.delegate(this.compareRedirect,this)},style:{marginRight:"10px"}}),new a({text:BX.message("BTN_MESSAGE_CLOSE_POPUP"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}else{d=[new a({text:BX.message("BTN_MESSAGE_COMPARE_REDIRECT"),events:{click:BX.delegate(this.compareRedirect,this)}})]}}else{f='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(c.MESSAGE?c.MESSAGE:BX.message("COMPARE_UNKNOWN_ERROR"))+"</p></div>";d=[new a({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}this.obPopupWin.setTitleBar(BX.message("COMPARE_TITLE"));this.obPopupWin.setContent(f);this.obPopupWin.setButtons(d);this.obPopupWin.show()},compareDeleteResult:function(){BX.onCustomEvent("OnCompareChange");if(this.offers&&this.offers.length){this.offers[this.offerNum].COMPARED=false}},setCompared:function(d){if(!this.obCompare){return}var c=this.obCompare.querySelector('[data-entity="compare-checkbox"]');if(c){c.checked=d}},setCompareInfo:function(d){if(!BX.type.isArray(d)){return}for(var c in this.offers){if(this.offers.hasOwnProperty(c)){this.offers[c].COMPARED=BX.util.in_array(this.offers[c].ID,d)}}},compareRedirect:function(){if(this.compareData.comparePath){location.href=this.compareData.comparePath}else{this.obPopupWin.close()}},checkDeletedCompare:function(d){switch(this.productType){case 0:case 1:case 2:if(this.product.id==d){this.setCompared(false)}break;case 3:var c=this.offers.length;while(c--){if(this.offers[c].ID==d){this.offers[c].COMPARED=false;if(this.offerNum==c){this.setCompared(false)}break}}}},initBasketUrl:function(){this.basketUrl=this.basketMode==="ADD"?this.basketData.add_url:this.basketData.buy_url;switch(this.productType){case 1:case 2:this.basketUrl=this.basketUrl.replace("#ID#",this.product.id.toString());break;case 3:this.basketUrl=this.basketUrl.replace("#ID#",this.offers[this.offerNum].ID);break}this.basketParams={ajax_basket:"Y"};if(this.showQuantity){this.basketParams[this.basketData.quantity]=this.obQuantity.value}if(this.basketData.sku_props){this.basketParams[this.basketData.sku_props_var]=this.basketData.sku_props}},fillBasketProps:function(){if(!this.visual.BASKET_PROP_DIV){return}var d=0,c=null,g=false,f=null;if(this.basketData.useProps&&!this.basketData.emptyProps){if(this.obPopupWin&&this.obPopupWin.contentContainer){f=this.obPopupWin.contentContainer}}else{f=BX(this.visual.BASKET_PROP_DIV)}if(f){c=f.getElementsByTagName("select");if(c&&c.length){for(d=0;d<c.length;d++){if(!c[d].disabled){switch(c[d].type.toLowerCase()){case"select-one":this.basketParams[c[d].name]=c[d].value;g=true;break;default:break}}}}c=f.getElementsByTagName("input");if(c&&c.length){for(d=0;d<c.length;d++){if(!c[d].disabled){switch(c[d].type.toLowerCase()){case"hidden":this.basketParams[c[d].name]=c[d].value;g=true;break;case"radio":if(c[d].checked){this.basketParams[c[d].name]=c[d].value;g=true}break;default:break}}}}}if(!g){this.basketParams[this.basketData.props]=[];this.basketParams[this.basketData.props][0]=0}},add2Basket:function(){this.basketMode="ADD";this.basket()},buyBasket:function(){this.basketMode="BUY";this.basket()},sendToBasket:function(){if(!this.canBuy){return}if(this.product&&this.product.id&&this.bigData){this.rememberProductRecommendation()}this.initBasketUrl();this.fillBasketProps();BX.ajax({method:"POST",dataType:"json",url:this.basketUrl,data:this.basketParams,onsuccess:BX.proxy(this.basketResult,this)})},basket:function(){var c="";if(!this.canBuy){return}switch(this.productType){case 1:case 2:if(this.basketData.useProps&&!this.basketData.emptyProps){this.initPopupWindow();this.obPopupWin.setTitleBar(BX.message("TITLE_BASKET_PROPS"));if(BX(this.visual.BASKET_PROP_DIV)){c=BX(this.visual.BASKET_PROP_DIV).innerHTML}this.obPopupWin.setContent(c);this.obPopupWin.setButtons([new a({text:BX.message("BTN_MESSAGE_SEND_PROPS"),events:{click:BX.delegate(this.sendToBasket,this)}})]);this.obPopupWin.show()}else{this.sendToBasket()}break;case 3:this.sendToBasket();break}},basketResult:function(d){var h="",f="",g,c=[];if(this.obPopupWin){this.obPopupWin.close()}if(!BX.type.isPlainObject(d)){return}g=d.STATUS==="OK";if(g){this.setAnalyticsDataLayer("addToCart")}if(g&&this.basketAction==="BUY"){this.basketRedirect()}else{this.initPopupWindow();if(g){BX.onCustomEvent("OnBasketChange");if(BX.findParent(this.obProduct,{className:"bx_sale_gift_main_products"},10)){BX.onCustomEvent("onAddToBasketMainProduct",[this])}switch(this.productType){case 1:case 2:f=this.product.pict.SRC;break;case 3:f=this.offers[this.offerNum].PREVIEW_PICTURE?this.offers[this.offerNum].PREVIEW_PICTURE.SRC:this.defaultPict.pict.SRC;break}h='<div style="width: 100%; margin: 0; text-align: center;"><img src="'+f+'" height="130" style="max-height:130px"><p>'+this.product.name+"</p></div>";if(this.showClosePopup){c=[new a({text:BX.message("BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(this.basketRedirect,this)},style:{marginRight:"10px"}}),new a({text:BX.message("BTN_MESSAGE_CLOSE_POPUP"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}else{c=[new a({text:BX.message("BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(this.basketRedirect,this)}})]}}else{h='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(d.MESSAGE?d.MESSAGE:BX.message("BASKET_UNKNOWN_ERROR"))+"</p></div>";c=[new a({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}this.obPopupWin.setTitleBar(g?BX.message("TITLE_SUCCESSFUL"):BX.message("TITLE_ERROR"));this.obPopupWin.setContent(h);this.obPopupWin.setButtons(c);this.obPopupWin.show()}},basketRedirect:function(){location.href=this.basketData.basketUrl?this.basketData.basketUrl:BX.message("BASKET_URL")},initPopupWindow:function(){if(this.obPopupWin){return}this.obPopupWin=BX.PopupWindowManager.create("CatalogSectionBasket_"+this.visual.ID,null,{autoHide:true,offsetLeft:0,offsetTop:0,overlay:true,closeByEsc:true,titleBar:true,closeIcon:true,contentColor:"white",className:this.templateTheme?"bx-"+this.templateTheme:""})}}})(window);