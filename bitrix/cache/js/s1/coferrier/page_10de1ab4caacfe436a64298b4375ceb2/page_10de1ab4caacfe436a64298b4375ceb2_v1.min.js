(function(){if(!!window.JCCatalogSectionComponent){return}window.JCCatalogSectionComponent=function(a){this.formPosting=false;this.siteId=a.siteId||"";this.ajaxId=a.ajaxId||"";this.template=a.template||"";this.componentPath=a.componentPath||"";this.parameters=a.parameters||"";this.deferredLoad=a.deferredLoad;this.cyclicLoading={mode:false,counterName:"",counter:0};if(BX.type.isPlainObject(a.cyclicLoading)){this.cyclicLoading.mode=a.cyclicLoading.mode||false;this.cyclicLoading.counterName=a.cyclicLoading.counterName||"cycleCount";this.cyclicLoading.counter=a.cyclicLoading.counter||0}if(a.navParams){this.navParams={NavNum:a.navParams.NavNum||1,NavPageNomer:parseInt(a.navParams.NavPageNomer)||1,NavPageCount:parseInt(a.navParams.NavPageCount)||1}}this.bigData=a.bigData||{enabled:false};this.container=document.querySelector('[data-entity="'+a.container+'"]');this.lazyLoadContainer=document.querySelector('[data-entity="lazy-'+a.container+'"]');this.showMoreButton=null;this.showMoreButtonMessage=null;if(this.bigData.enabled&&BX.util.object_keys(this.bigData.rows).length>0){BX.cookie_prefix=this.bigData.js.cookiePrefix||"";BX.cookie_domain=this.bigData.js.cookieDomain||"";BX.current_server_time=this.bigData.js.serverTime;BX.ready(BX.delegate(this.bigDataLoad,this))}if(a.initiallyShowHeader){BX.ready(BX.delegate(this.showHeader,this))}if(a.lazyLoad){this.showMoreButton=document.querySelector('[data-use="show-more-'+this.navParams.NavNum+'"]');if(BX.Type.isDomNode(this.showMoreButton)){this.showMoreButtonMessage=this.showMoreButton.innerHTML;BX.bind(this.showMoreButton,"click",BX.proxy(this.showMore,this))}}if(a.loadOnScroll){BX.bind(window,"scroll",BX.proxy(this.loadOnScroll,this))}};window.JCCatalogSectionComponent.prototype={checkButton:function(){if(this.showMoreButton){if(this.navParams.NavPageNomer==this.navParams.NavPageCount){BX.remove(this.showMoreButton)}else{this.lazyLoadContainer.appendChild(this.showMoreButton)}}},enableButton:function(){if(this.showMoreButton){BX.removeClass(this.showMoreButton,"disabled");this.showMoreButton.innerHTML=this.showMoreButtonMessage}},disableButton:function(){if(this.showMoreButton){BX.addClass(this.showMoreButton,"disabled");this.showMoreButton.innerHTML=BX.message("BTN_MESSAGE_LAZY_LOAD_WAITER")}},loadOnScroll:function(){var a=BX.pos(this.container);var b=BX.GetWindowScrollPos().scrollTop;if(b+window.innerHeight*2>a.bottom){this.showMore()}},showMore:function(){if(!this.formPosting){var a={};a.action="showMore";var b=false;if(this.deferredLoad){b=true;a["PAGEN_"+this.navParams.NavNum]=1}else{if(this.navParams.NavPageNomer<this.navParams.NavPageCount){b=true;a["PAGEN_"+this.navParams.NavNum]=this.navParams.NavPageNomer+1}else{if(this.cyclicLoading.mode){b=true;a["PAGEN_"+this.navParams.NavNum]=1;this.navParams.NavPageNomer=0;this.cyclicLoading.counter++}}}if(this.cyclicLoading.mode&&this.cyclicLoading.counter>0){a[this.cyclicLoading.counterName]=this.cyclicLoading.counter}if(b){this.formPosting=true;this.disableButton();this.sendRequest(a)}}},bigDataLoad:function(){var c="https://analytics.bitrix.info/crecoms/v1_0/recoms.php",d=BX.ajax.prepareData(this.bigData.params);if(d){c+=(c.indexOf("?")!==-1?"&":"?")+d}var b=BX.delegate((function(a){this.sendRequest({action:"deferredLoad",bigData:"Y",items:a&&a.items||[],rid:a&&a.id,count:this.bigData.count,rowsRange:this.bigData.rowsRange,shownIds:this.bigData.shownIds})}),this);BX.ajax({method:"GET",dataType:"json",url:c,timeout:3,onsuccess:b,onfailure:b})},sendRequest:function(c){var d=new BX.Loader({target:this.container,mode:"custom"});var b={siteId:this.siteId,template:this.template,parameters:this.parameters};if(this.ajaxId){b.AJAX_ID=this.ajaxId}d.show();BX.ajax({url:this.componentPath+"/ajax.php"+(document.location.href.indexOf("clear_cache=Y")!==-1?"?clear_cache=Y":""),method:"POST",dataType:"json",timeout:60,data:BX.merge(b,c),onsuccess:BX.delegate((function(e){d.hide();if(!e||!e.JS){return}BX.ajax.processScripts(BX.processHTML(e.JS).SCRIPT,false,BX.delegate((function(){this.showAction(e,c)}),this))}),this)})},showAction:function(a,b){if(!b){return}switch(b.action){case"showMore":this.processShowMoreAction(a);break}},processShowMoreAction:function(a){this.formPosting=false;this.enableButton();if(a){this.navParams.NavPageNomer++;this.processItems(a.items);this.processPagination(a.pagination);this.processEpilogue(a.epilogue);this.processNavParams(a.navParams);if(BX.type.isNotEmptyString(a.parameters)){this.processParameters(a.parameters)}this.checkButton()}},processItems:function(d,g){if(!d){return}var b=BX.processHTML(d,false),c=BX.create("DIV");var h,f,j;c.innerHTML=b.HTML;h=c.querySelectorAll('[data-entity="items-row"]');if(h.length){this.showHeader(true);for(f in h){if(h.hasOwnProperty(f)){j=g?this.container.querySelectorAll('[data-entity="items-row"]'):false;h[f].style.opacity=0;if(j&&BX.type.isDomNode(j[g[f]])){j[g[f]].parentNode.insertBefore(h[f],j[g[f]])}else{this.container.appendChild(h[f])}}}new BX.easing({duration:2000,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(a){for(var i in h){if(h.hasOwnProperty(i)){h[i].style.opacity=a.opacity/100}}},complete:function(){for(var a in h){if(h.hasOwnProperty(a)){h[a].removeAttribute("style")}}}}).animate()}BX.ajax.processScripts(b.SCRIPT)},processPagination:function(c){if(!c){return}var d=document.querySelectorAll('[data-pagination-num="'+this.navParams.NavNum+'"]');for(var b in d){if(d.hasOwnProperty(b)){d[b].innerHTML=c}}},processEpilogue:function(a){if(!a){return}var b=BX.processHTML(a,false);BX.ajax.processScripts(b.SCRIPT)},processNavParams:function(a){if(this.deferredLoad){this.deferredLoad=false;this.navParams.NavPageCount=a.NavPageCount;this.navParams.NavNum=a.NavNum}},processParameters:function(a){this.parameters=a},showHeader:function(c){var d=BX.findParent(this.container,{attr:{"data-entity":"parent-container"}}),b;if(d&&BX.type.isDomNode(d)){b=d.querySelector('[data-entity="header"]');if(b&&b.getAttribute("data-showed")!="true"){b.style.display="";if(c){new BX.easing({duration:2000,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(a){b.style.opacity=a.opacity/100},complete:function(){b.removeAttribute("style");b.setAttribute("data-showed","true")}}).animate()}else{b.style.opacity=100}}}}}})();(function(b){if(b.JCCatalogItem){return}var a=function(c){a.superclass.constructor.apply(this,arguments);this.buttonNode=BX.create("button",{props:{className:"btn btn-primary btn-buy btn-sm",id:this.id},style:typeof c.style==="object"?c.style:{},text:c.text,events:this.contextEvents});if(BX.browser.IsIE()){this.buttonNode.setAttribute("hideFocus","hidefocus")}};BX.extend(a,BX.PopupWindowButton);b.JCCatalogItem=function(c){this.productType=0;this.showQuantity=true;this.showAbsent=true;this.secondPict=false;this.showOldPrice=false;this.showMaxQuantity="N";this.relativeQuantityFactor=5;this.showSkuProps=false;this.basketAction="ADD";this.showClosePopup=false;this.useCompare=false;this.showSubscription=false;this.useOfferName=false;this.visual={ID:"",NAME:"",PICT_SLIDER_ID:"",QUANTITY_ID:"",QUANTITY_UP_ID:"",QUANTITY_DOWN_ID:"",QUANTITY_COUNTER_ID:"",QUANTITY_LIMIT:"",QUANTITY_MEASURE:"",PRICE_ID:"",PRICE_TWIN_ID:"",PRICE_TOTAL_ID:"",BLOCK_PRICE_OLD_ID:"",BLOCK_PRICE_OLD_TWIN_ID:"",PRICE_OLD_ID:"",PRICE_OLD_TWIN_ID:"",PRICE_DISCOUNT_ID:"",PRICE_DISCOUNT_TWIN_ID:"",PREBUY_SWIPE_BTN:"",PREBUY_OPEN_BTN:"",PREBUY_CLOSE_BTN:"",PREBUY_OVERLAY:"",PREBUY_CONTAINER:"",PREBUY_NAME:"",PREBUY_PICT:"",PREBUY:"",DISPLAY_PROP_DIV:"",BASKET_PROP_DIV:"",SUBSCRIBE_ID:"",BUY_ID:"",ADD_BASKET_ID:"",TREE_ID:""};this.product={checkQuantity:false,maxQuantity:0,stepQuantity:1,isDblQuantity:false,canBuy:true,name:"",pict:{},id:0,addUrl:"",buyUrl:""};this.basketMode="";this.basketData={useProps:false,emptyProps:false,quantity:"quantity",props:"prop",basketUrl:"",sku_props:"",sku_props_var:"basket_props",add_url:"",buy_url:""};this.compareData={compareUrl:"",compareDeleteUrl:"",comparePath:""};this.defaultPict={pict:null,secondPict:null};this.defaultSliderOptions={interval:3000,wrap:true};this.slider={options:{},items:[],active:null,sliding:null,paused:null,interval:null,progress:null};this.touch=null;this.quantityDelay=null;this.quantityTimer=null;this.checkQuantity=false;this.maxQuantity=0;this.minQuantity=0;this.stepQuantity=1;this.isDblQuantity=false;this.canBuy=true;this.precision=6;this.precisionFactor=Math.pow(10,this.precision);this.bigData=false;this.fullDisplayMode=false;this.viewMode="";this.templateTheme="";this.currentPriceMode="";this.currentPrices=[];this.currentPriceSelected=0;this.currentQuantityRanges=[];this.currentQuantityRangeSelected=0;this.offers=[];this.offerNum=0;this.treeProps=[];this.selectedValues={};this.viewedParams={};this.prebuyPopup=null;this.prebuyPopupContainer=null;this.prebuyPopupSwipeBtn=null;this.prebuyPopupOpenBtn=null;this.prebuyPopupOverlay=null;this.prebuyPopupCloseBtn=null;this.prebuyPopupName=null;this.prebuyPopupPict=null;this.obProduct=null;this.blockNodes={};this.obQuantity=null;this.obQuantityUp=null;this.obQuantityDown=null;this.obQuantityLimit={};this.obQuantityCounter=null;this.obName=null;this.obPictSlider=null;this.obPictSliderIndicator=null;this.obPrice=null;this.priceTwin=null;this.blockOldPrice=null;this.blockOldPriceTwin=null;this.obPriceOld=null;this.priceOldTwin=null;this.priceDiscount=null;this.priceDiscountTwin=null;this.obTree=null;this.obBuyBtn=null;this.obAddBasketBtn=null;this.obBasketActions=null;this.obNotAvail=null;this.obSubscribe=null;this.obSkuProps=null;this.obMeasure=null;this.obMeasureContainer=null;this.obCompare=null;this.obPopupWin=null;this.basketUrl="";this.basketParams={};this.isTouchDevice=BX.hasClass(document.documentElement,"bx-touch");this.hoverTimer=null;this.hoverStateChangeForbidden=false;this.mouseX=null;this.mouseY=null;this.useEnhancedEcommerce=false;this.dataLayerName="dataLayer";this.brandProperty=false;this.errorCode=0;if(typeof c==="object"){if(c.PRODUCT_TYPE){this.productType=parseInt(c.PRODUCT_TYPE,10)}this.showQuantity=c.SHOW_QUANTITY;this.showAbsent=c.SHOW_ABSENT;this.secondPict=c.SECOND_PICT;this.showOldPrice=c.SHOW_OLD_PRICE;this.showMaxQuantity=c.SHOW_MAX_QUANTITY;this.relativeQuantityFactor=parseInt(c.RELATIVE_QUANTITY_FACTOR);this.showSkuProps=c.SHOW_SKU_PROPS;this.showSubscription=c.USE_SUBSCRIBE;this.useOfferName=c.USE_OFFER_NAME;this.viewedParams.siteId=c.SITE_ID;if(c.ADD_TO_BASKET_ACTION){this.basketAction=c.ADD_TO_BASKET_ACTION}this.showClosePopup=c.SHOW_CLOSE_POPUP;this.useCompare=c.DISPLAY_COMPARE;this.fullDisplayMode=c.PRODUCT_DISPLAY_MODE==="Y";this.bigData=c.BIG_DATA;this.viewMode=c.VIEW_MODE||"";this.templateTheme=c.TEMPLATE_THEME||"";this.useEnhancedEcommerce=c.USE_ENHANCED_ECOMMERCE==="Y";this.dataLayerName=c.DATA_LAYER_NAME;this.brandProperty=c.BRAND_PROPERTY;this.visual=c.VISUAL;switch(this.productType){case 0:case 1:case 2:if(c.PRODUCT&&typeof c.PRODUCT==="object"){this.currentPriceMode=c.PRODUCT.ITEM_PRICE_MODE;this.currentPrices=c.PRODUCT.ITEM_PRICES;this.currentPriceSelected=c.PRODUCT.ITEM_PRICE_SELECTED;this.currentQuantityRanges=c.PRODUCT.ITEM_QUANTITY_RANGES;this.currentQuantityRangeSelected=c.PRODUCT.ITEM_QUANTITY_RANGE_SELECTED;if(this.showQuantity){this.product.checkQuantity=c.PRODUCT.CHECK_QUANTITY;this.product.isDblQuantity=c.PRODUCT.QUANTITY_FLOAT;if(this.product.checkQuantity){this.product.maxQuantity=this.product.isDblQuantity?parseFloat(c.PRODUCT.MAX_QUANTITY):parseInt(c.PRODUCT.MAX_QUANTITY,10)}this.product.stepQuantity=this.product.isDblQuantity?parseFloat(c.PRODUCT.STEP_QUANTITY):parseInt(c.PRODUCT.STEP_QUANTITY,10);this.checkQuantity=this.product.checkQuantity;this.isDblQuantity=this.product.isDblQuantity;this.stepQuantity=this.product.stepQuantity;this.maxQuantity=this.product.maxQuantity;this.minQuantity=this.currentPriceMode==="Q"?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity;if(this.isDblQuantity){this.stepQuantity=Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor}}this.product.canBuy=c.PRODUCT.CAN_BUY;if(c.PRODUCT.MORE_PHOTO_COUNT){this.product.morePhotoCount=c.PRODUCT.MORE_PHOTO_COUNT;this.product.morePhoto=c.PRODUCT.MORE_PHOTO;this.product.sliderPhoto=c.PRODUCT.RESIZED_SLIDER}if(c.PRODUCT.RCM_ID){this.product.rcmId=c.PRODUCT.RCM_ID}this.canBuy=this.product.canBuy;this.product.name=c.PRODUCT.NAME;this.product.pict=c.PRODUCT.PICT;this.product.id=c.PRODUCT.ID;this.viewedParams.skuId=parseInt(c.PRODUCT.ID);this.viewedParams.productId=parseInt(c.PRODUCT.ID);this.product.DETAIL_PAGE_URL=c.PRODUCT.DETAIL_PAGE_URL;if(c.PRODUCT.ADD_URL){this.product.addUrl=c.PRODUCT.ADD_URL}if(c.PRODUCT.BUY_URL){this.product.buyUrl=c.PRODUCT.BUY_URL}if(c.BASKET&&typeof c.BASKET==="object"){this.basketData.useProps=c.BASKET.ADD_PROPS;this.basketData.emptyProps=c.BASKET.EMPTY_PROPS}}else{this.errorCode=-1}break;case 3:if(c.PRODUCT&&typeof c.PRODUCT==="object"){this.product.name=c.PRODUCT.NAME;this.product.id=c.PRODUCT.ID;this.product.DETAIL_PAGE_URL=c.PRODUCT.DETAIL_PAGE_URL;this.product.morePhotoCount=c.PRODUCT.MORE_PHOTO_COUNT;this.product.morePhoto=c.PRODUCT.MORE_PHOTO;this.product.sliderPhoto=c.PRODUCT.RESIZED_SLIDER;if(c.PRODUCT.RCM_ID){this.product.rcmId=c.PRODUCT.RCM_ID}}if(c.OFFERS&&BX.type.isArray(c.OFFERS)){this.offers=c.OFFERS;this.offerNum=0;if(c.OFFER_SELECTED){this.offerNum=parseInt(c.OFFER_SELECTED,10)}if(isNaN(this.offerNum)){this.offerNum=0}if(c.TREE_PROPS){this.treeProps=c.TREE_PROPS}if(c.DEFAULT_PICTURE){this.defaultPict.pict=c.DEFAULT_PICTURE.PICTURE;this.defaultPict.secondPict=c.DEFAULT_PICTURE.PICTURE_SECOND}}if(BX.type.isPlainObject(this.offers[this.offerNum])){this.viewedParams.skuId=parseInt(this.offers[this.offerNum].ID)}else{this.viewedParams.skuId=0}this.viewedParams.productId=parseInt(c.PRODUCT.ID);break;default:this.errorCode=-1}if(c.BASKET&&typeof c.BASKET==="object"){if(c.BASKET.QUANTITY){this.basketData.quantity=c.BASKET.QUANTITY}if(c.BASKET.PROPS){this.basketData.props=c.BASKET.PROPS}if(c.BASKET.BASKET_URL){this.basketData.basketUrl=c.BASKET.BASKET_URL}if(3===this.productType){if(c.BASKET.SKU_PROPS){this.basketData.sku_props=c.BASKET.SKU_PROPS}}if(c.BASKET.ADD_URL_TEMPLATE){this.basketData.add_url=c.BASKET.ADD_URL_TEMPLATE}if(c.BASKET.BUY_URL_TEMPLATE){this.basketData.buy_url=c.BASKET.BUY_URL_TEMPLATE}if(this.basketData.add_url===""&&this.basketData.buy_url===""){this.errorCode=-1024}}if(this.useCompare){if(c.COMPARE&&typeof c.COMPARE==="object"){if(c.COMPARE.COMPARE_PATH){this.compareData.comparePath=c.COMPARE.COMPARE_PATH}if(c.COMPARE.COMPARE_URL_TEMPLATE){this.compareData.compareUrl=c.COMPARE.COMPARE_URL_TEMPLATE}else{this.useCompare=false}if(c.COMPARE.COMPARE_DELETE_URL_TEMPLATE){this.compareData.compareDeleteUrl=c.COMPARE.COMPARE_DELETE_URL_TEMPLATE}else{this.useCompare=false}}else{this.useCompare=false}}this.isFacebookConversionCustomizeProductEventEnabled=c.IS_FACEBOOK_CONVERSION_CUSTOMIZE_PRODUCT_EVENT_ENABLED}if(this.errorCode===0){BX.ready(BX.delegate(this.init,this))}};b.JCCatalogItem.prototype={init:function(){var f=0,d=null;this.obProduct=BX(this.visual.ID);if(!this.obProduct){this.errorCode=-1}this.obPictSlider=BX(this.visual.PICT_SLIDER_ID);this.sliderControlLeft=this.obPictSlider.parentNode.querySelector('[data-entity="slider-control-left"]');this.sliderControlRight=this.obPictSlider.parentNode.querySelector('[data-entity="slider-control-right"]');if(this.product.morePhoto.length>1&&this.sliderControlLeft&&this.sliderControlRight){this.sliderControlRight.style.display="";this.sliderControlLeft.style.display=""}this.obPictSliderIndicator=BX(this.visual.PICT_SLIDER_ID+"_indicator");this.obPictSliderPager=BX(this.visual.PICT_SLIDER_ID+"_pager");if(!this.obPictSlider){this.errorCode=-4}this.obPrice=BX(this.visual.PRICE_ID);if(!this.obPrice){this.errorCode=-16}this.priceTwin=BX(this.visual.PRICE_TWIN_ID);if(!this.priceTwin){this.errorCode=-16}this.obPriceTotal=BX(this.visual.PRICE_TOTAL_ID);this.initOldPriceDom();this.prebuyPopup=BX(this.visual.PREBUY);this.prebuyPopupSwipeBtn=BX(this.visual.PREBUY_SWIPE_BTN);this.prebuyPopupContainer=BX(this.visual.PREBUY_CONTAINER);this.prebuyPopupOverlay=BX(this.visual.PREBUY_OVERLAY);this.prebuyPopupOpenBtn=BX(this.visual.PREBUY_OPEN_BTN);this.prebuyPopupCloseBtn=BX(this.visual.PREBUY_CLOSE_BTN);this.prebuyPopupPict=BX(this.visual.PREBUY_PICT);if(this.showQuantity&&this.visual.QUANTITY_ID){this.obQuantity=BX(this.visual.QUANTITY_ID);this.obQuantityCounter=BX(this.visual.QUANTITY_COUNTER_ID);this.blockNodes.quantity=this.obProduct.querySelector('[data-entity="quantity-block"]');if(!this.isTouchDevice){BX.bind(this.obQuantity,"focus",BX.proxy(this.onFocus,this));BX.bind(this.obQuantity,"blur",BX.proxy(this.onBlur,this))}if(this.visual.QUANTITY_UP_ID){this.obQuantityUp=BX(this.visual.QUANTITY_UP_ID)}if(this.visual.QUANTITY_DOWN_ID){this.obQuantityDown=BX(this.visual.QUANTITY_DOWN_ID)}}if(this.visual.QUANTITY_LIMIT&&this.showMaxQuantity!=="N"){this.obQuantityLimit.all=BX(this.visual.QUANTITY_LIMIT);if(this.obQuantityLimit.all){this.obQuantityLimit.value=this.obQuantityLimit.all.querySelector('[data-entity="quantity-limit-value"]');if(!this.obQuantityLimit.value){this.obQuantityLimit.all=null}}}if(this.productType===3&&this.fullDisplayMode){if(this.visual.TREE_ID){this.obTree=BX(this.visual.TREE_ID);if(!this.obTree){this.errorCode=-256}}if(this.visual.QUANTITY_MEASURE){this.obMeasure=BX(this.visual.QUANTITY_MEASURE)}}this.obBasketActions=BX(this.visual.BASKET_ACTIONS_ID);if(this.obBasketActions){if(this.visual.BUY_ID){this.obBuyBtn=BX(this.visual.BUY_ID)}if(this.visual.ADD_BASKET_ID){this.obAddBasketBtn=BX(this.visual.ADD_BASKET_ID)}}this.obNotAvail=BX(this.visual.NOT_AVAILABLE_MESS);if(this.showSubscription){this.obSubscribe=BX(this.visual.SUBSCRIBE_ID)}if(this.showSkuProps){if(this.visual.DISPLAY_PROP_DIV){this.obSkuProps=BX(this.visual.DISPLAY_PROP_DIV)}}if(this.useOfferName){this.obName=BX(this.visual.NAME);this.prebuyPopupName=BX(this.visual.PREBUY_NAME)}if(this.errorCode===0){BX.bind(this.prebuyPopupOpenBtn,"click",BX.proxy(this.prebuyPopupOpen,this));BX.bind(this.prebuyPopupOverlay,"click",BX.proxy(this.prebuyPopupClose,this));BX.bind(this.prebuyPopupCloseBtn,"click",BX.proxy(this.prebuyPopupClose,this));BX.bind(this.obAddBasketBtn,"click",BX.proxy(this.prebuyPopupClose,this));BX.bind(this.sliderControlLeft,"click",BX.proxy(this.slidePrev,this));BX.bind(this.sliderControlRight,"click",BX.proxy(this.slideNext,this));if(this.isTouchDevice){BX.bind(this.obPictSlider,"touchstart",BX.proxy(this.touchStartEvent,this));BX.bind(this.obPictSlider,"touchend",BX.proxy(this.touchEndEvent,this));BX.bind(this.obPictSlider,"touchmove",BX.proxy(this.touchMoveEvent,this));BX.bind(this.obPictSlider,"touchcancel",BX.proxy(this.touchEndEvent,this));BX.bind(this.prebuyPopupSwipeBtn,"touchstart",BX.proxy(this.prebuyPopupStartEvent,this));BX.bind(this.prebuyPopupSwipeBtn,"touchend",BX.proxy(this.prebuyPopupEndEvent,this));BX.bind(this.prebuyPopupSwipeBtn,"touchmove",BX.proxy(this.prebuyPopupMoveEvent,this));BX.bind(this.prebuyPopupSwipeBtn,"touchcancel",BX.proxy(this.prebuyPopupEndEvent,this))}else{BX.bind(this.obProduct,"mouseenter",BX.proxy(this.cycleSlider,this));BX.bind(this.obProduct,"mouseleave",BX.proxy(this.stopSlider,this))}if(this.bigData){var h=BX.findChildren(this.obProduct,{tag:"a"},true);if(h){for(f in h){if(h.hasOwnProperty(f)){if(h[f].getAttribute("href")==this.product.DETAIL_PAGE_URL){BX.bind(h[f],"click",BX.proxy(this.rememberProductRecommendation,this))}}}}}if(this.showQuantity){var g=this.isTouchDevice?"touchstart":"mousedown";var c=this.isTouchDevice?"touchend":"mouseup";if(this.obQuantityUp){BX.bind(this.obQuantityUp,g,BX.proxy(this.startQuantityInterval,this));BX.bind(this.obQuantityUp,c,BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityUp,"mouseout",BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityUp,"click",BX.delegate(this.quantityUp,this))}if(this.obQuantityDown){BX.bind(this.obQuantityDown,g,BX.proxy(this.startQuantityInterval,this));BX.bind(this.obQuantityDown,c,BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityDown,"mouseout",BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityDown,"click",BX.delegate(this.quantityDown,this))}if(this.obQuantity){BX.bind(this.obQuantity,"change",BX.delegate(this.quantityChange,this));BX.bind(this.obQuantity,"input",BX.delegate(this.quantityInput,this))}}switch(this.productType){case 0:case 1:case 2:this.checkQuantityControls();break;case 3:if(this.offers.length>0){d=BX.findChildren(this.obTree,{tagName:"li"},true);if(d&&d.length){for(f=0;f<d.length;f++){BX.bind(d[f],"click",BX.delegate(this.selectOfferProp,this))}}this.setCurrent()}break}this.initializeSlider();if(this.obBuyBtn){BX.bind(this.obBuyBtn,"click",BX.proxy(this.buyBasket,this))}if(this.obAddBasketBtn){BX.bind(this.obAddBasketBtn,"click",BX.proxy(this.add2Basket,this))}if(this.useCompare){this.obCompare=BX(this.visual.COMPARE_LINK_ID);if(this.obCompare){BX.bind(this.obCompare,"click",BX.proxy(this.compare,this))}BX.addCustomEvent("onCatalogDeleteCompare",BX.proxy(this.checkDeletedCompare,this))}}},initOldPriceDom:function(){if(!(this.productType===3&&this.fullDisplayMode)){this.showOldPrice=false}if(this.showOldPrice){if(BX.type.isNotEmptyString(this.visual.BLOCK_PRICE_OLD_ID)){this.blockOldPrice=BX(this.visual.BLOCK_PRICE_OLD_ID);if(BX.type.isElementNode(this.blockOldPrice)){if(BX.type.isNotEmptyString(this.visual.PRICE_OLD_ID)){this.obPriceOld=BX(this.visual.PRICE_OLD_ID)}if(BX.type.isNotEmptyString(this.visual.PRICE_DISCOUNT_ID)){this.priceDiscount=BX(this.visual.PRICE_DISCOUNT_ID)}}}if(BX.type.isNotEmptyString(this.visual.BLOCK_PRICE_OLD_TWIN_ID)){this.blockOldPriceTwin=BX(this.visual.BLOCK_PRICE_OLD_TWIN_ID);if(BX.type.isElementNode(this.blockOldPriceTwin)){if(BX.type.isNotEmptyString(this.visual.PRICE_OLD_TWIN_ID)){this.priceOldTwin=BX(this.visual.PRICE_OLD_TWIN_ID)}if(BX.type.isNotEmptyString(this.visual.PRICE_DISCOUNT_TWIN_ID)){this.priceDiscountTwin=BX(this.visual.PRICE_DISCOUNT_TWIN_ID)}}}}},setAnalyticsDataLayer:function(j){if(!this.useEnhancedEcommerce||!this.dataLayerName){return}var m={},t={},p=[],c,d,f,k,q,g;switch(this.productType){case 0:case 1:case 2:m={id:this.product.id,name:this.product.name,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,brand:BX.type.isArray(this.brandProperty)?this.brandProperty.join("/"):this.brandProperty};break;case 3:for(c in this.offers[this.offerNum].TREE){if(this.offers[this.offerNum].TREE.hasOwnProperty(c)){k=c.substring(5);q=this.offers[this.offerNum].TREE[c];for(d in this.treeProps){if(this.treeProps.hasOwnProperty(d)&&this.treeProps[d].ID==k){for(f in this.treeProps[d].VALUES){g=this.treeProps[d].VALUES[f];if(g.ID==q){p.push(g.NAME);break}}}}}}m={id:this.offers[this.offerNum].ID,name:this.offers[this.offerNum].NAME,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,brand:BX.type.isArray(this.brandProperty)?this.brandProperty.join("/"):this.brandProperty,variant:p.join("/")};break}switch(j){case"addToCart":t={ecommerce:{currencyCode:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].CURRENCY||"",add:{products:[{name:m.name||"",id:m.id||"",price:m.price||0,brand:m.brand||"",category:m.category||"",variant:m.variant||"",quantity:this.showQuantity&&this.obQuantity?this.obQuantity.value:1}]}}};break}b[this.dataLayerName]=b[this.dataLayerName]||[];b[this.dataLayerName].push(t)},hoverOn:function(c){clearTimeout(this.hoverTimer);this.obProduct.style.height=getComputedStyle(this.obProduct).height;BX.addClass(this.obProduct,"hover");BX.PreventDefault(c)},hoverOff:function(c){if(this.hoverStateChangeForbidden){return}BX.removeClass(this.obProduct,"hover");this.hoverTimer=setTimeout(BX.delegate((function(){this.obProduct.style.height="auto"}),this),300);BX.PreventDefault(c)},onFocus:function(){this.hoverStateChangeForbidden=true;BX.bind(document,"mousemove",BX.proxy(this.captureMousePosition,this))},onBlur:function(){this.hoverStateChangeForbidden=false;BX.unbind(document,"mousemove",BX.proxy(this.captureMousePosition,this));var c=document.elementFromPoint(this.mouseX,this.mouseY);if(!c||!this.obProduct.contains(c)){this.hoverOff()}},captureMousePosition:function(c){this.mouseX=c.clientX;this.mouseY=c.clientY},getCookie:function(d){var c=document.cookie.match(new RegExp("(?:^|; )"+d.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return c?decodeURIComponent(c[1]):null},rememberProductRecommendation:function(){var f=BX.cookie_prefix+"_RCM_PRODUCT_LOG",d=this.getCookie(f),j=false;var g=[],c;if(d){g=d.split(".")}var h=g.length;while(h--){c=g[h].split("-");if(c[0]==this.product.id){c=g[h].split("-");c[1]=this.product.rcmId;c[2]=BX.current_server_time;g[h]=c.join("-");j=true}else{if(BX.current_server_time-c[2]>3600*24*30){g.splice(h,1)}}}if(!j){g.push([this.product.id,this.product.rcmId,BX.current_server_time].join("-"))}var k=g.join("."),l=new Date((new Date).getTime()+1000*3600*24*365*10).toUTCString();document.cookie=f+"="+k+"; path=/; expires="+l+"; domain="+BX.cookie_domain},startQuantityInterval:function(){var d=BX.proxy_context;var c=d.id===this.visual.QUANTITY_DOWN_ID?BX.proxy(this.quantityDown,this):BX.proxy(this.quantityUp,this);this.quantityDelay=setTimeout(BX.delegate((function(){this.quantityTimer=setInterval(c,250)}),this),300)},clearQuantityInterval:function(){clearTimeout(this.quantityDelay);clearInterval(this.quantityTimer)},quantityUp:function(){var d=0,c=true;if(this.errorCode===0&&this.showQuantity&&this.canBuy){d=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10);if(!isNaN(d)){d+=this.stepQuantity;if(this.checkQuantity){if(d>this.maxQuantity){c=false}}if(c){if(this.isDblQuantity){d=Math.round(d*this.precisionFactor)/this.precisionFactor}this.obQuantity.value=d;this.obQuantityCounter.innerText=d;if(this.checkQuantity){if(d==this.maxQuantity){this.disableQuantityButton(this.obQuantityUp)}}this.enableQuantityButton(this.obQuantityDown);this.setPrice()}else{this.disableQuantityButton(this.obQuantityUp)}}}},quantityDown:function(){var d=0,c=true;if(this.errorCode===0&&this.showQuantity&&this.canBuy){d=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10);if(!isNaN(d)){d-=this.stepQuantity;this.checkPriceRange(d);if(d<this.minQuantity){c=false}if(c){if(this.isDblQuantity){d=Math.round(d*this.precisionFactor)/this.precisionFactor}this.obQuantity.value=d;this.obQuantityCounter.innerText=d;if(d==this.minQuantity){this.disableQuantityButton(this.obQuantityDown)}this.enableQuantityButton(this.obQuantityUp);this.setPrice()}else{this.disableQuantityButton(this.obQuantityDown)}}}},quantityChange:function(){var d=0,c;if(this.errorCode===0&&this.showQuantity){if(this.canBuy){d=this.isDblQuantity?parseFloat(this.obQuantity.value):Math.round(this.obQuantity.value);if(!isNaN(d)){if(this.checkQuantity){if(d>this.maxQuantity){d=this.maxQuantity}if(d==this.maxQuantity){this.disableQuantityButton(this.obQuantityUp)}}this.checkPriceRange(d);c=Math.floor(Math.round(d*this.precisionFactor/this.stepQuantity)/this.precisionFactor)||1;d=c<=1?this.stepQuantity:c*this.stepQuantity;d=Math.round(d*this.precisionFactor)/this.precisionFactor;if(d<this.minQuantity){d=this.minQuantity}if(d==this.minQuantity){this.disableQuantityButton(this.obQuantityDown)}this.obQuantity.value=d;this.obQuantityCounter.innerText=d}else{this.disableQuantityButton(this.obQuantityDown);this.enableQuantityButton(this.obQuantityUp);this.obQuantity.value=this.minQuantity;this.obQuantityCounter.innerText=this.minQuantity}}else{this.disableQuantityButton(this.obQuantityDown);this.enableQuantityButton(this.obQuantityUp);this.obQuantity.value=this.minQuantity;this.obQuantityCounter.innerText=this.minQuantity}this.setPrice()}},quantityInput:function(){var d=0,c;if(this.errorCode===0&&this.showQuantity){if(this.canBuy){d=this.isDblQuantity?parseFloat(this.obQuantity.value):Math.round(this.obQuantity.value);if(!isNaN(d)){if(this.checkQuantity){if(d>this.maxQuantity){d=this.maxQuantity}}this.checkPriceRange(d);c=Math.floor(Math.round(d*this.precisionFactor/this.stepQuantity)/this.precisionFactor)||1;d=c<=1?this.stepQuantity:c*this.stepQuantity;d=Math.round(d*this.precisionFactor)/this.precisionFactor;if(d<this.minQuantity){d=this.minQuantity}this.obQuantityCounter.innerText=d}}}},quantitySet:function(f){var d,j;var g=this.offers[f],c=this.offers[this.offerNum];if(this.errorCode===0){this.canBuy=g.CAN_BUY;this.currentPriceMode=g.ITEM_PRICE_MODE;this.currentPrices=g.ITEM_PRICES;this.currentPriceSelected=g.ITEM_PRICE_SELECTED;this.currentQuantityRanges=g.ITEM_QUANTITY_RANGES;this.currentQuantityRangeSelected=g.ITEM_QUANTITY_RANGE_SELECTED;if(this.canBuy){if(this.blockNodes.quantity){BX.style(this.blockNodes.quantity,"display","")}if(this.obBasketActions){BX.style(this.obBasketActions,"display","")}if(this.obNotAvail){BX.style(this.obNotAvail,"display","none")}if(this.obSubscribe){BX.style(this.obSubscribe,"display","none")}}else{if(this.blockNodes.quantity){BX.style(this.blockNodes.quantity,"display","none")}if(this.obBasketActions){BX.style(this.obBasketActions,"display","none")}if(this.obNotAvail){BX.style(this.obNotAvail,"display","")}if(this.obSubscribe){if(g.CATALOG_SUBSCRIBE==="Y"){BX.style(this.obSubscribe,"display","");this.obSubscribe.setAttribute("data-item",g.ID);BX(this.visual.SUBSCRIBE_ID+"_hidden").click()}else{BX.style(this.obSubscribe,"display","none")}}}this.isDblQuantity=g.QUANTITY_FLOAT;this.checkQuantity=g.CHECK_QUANTITY;if(this.isDblQuantity){this.stepQuantity=Math.round(parseFloat(g.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor;this.maxQuantity=parseFloat(g.MAX_QUANTITY);this.minQuantity=this.currentPriceMode==="Q"?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity}else{this.stepQuantity=parseInt(g.STEP_QUANTITY,10);this.maxQuantity=parseInt(g.MAX_QUANTITY,10);this.minQuantity=this.currentPriceMode==="Q"?parseInt(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity}if(this.showQuantity){var h=c.ITEM_PRICES.length&&c.ITEM_PRICES[c.ITEM_PRICE_SELECTED]&&c.ITEM_PRICES[c.ITEM_PRICE_SELECTED].MIN_QUANTITY!=this.minQuantity;if(this.isDblQuantity){d=Math.round(parseFloat(c.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor!==this.stepQuantity||h||c.MEASURE!==g.MEASURE||this.checkQuantity&&parseFloat(c.MAX_QUANTITY)>this.maxQuantity&&parseFloat(this.obQuantity.value)>this.maxQuantity}else{d=parseInt(c.STEP_QUANTITY,10)!==this.stepQuantity||h||c.MEASURE!==g.MEASURE||this.checkQuantity&&parseInt(c.MAX_QUANTITY,10)>this.maxQuantity&&parseInt(this.obQuantity.value,10)>this.maxQuantity}this.obQuantity.disabled=!this.canBuy;if(d){this.obQuantity.value=this.minQuantity;this.obQuantityCounter.innerText=this.minQuantity}if(this.obQuantity.value==this.minQuantity){this.disableQuantityButton(this.obQuantityDown)}else{this.enableQuantityButton(this.obQuantityDown)}if(this.checkQuantity){if(this.obQuantity.value>=this.maxQuantity){this.disableQuantityButton(this.obQuantityUp)}else{this.enableQuantityButton(this.obQuantityUp)}}else{this.enableQuantityButton(this.obQuantityUp)}if(this.obMeasure){if(g.MEASURE){BX.adjust(this.obMeasure,{html:g.MEASURE})}else{BX.adjust(this.obMeasure,{html:""})}}}if(this.obQuantityLimit.all){if(!this.checkQuantity||this.maxQuantity==0){BX.adjust(this.obQuantityLimit.value,{html:""});BX.adjust(this.obQuantityLimit.all,{style:{display:"none"}})}else{if(this.showMaxQuantity==="M"){j=this.maxQuantity/this.stepQuantity>=this.relativeQuantityFactor?BX.message("RELATIVE_QUANTITY_MANY"):BX.message("RELATIVE_QUANTITY_FEW")}else{j=this.maxQuantity;if(g.MEASURE){j+=" "+g.MEASURE}}BX.adjust(this.obQuantityLimit.value,{html:j});BX.adjust(this.obQuantityLimit.all,{style:{display:""}})}}}},disableQuantityButton:function(c){c.classList.add("catalog-section-item-quantity-btn-disabled")},enableQuantityButton:function(c){c.classList.remove("catalog-section-item-quantity-btn-disabled")},initializeSlider:function(){var c=this.obPictSlider.getAttribute("data-slider-wrap");if(c){this.slider.options.wrap=c==="true"}else{this.slider.options.wrap=this.defaultSliderOptions.wrap}if(!this.isTouchDevice){if(this.obPictSliderIndicator){BX.bindDelegate(this.obPictSliderIndicator,"mouseover",{attribute:"data-entity"},BX.proxy(this.sliderClickHandler,this));if(this.obPictSliderPager){BX.bindDelegate(this.obPictSliderPager,"mouseover",{attribute:"data-entity"},BX.proxy(this.sliderClickHandler,this))}}}},checkTouch:function(c){if(!c||!c.changedTouches){return false}return c.changedTouches[0].identifier===this.touch.identifier},touchStartEvent:function(c){if(c.touches.length!=1){return}this.touch=c.changedTouches[0]},touchEndEvent:function(c){if(!this.checkTouch(c)){return}if(this.touchDirectionEvent(c)==="left"){this.slideNext()}if(this.touchDirectionEvent(c)==="right"){this.slidePrev()}},touchMoveEvent:function(d){if(!this.checkTouch(d)){return}var c=this.touch.pageX-d.changedTouches[0].pageX,f=this.touch.pageY-d.changedTouches[0].pageY;if(Math.abs(f)>=Math.abs(c)+30){document.body.style.overflow=""}else{document.body.style.overflow="hidden"}},touchDirectionEvent:function(d){if(!this.checkTouch(d)){return}var c=this.touch.pageX-d.changedTouches[0].pageX,f=this.touch.pageY-d.changedTouches[0].pageY;if(Math.abs(c)>=Math.abs(f)){if(c>0){return"left"}if(c<0){return"right"}}else{if(f>0){return"up"}if(f<0){return"down"}}},prebuyPopupOpen:function(){var c=document.documentElement.scrollTop;document.documentElement.setAttribute("data-scroll-top",c);BX.addClass(this.prebuyPopup,"opened");BX.removeClass(this.prebuyPopup,"closed");document.documentElement.style.overflow="hidden";document.documentElement.style.height="100vh";document.documentElement.scrollTop=c;this.sendToViewed()},prebuyPopupClose:function(){var c=document.documentElement.getAttribute("data-scroll-top");BX.addClass(this.prebuyPopup,"closed");BX.removeClass(this.prebuyPopup,"opened");document.documentElement.style.overflow="";document.documentElement.style.height="";document.documentElement.scrollTop=c;document.documentElement.removeAttribute("data-scroll-top")},prebuyPopupStartEvent:function(c){if(c.touches.length!=1){return}this.touch=c.changedTouches[0];this.prebuyPopupContainer.style.transition="linear all"},prebuyPopupEndEvent:function(d){if(!this.checkTouch(d)){return}var c=this.touch.pageX-d.changedTouches[0].pageX,f=this.touch.pageY-d.changedTouches[0].pageY;if(f>-150){this.prebuyPopupContainer.style.bottom=""}if(f<-50){this.prebuyPopupContainer.style.bottom="";this.prebuyPopupContainer.style.transition="";setTimeout(BX.delegate(this.prebuyPopupClose,this),10)}},prebuyPopupMoveEvent:function(d){if(!this.checkTouch(d)){return}var c=this.touch.pageX-d.changedTouches[0].pageX,f=this.touch.pageY-d.changedTouches[0].pageY;if(this.touchDirectionEvent(d)=="down"){if(f<0){this.prebuyPopupContainer.style.bottom=f+"px"}}},sliderClickHandler:function(d){var c=BX.getEventTarget(d),f=c.getAttribute("data-go-to");if(f){this.slideTo(f)}BX.PreventDefault(d)},slideNext:function(){if(this.slider.sliding){return}return this.slide("next")},slidePrev:function(){if(this.slider.sliding){return}return this.slide("prev")},slideTo:function(d){this.slider.active=BX.findChild(this.obPictSlider,{className:"active"},true,false);var c=this.getItemIndex(this.slider.active);if(d>this.slider.items.length-1||d<0){return}if(this.slider.sliding){return false}if(c==d){this.cycleSlider();return}return this.slide(d>c?"next":"prev",this.eq(this.slider.items,d))},slide:function(f,d){document.body.style.overflow="";var j=BX.findChild(this.obPictSlider,{className:"catalog-section-item-slider-image active"},true,false),g=this.slider.interval,c=f==="next"?"left":"right";d=d||this.getItemForDirection(f,j);if(BX.hasClass(d,"active")){return this.slider.sliding=false}this.slider.sliding=true;g&&this.stopSlider();if(this.obPictSliderIndicator){BX.removeClass(this.obPictSliderIndicator.querySelector(".active"),"active");var h=this.obPictSliderIndicator.querySelectorAll("[data-entity='slider-control']")[this.getItemIndex(d)];h&&BX.addClass(h,"active")}if(BX.hasClass(this.obPictSlider,"catalog-section-item-slider-images-container")&&!BX.browser.IsIE()){var k=this;BX.addClass(d,f);d.offsetWidth;BX.addClass(j,c);BX.addClass(d,c);if(this.isTouchDevice){BX.addClass(this.obPictSlider,"catalog-section-item-slider-animation");setTimeout((function(){BX.addClass(d,"active");BX.removeClass(j,"active");BX.removeClass(j,c);BX.removeClass(d,f);BX.removeClass(d,c);k.slider.sliding=false}),250)}else{BX.addClass(d,"active");BX.removeClass(j,"active");BX.removeClass(j,c);BX.removeClass(d,f);BX.removeClass(d,c);k.slider.sliding=false}}else{BX.addClass(d,"active");this.slider.sliding=false}g&&this.cycleSlider()},stopSlider:function(d){d||(this.slider.paused=true);this.slider.interval&&clearInterval(this.slider.interval);if(this.slider.progress){this.slider.progress.stop();var c=parseInt(this.obPictSliderProgressBar.style.width);this.slider.progress.options.duration=this.slider.options.interval*c/200;this.slider.progress.options.start={width:c*10};this.slider.progress.options.finish={width:0};this.slider.progress.options.complete=null;this.slider.progress.animate()}},cycleSlider:function(d){d||(this.slider.paused=false);this.slider.interval&&clearInterval(this.slider.interval);if(this.slider.options.interval&&!this.slider.paused){if(this.slider.progress){this.slider.progress.stop();var c=parseInt(this.obPictSliderProgressBar.style.width);this.slider.progress.options.duration=this.slider.options.interval*(100-c)/100;this.slider.progress.options.start={width:c*10};this.slider.progress.options.finish={width:1000};this.slider.progress.options.complete=BX.delegate((function(){this.slider.interval=true;this.slideNext()}),this);this.slider.progress.animate()}else{this.slider.interval=setInterval(BX.proxy(this.slideNext,this),this.slider.options.interval)}}},getItemForDirection:function(f,d){var j=this.getItemIndex(d),g=f==="prev"&&j===0||f==="next"&&j==this.slider.items.length-1;if(g&&!this.slider.options.wrap){return d}var c=f==="prev"?-1:1,h=(j+c)%this.slider.items.length;return this.eq(this.slider.items,h)},getItemIndex:function(c){this.slider.items=BX.findChildren(c.parentNode,{className:"catalog-section-item-slider-image"},true);return this.slider.items.indexOf(c||this.slider.active)},eq:function(d,c){var g=d.length,f=+c+(c<0?g:0);return f>=0&&f<g?d[f]:{}},selectOfferProp:function(){var f=0,d="",j="",g=[],c=null,h=BX.proxy_context;if(h&&h.hasAttribute("data-treevalue")){if(BX.hasClass(h,"selected")){return}j=h.getAttribute("data-treevalue");g=j.split("_");if(this.searchOfferPropIndex(g[0],g[1])){c=BX.findChildren(h.parentNode,{tagName:"li"},false);if(c&&0<c.length){for(f=0;f<c.length;f++){d=c[f].getAttribute("data-onevalue");if(d===g[1]){BX.addClass(c[f],"selected")}else{BX.removeClass(c[f],"selected")}}}if(this.isFacebookConversionCustomizeProductEventEnabled&&BX.Type.isArrayFilled(this.offers)&&BX.Type.isObject(this.offers[this.offerNum])){BX.ajax.runAction("sale.facebookconversion.customizeProduct",{data:{offerId:this.offers[this.offerNum]["ID"]}})}}}},searchOfferPropIndex:function(v,j){var m="",w=false,p,c,d=[],f=[],k=-1,q={},g=[];for(p=0;p<this.treeProps.length;p++){if(this.treeProps[p].ID===v){k=p;break}}if(-1<k){for(p=0;p<k;p++){m="PROP_"+this.treeProps[p].ID;q[m]=this.selectedValues[m]}m="PROP_"+this.treeProps[k].ID;w=this.getRowValues(q,m);if(!w){return false}if(!BX.util.in_array(j,w)){return false}q[m]=j;for(p=k+1;p<this.treeProps.length;p++){m="PROP_"+this.treeProps[p].ID;w=this.getRowValues(q,m);if(!w){return false}f=[];if(this.showAbsent){d=[];g=[];g=BX.clone(q,true);for(c=0;c<w.length;c++){g[m]=w[c];f[f.length]=w[c];if(this.getCanBuy(g)){d[d.length]=w[c]}}}else{d=w}if(this.selectedValues[m]&&BX.util.in_array(this.selectedValues[m],d)){q[m]=this.selectedValues[m]}else{if(this.showAbsent){q[m]=d.length>0?d[0]:f[0]}else{q[m]=d[0]}}this.updateRow(p,q[m],w,d)}this.selectedValues=q;this.changeInfo({addToViewed:true})}return true},updateRow:function(p,g,k,q){var l=0,c="",d=false,f=null;var j=this.obTree.querySelectorAll('[data-entity="sku-line-block"]'),m;if(p>-1&&p<j.length){m=j[p].querySelector("ul");f=BX.findChildren(m,{tagName:"li"},false);if(f&&0<f.length){for(l=0;l<f.length;l++){c=f[l].getAttribute("data-onevalue");d=c===g;if(d){BX.addClass(f[l],"selected")}else{BX.removeClass(f[l],"selected")}if(BX.util.in_array(c,q)){BX.removeClass(f[l],"notallowed")}else{BX.addClass(f[l],"notallowed")}f[l].style.display=BX.util.in_array(c,k)?"":"none";if(d){j[p].style.display=c==0&&q.length==1?"none":""}}}}},getRowValues:function(f,d){var j=0,g,c=[],h=false,k=true;if(0===f.length){for(j=0;j<this.offers.length;j++){if(!BX.util.in_array(this.offers[j].TREE[d],c)){c[c.length]=this.offers[j].TREE[d]}}h=true}else{for(j=0;j<this.offers.length;j++){k=true;for(g in f){if(f[g]!==this.offers[j].TREE[g]){k=false;break}}if(k){if(!BX.util.in_array(this.offers[j].TREE[d],c)){c[c.length]=this.offers[j].TREE[d]}h=true}}}return h?c:false},getCanBuy:function(f){var d,h,g=false,c=true;for(d=0;d<this.offers.length;d++){c=true;for(h in f){if(f[h]!==this.offers[d].TREE[h]){c=false;break}}if(c){if(this.offers[d].CAN_BUY){g=true;break}}}return g},setCurrent:function(){var f,d=0,j=[],g="",c=false,h={},k=[],l=this.offers[this.offerNum].TREE;for(f=0;f<this.treeProps.length;f++){g="PROP_"+this.treeProps[f].ID;c=this.getRowValues(h,g);if(!c){break}if(BX.util.in_array(l[g],c)){h[g]=l[g]}else{h[g]=c[0];this.offerNum=0}if(this.showAbsent){j=[];k=[];k=BX.clone(h,true);for(d=0;d<c.length;d++){k[g]=c[d];if(this.getCanBuy(k)){j[j.length]=c[d]}}}else{j=c}this.updateRow(f,h[g],c,j)}this.selectedValues=h;this.changeInfo()},changeInfo:function(f){var d,j,g=-1,c=true,h=0;for(d=0;d<this.offers.length;d++){c=true;for(j in this.selectedValues){if(this.selectedValues[j]!==this.offers[d].TREE[j]){c=false;break}}if(c){g=d;break}}if(g>-1){if(parseInt(this.offers[g].MORE_PHOTO_COUNT)>0){if(typeof this.offers[g].MORE_PHOTO_SELECTED!=="undefined"){h=parseInt(this.offers[g].MORE_PHOTO_SELECTED)}this.setPictureSlider(this.offers[g].RESIZED_SLIDER,h)}else{if(this.product.morePhoto){this.setPictureSlider(this.product.sliderPhoto,h)}else{this.hidePictureSlider()}}if(this.showSkuProps&&this.obSkuProps){if(this.offers[g].DISPLAY_PROPERTIES.length){BX.adjust(this.obSkuProps,{style:{display:""},html:this.offers[g].DISPLAY_PROPERTIES})}else{BX.adjust(this.obSkuProps,{style:{display:"none"},html:""})}}if(this.useOfferName){if(this.obName){this.obName.innerHTML=BX.Text.encode(this.offers[g].NAME)}if(this.prebuyPopupName){this.prebuyPopupName.innerHTML=BX.Text.encode(this.offers[g].NAME)}}this.quantitySet(g);this.setPrice();this.setCompared(this.offers[g].COMPARED);this.offerNum=g;if(BX.type.isPlainObject(f)&&f.addToViewed===true){this.viewedParams.skuId=parseInt(this.offers[this.offerNum].ID);this.sendToViewed()}}},setPictureSlider:function(v,j){var m=v.X;var w=v.X2;if(!BX.type.isElementNode(this.obPictSlider)){return}var p=BX.type.isElementNode(this.obPictSliderIndicator);BX.cleanNode(this.obPictSlider);if(p){BX.cleanNode(this.obPictSliderIndicator)}var c,d=0,f=m.length>1,k;for(c in m){if(!m.hasOwnProperty(c)){continue}var q=BX.create("IMG",{attrs:{src:m[c].SRC,srcset:m[c].SRC+" 1x, "+w[c].SRC+" 2x"}});var g=BX.create("div",{props:{className:"catalog-section-item-slider-image-overlay"}});g.setAttribute("style",'background-image: url("'+m[c].SRC+'");background-image: -webkit-image-set(url("'+m[c].SRC+'") 1x, url("'+w[c].SRC+'") 2x);background-image: image-set(url("'+m[c].SRC+'") 1x, url("'+w[c].SRC+'") 2x);');k=d===j;this.obPictSlider.appendChild(BX.create("A",{attrs:{"data-entity":"image","data-id":m[c].ID},props:{href:this.product.DETAIL_PAGE_URL,className:"catalog-section-item-slider-image"+(k?" active":"")},children:[q,g]}));if(p&&f){this.obPictSliderIndicator.appendChild(BX.create("DIV",{attrs:{"data-go-to":c,"data-value":m[c].ID,"data-entity":"slider-control"},props:{className:"catalog-section-item-slider-controls-image"+(k?" active":"")},children:[document.createTextNode(" "),BX.create("DIV",{attrs:{"data-go-to":c,"data-value":m[c].ID,"data-entity":"slider-control-dot"},props:{className:"catalog-section-item-slider-controls-dot"}})]}))}if(k){if(BX.type.isElementNode(this.prebuyPopupPict)){this.prebuyPopupPict.src=m[c].SRC}}d++}if(this.sliderControlLeft){this.sliderControlLeft.style.display=f?"":"none"}if(this.sliderControlRight){this.sliderControlRight.style.display=f?"":"none"}if(p){this.obPictSliderIndicator.style.display=f?"":"none"}},hidePictureSlider:function(){if(!BX.type.isElementNode(this.obPictSlider)){return}if(BX.type.isElementNode(this.obPictSliderIndicator)){this.obPictSliderIndicator.style.display="none"}},checkPriceRange:function(f){if(typeof f==="undefined"||this.currentPriceMode!="Q"){return}var d,h=false;for(var g in this.currentQuantityRanges){if(this.currentQuantityRanges.hasOwnProperty(g)){d=this.currentQuantityRanges[g];if(parseInt(f)>=parseInt(d.SORT_FROM)&&(d.SORT_TO=="INF"||parseInt(f)<=parseInt(d.SORT_TO))){h=true;this.currentQuantityRangeSelected=d.HASH;break}}}if(!h&&(d=this.getMinPriceRange())){this.currentQuantityRangeSelected=d.HASH}for(var c in this.currentPrices){if(this.currentPrices.hasOwnProperty(c)){if(this.currentPrices[c].QUANTITY_HASH==this.currentQuantityRangeSelected){this.currentPriceSelected=c;break}}}},getMinPriceRange:function(){var d;for(var c in this.currentQuantityRanges){if(this.currentQuantityRanges.hasOwnProperty(c)){if(!d||parseInt(this.currentQuantityRanges[c].SORT_FROM)<parseInt(d.SORT_FROM)){d=this.currentQuantityRanges[c]}}}return d},checkQuantityControls:function(){if(!this.obQuantity){return}var d=this.checkQuantity&&parseFloat(this.obQuantity.value)+this.stepQuantity>this.maxQuantity,c=parseFloat(this.obQuantity.value)-this.stepQuantity<this.minQuantity;if(d){this.disableQuantityButton(this.obQuantityUp)}else{this.enableQuantityButton(this.obQuantityUp)}if(c){this.disableQuantityButton(this.obQuantityDown)}else{this.enableQuantityButton(this.obQuantityDown)}if(this.obQuantity.value==this.minQuantity){this.disableQuantityButton(this.obQuantityDown)}else{this.enableQuantityButton(this.obQuantityDown)}},setPrice:function(){var f,d="",h="",g="",c;if(this.obQuantity){this.checkPriceRange(this.obQuantity.value)}this.checkQuantityControls();f=this.currentPrices[this.currentPriceSelected];if(this.obPrice){if(f){d=BX.Currency.currencyFormat(f.RATIO_PRICE,f.CURRENCY,true)}BX.adjust(this.obPrice,{html:d});if(this.priceTwin){BX.adjust(this.priceTwin,{html:d})}if(this.showOldPrice){c=f&&f.RATIO_PRICE!==f.RATIO_BASE_PRICE;if(c){h=BX.Currency.currencyFormat(f.RATIO_BASE_PRICE,f.CURRENCY,true);g=BX.Currency.currencyFormat(f.RATIO_DISCOUNT,f.CURRENCY,true);if(this.blockOldPrice){if(this.obPriceOld){BX.adjust(this.obPriceOld,{html:h})}if(this.priceDiscount){BX.adjust(this.priceDiscount,{html:g})}BX.adjust(this.blockOldPrice,{style:{display:""}})}if(this.blockOldPriceTwin){if(this.priceOldTwin){BX.adjust(this.priceOldTwin,{html:h})}if(this.priceDiscountTwin){BX.adjust(this.priceDiscountTwin,{html:g})}BX.adjust(this.blockOldPriceTwin,{style:{display:""}})}}else{if(this.blockOldPrice){if(this.obPriceOld){BX.adjust(this.obPriceOld,{html:""})}if(this.priceDiscount){BX.adjust(this.priceDiscount,{html:""})}BX.adjust(this.blockOldPrice,{style:{display:"none"}})}if(this.blockOldPriceTwin){if(this.priceOldTwin){BX.adjust(this.priceOldTwin,{html:""})}if(this.priceDiscountTwin){BX.adjust(this.priceDiscountTwin,{html:""})}BX.adjust(this.blockOldPriceTwin,{style:{display:"none"}})}}}if(this.showOldPrice&&this.obPriceOld){if(f&&f.RATIO_PRICE!==f.RATIO_BASE_PRICE){BX.adjust(this.obPriceOld,{style:{display:""},html:BX.Currency.currencyFormat(f.RATIO_BASE_PRICE,f.CURRENCY,true)})}else{BX.adjust(this.obPriceOld,{style:{display:"none"},html:""})}}if(this.obPriceTotal){this.obMeasureContainer=BX(this.visual.QUANTITY_MEASURE_CONTAINER);if(f&&this.obQuantity&&this.obQuantity.value!=this.stepQuantity){if(this.obMeasureContainer){BX.adjust(this.obMeasureContainer,{style:{"text-align":"right",left:"auto"}})}BX.adjust(this.obPriceTotal,{html:BX.message("PRICE_TOTAL_PREFIX")+" <span>"+BX.Currency.currencyFormat(f.PRICE*this.obQuantity.value,f.CURRENCY,true)+"</span>",style:{display:""}})}else{BX.adjust(this.obPriceTotal,{html:"",style:{display:"none"}});if(this.obMeasureContainer){BX.adjust(this.obMeasureContainer,{style:{"text-align":"",left:0}})}}}}},compare:function(f){var d=this.obCompare.querySelector('[data-entity="compare-checkbox"]'),j=BX.getEventTarget(f),g=true;if(d){g=j===d?d.checked:!d.checked}var c=g?this.compareData.compareUrl:this.compareData.compareDeleteUrl,h;if(c){if(j!==d){BX.PreventDefault(f);this.setCompared(g)}switch(this.productType){case 0:case 1:case 2:h=c.replace("#ID#",this.product.id.toString());break;case 3:h=c.replace("#ID#",this.offers[this.offerNum].ID);break}BX.ajax({method:"POST",dataType:g?"json":"html",url:h+(h.indexOf("?")!==-1?"&":"?")+"ajax_action=Y",onsuccess:g?BX.proxy(this.compareResult,this):BX.proxy(this.compareDeleteResult,this)})}},compareResult:function(c){var f,d;if(this.obPopupWin){this.obPopupWin.close()}if(!BX.type.isPlainObject(c)){return}this.initPopupWindow();if(this.offers.length>0){this.offers[this.offerNum].COMPARED=c.STATUS==="OK"}if(c.STATUS==="OK"){BX.onCustomEvent("OnCompareChange");f='<div style="width: 100%; margin: 0; text-align: center;"><p>'+BX.message("COMPARE_MESSAGE_OK")+"</p></div>";if(this.showClosePopup){d=[new a({text:BX.message("BTN_MESSAGE_COMPARE_REDIRECT"),events:{click:BX.delegate(this.compareRedirect,this)},style:{marginRight:"10px"}}),new a({text:BX.message("BTN_MESSAGE_CLOSE_POPUP"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}else{d=[new a({text:BX.message("BTN_MESSAGE_COMPARE_REDIRECT"),events:{click:BX.delegate(this.compareRedirect,this)}})]}}else{f='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(c.MESSAGE?c.MESSAGE:BX.message("COMPARE_UNKNOWN_ERROR"))+"</p></div>";d=[new a({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}this.obPopupWin.setTitleBar(BX.message("COMPARE_TITLE"));this.obPopupWin.setContent(f);this.obPopupWin.setButtons(d);this.obPopupWin.show()},compareDeleteResult:function(){BX.onCustomEvent("OnCompareChange");if(this.offers&&this.offers.length){this.offers[this.offerNum].COMPARED=false}},setCompared:function(d){if(!this.obCompare){return}var c=this.obCompare.querySelector('[data-entity="compare-checkbox"]');if(c){c.checked=d}},setCompareInfo:function(d){if(!BX.type.isArray(d)){return}for(var c in this.offers){if(this.offers.hasOwnProperty(c)){this.offers[c].COMPARED=BX.util.in_array(this.offers[c].ID,d)}}},compareRedirect:function(){if(this.compareData.comparePath){location.href=this.compareData.comparePath}else{this.obPopupWin.close()}},checkDeletedCompare:function(d){switch(this.productType){case 0:case 1:case 2:if(this.product.id==d){this.setCompared(false)}break;case 3:var c=this.offers.length;while(c--){if(this.offers[c].ID==d){this.offers[c].COMPARED=false;if(this.offerNum==c){this.setCompared(false)}break}}}},initBasketUrl:function(){this.basketUrl=this.basketMode==="ADD"?this.basketData.add_url:this.basketData.buy_url;switch(this.productType){case 1:case 2:this.basketUrl=this.basketUrl.replace("#ID#",this.product.id.toString());break;case 3:this.basketUrl=this.basketUrl.replace("#ID#",this.offers[this.offerNum].ID);break}this.basketParams={ajax_basket:"Y"};if(this.showQuantity){this.basketParams[this.basketData.quantity]=this.obQuantity.value}if(this.basketData.sku_props){this.basketParams[this.basketData.sku_props_var]=this.basketData.sku_props}},fillBasketProps:function(){if(!this.visual.BASKET_PROP_DIV){return}var d=0,c=null,g=false,f=null;if(this.basketData.useProps&&!this.basketData.emptyProps){if(this.obPopupWin&&this.obPopupWin.contentContainer){f=this.obPopupWin.contentContainer}}else{f=BX(this.visual.BASKET_PROP_DIV)}if(f){c=f.getElementsByTagName("select");if(c&&c.length){for(d=0;d<c.length;d++){if(!c[d].disabled){switch(c[d].type.toLowerCase()){case"select-one":this.basketParams[c[d].name]=c[d].value;g=true;break;default:break}}}}c=f.getElementsByTagName("input");if(c&&c.length){for(d=0;d<c.length;d++){if(!c[d].disabled){switch(c[d].type.toLowerCase()){case"hidden":this.basketParams[c[d].name]=c[d].value;g=true;break;case"radio":if(c[d].checked){this.basketParams[c[d].name]=c[d].value;g=true}break;default:break}}}}}if(!g){this.basketParams[this.basketData.props]=[];this.basketParams[this.basketData.props][0]=0}},add2Basket:function(){this.basketMode="ADD";this.basket()},buyBasket:function(){this.basketMode="BUY";this.basket()},sendToBasket:function(){if(!this.canBuy){return}if(this.product&&this.product.id&&this.bigData){this.rememberProductRecommendation()}this.initBasketUrl();this.fillBasketProps();BX.ajax({method:"POST",dataType:"json",url:this.basketUrl,data:this.basketParams,onsuccess:BX.proxy(this.basketResult,this)})},sendToViewed:function(){if(this.viewedParams.skuId>0&&this.viewedParams.siteId){BX.ajax.runComponentAction("bitrix:catalog.item","addViewedProduct",{mode:"ajax",data:this.viewedParams})}},basket:function(){var c="";if(!this.canBuy){return}switch(this.productType){case 1:case 2:if(this.basketData.useProps&&!this.basketData.emptyProps){this.initPopupWindow();this.obPopupWin.setTitleBar(BX.message("TITLE_BASKET_PROPS"));if(BX(this.visual.BASKET_PROP_DIV)){c=BX(this.visual.BASKET_PROP_DIV).innerHTML}this.obPopupWin.setContent(c);this.obPopupWin.setButtons([new a({text:BX.message("BTN_MESSAGE_SEND_PROPS"),events:{click:BX.delegate(this.sendToBasket,this)}})]);this.obPopupWin.show()}else{this.sendToBasket()}break;case 3:this.sendToBasket();break}},basketResult:function(d){var h="",f="",c,g=[];if(this.obPopupWin){this.obPopupWin.close()}if(!BX.type.isPlainObject(d)){return}c=d.STATUS==="OK";if(c){this.setAnalyticsDataLayer("addToCart")}if(c&&this.basketMode==="BUY"){this.basketRedirect()}else{this.initPopupWindow();if(c){BX.onCustomEvent("OnBasketChange");if(BX.findParent(this.obProduct,{className:"bx_sale_gift_main_products"},10)){BX.onCustomEvent("onAddToBasketMainProduct",[this])}switch(this.productType){case 1:case 2:f=this.product.pict.SRC;break;case 3:f=this.offers[this.offerNum].PREVIEW_PICTURE?this.offers[this.offerNum].PREVIEW_PICTURE.SRC:this.defaultPict.pict.SRC;break}h='<div style="width: 100%; margin: 0; text-align: center;"><img src="'+f+'" height="130" style="max-height:130px"><p>'+this.product.name+"</p></div>";if(this.showClosePopup){g=[new a({text:BX.message("BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(this.basketRedirect,this)},style:{marginRight:"10px"}}),new a({text:BX.message("BTN_MESSAGE_CLOSE_POPUP"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}else{g=[new a({text:BX.message("BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(this.basketRedirect,this)}})]}}else{h='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(d.MESSAGE?d.MESSAGE:BX.message("BASKET_UNKNOWN_ERROR"))+"</p></div>";g=[new a({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}}},basketRedirect:function(){location.href=this.basketData.basketUrl?this.basketData.basketUrl:BX.message("BASKET_URL")},initPopupWindow:function(){if(this.obPopupWin){return}this.obPopupWin=BX.PopupWindowManager.create("CatalogSectionBasket_"+this.visual.ID,null,{autoHide:true,offsetLeft:0,offsetTop:0,overlay:true,closeByEsc:true,titleBar:true,closeIcon:true,contentColor:"white",className:this.templateTheme?"bx-"+this.templateTheme:""})}}})(window);(function(){if(!!window.JCCatalogSectionListStoreComponent){return}window.JCCatalogSectionListStoreComponent=function(a){this.state={offset:0,itemNumber:0};this.settings={offset:0,maxCount:0};this.visual={id:""};this.offsetMode=a.offsetMode||"N";this.visual.id=a.visual.id;if(this.offsetMode==="F"){this.settings.offset=a.settings.offset}this.settings.maxCount=a.settings.maxCount;this.container=null;BX.ready(BX.proxy(this.init,this))};window.JCCatalogSectionListStoreComponent.prototype={init:function(){if(BX.type.isNotEmptyString(this.visual.id)){this.container=BX(this.visual.id);var a=new BX.UI.Ears({container:this.container.children[0],smallSize:true,noScrollbar:true,className:"catalog-sections-list-ears"});a.init()}if(this.offsetMode==="F"){this.setCurrentOffset(this.settings.offset)}},setCurrentOffset:function(a){this.calculateOffset(a);this.applyOffset()},calculateOffset:function(a){this.state.offset=a;this.state.itemNumber=Math.floor(this.state.offset/5)},applyOffset:function(){if(this.container!==null){var a=this.container.querySelector('[data-items-container="Y"]');if(BX.type.isElementNode(a)){var b=a.querySelector('[data-item-number="'+this.state.itemNumber+'"]');if(BX.type.isElementNode(b)){BX.adjust(b,{attrs:{"data-role":"ui-ears-active"}})}}}}}})();