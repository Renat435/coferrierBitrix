(function(){if(!!window.JCCatalogSectionComponent){return}window.JCCatalogSectionComponent=function(b){this.formPosting=false;this.siteId=b.siteId||"";this.ajaxId=b.ajaxId||"";this.template=b.template||"";this.componentPath=b.componentPath||"";this.parameters=b.parameters||"";if(b.navParams){this.navParams={NavNum:b.navParams.NavNum||1,NavPageNomer:parseInt(b.navParams.NavPageNomer)||1,NavPageCount:parseInt(b.navParams.NavPageCount)||1}}this.bigData=b.bigData||{enabled:false};this.container=document.querySelector('[data-entity="'+b.container+'"]');this.showMoreButton=null;this.showMoreButtonMessage=null;if(this.bigData.enabled&&BX.util.object_keys(this.bigData.rows).length>0){BX.cookie_prefix=this.bigData.js.cookiePrefix||"";BX.cookie_domain=this.bigData.js.cookieDomain||"";BX.current_server_time=this.bigData.js.serverTime;BX.ready(BX.delegate(this.bigDataLoad,this))}if(b.initiallyShowHeader){BX.ready(BX.delegate(this.showHeader,this))}if(b.deferredLoad){BX.ready(BX.delegate(this.deferredLoad,this))}if(b.lazyLoad){this.showMoreButton=document.querySelector('[data-use="show-more-'+this.navParams.NavNum+'"]');this.showMoreButtonMessage=this.showMoreButton.innerHTML;BX.bind(this.showMoreButton,"click",BX.proxy(this.showMore,this))}if(b.loadOnScroll){BX.bind(window,"scroll",BX.proxy(this.loadOnScroll,this))}};window.JCCatalogSectionComponent.prototype={checkButton:function(){if(this.showMoreButton){if(this.navParams.NavPageNomer==this.navParams.NavPageCount){BX.remove(this.showMoreButton)}else{this.container.appendChild(this.showMoreButton)}}},enableButton:function(){if(this.showMoreButton){BX.removeClass(this.showMoreButton,"disabled");this.showMoreButton.innerHTML=this.showMoreButtonMessage}},disableButton:function(){if(this.showMoreButton){BX.addClass(this.showMoreButton,"disabled");this.showMoreButton.innerHTML=BX.message("BTN_MESSAGE_LAZY_LOAD_WAITER")}},loadOnScroll:function(){var c=BX.GetWindowScrollPos().scrollTop,d=BX.pos(this.container).bottom;if(c+window.innerHeight>d){this.showMore()}},showMore:function(){if(this.navParams.NavPageNomer<this.navParams.NavPageCount){var b={};b.action="showMore";b["PAGEN_"+this.navParams.NavNum]=this.navParams.NavPageNomer+1;if(!this.formPosting){this.formPosting=true;this.disableButton();this.sendRequest(b)}}},bigDataLoad:function(){var e="https://analytics.bitrix.info/crecoms/v1_0/recoms.php",d=BX.ajax.prepareData(this.bigData.params);if(d){e+=(e.indexOf("?")!==-1?"&":"?")+d}var f=BX.delegate(function(a){this.sendRequest({action:"deferredLoad",bigData:"Y",items:a&&a.items||[],rid:a&&a.id,count:this.bigData.count,rowsRange:this.bigData.rowsRange,shownIds:this.bigData.shownIds})},this);BX.ajax({method:"GET",dataType:"json",url:e,timeout:3,onsuccess:f,onfailure:f})},deferredLoad:function(){this.sendRequest({action:"deferredLoad"})},sendRequest:function(c){var d={siteId:this.siteId,template:this.template,parameters:this.parameters};if(this.ajaxId){d.AJAX_ID=this.ajaxId}BX.ajax({url:this.componentPath+"/ajax.php"+(document.location.href.indexOf("clear_cache=Y")!==-1?"?clear_cache=Y":""),method:"POST",dataType:"json",timeout:60,data:BX.merge(d,c),onsuccess:BX.delegate(function(a){if(!a||!a.JS){return}BX.ajax.processScripts(BX.processHTML(a.JS).SCRIPT,false,BX.delegate(function(){this.showAction(a,c)},this))},this)})},showAction:function(d,c){if(!c){return}switch(c.action){case"showMore":this.processShowMoreAction(d);break;case"deferredLoad":this.processDeferredLoadAction(d,c.bigData==="Y");break}},processShowMoreAction:function(b){this.formPosting=false;this.enableButton();if(b){this.navParams.NavPageNomer++;this.processItems(b.items);this.processPagination(b.pagination);this.processEpilogue(b.epilogue);this.checkButton()}},processDeferredLoadAction:function(d,f){if(!d){return}var e=f?this.bigData.rows:{};this.processItems(d.items,BX.util.array_keys(e))},processItems:function(k,i){if(!k){return}var j=BX.processHTML(k,false),m=BX.create("DIV");var n,h,l;m.innerHTML=j.HTML;n=m.querySelectorAll('[data-entity="items-row"]');if(n.length){this.showHeader(true);for(h in n){if(n.hasOwnProperty(h)){l=i?this.container.querySelectorAll('[data-entity="items-row"]'):false;n[h].style.opacity=0;if(l&&BX.type.isDomNode(l[i[h]])){l[i[h]].parentNode.insertBefore(n[h],l[i[h]])}else{this.container.appendChild(n[h])}}}new BX.easing({duration:2000,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(a){for(var b in n){if(n.hasOwnProperty(b)){n[b].style.opacity=a.opacity/100}}},complete:function(){for(var a in n){if(n.hasOwnProperty(a)){n[a].removeAttribute("style")}}}}).animate()}BX.ajax.processScripts(j.SCRIPT)},processPagination:function(f){if(!f){return}var e=document.querySelectorAll('[data-pagination-num="'+this.navParams.NavNum+'"]');for(var d in e){if(e.hasOwnProperty(d)){e[d].innerHTML=f}}},processEpilogue:function(d){if(!d){return}var c=BX.processHTML(d,false);BX.ajax.processScripts(c.SCRIPT)},showHeader:function(d){var e=BX.findParent(this.container,{attr:{"data-entity":"parent-container"}}),f;if(e&&BX.type.isDomNode(e)){f=e.querySelector('[data-entity="header"]');if(f&&f.getAttribute("data-showed")!="true"){f.style.display="";if(d){new BX.easing({duration:2000,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(a){f.style.opacity=a.opacity/100},complete:function(){f.removeAttribute("style");f.setAttribute("data-showed","true")}}).animate()}else{f.style.opacity=100}}}}}})();(function(c){if(c.JCCatalogItem){return}var d=function(a){d.superclass.constructor.apply(this,arguments);this.buttonNode=BX.create("span",{props:{className:"btn btn-default btn-buy btn-sm",id:this.id},style:typeof a.style==="object"?a.style:{},text:a.text,events:this.contextEvents});if(BX.browser.IsIE()){this.buttonNode.setAttribute("hideFocus","hidefocus")}};BX.extend(d,BX.PopupWindowButton);c.JCCatalogItem=function(a){this.productType=0;this.showQuantity=true;this.showAbsent=true;this.secondPict=false;this.showOldPrice=false;this.showMaxQuantity="N";this.relativeQuantityFactor=5;this.showPercent=false;this.showSkuProps=false;this.basketAction="ADD";this.showClosePopup=false;this.useCompare=false;this.showSubscription=false;this.visual={ID:"",PICT_ID:"",SECOND_PICT_ID:"",PICT_SLIDER_ID:"",QUANTITY_ID:"",QUANTITY_UP_ID:"",QUANTITY_DOWN_ID:"",PRICE_ID:"",PRICE_OLD_ID:"",DSC_PERC:"",SECOND_DSC_PERC:"",DISPLAY_PROP_DIV:"",BASKET_PROP_DIV:"",SUBSCRIBE_ID:""};this.product={checkQuantity:false,maxQuantity:0,stepQuantity:1,isDblQuantity:false,canBuy:true,name:"",pict:{},id:0,addUrl:"",buyUrl:""};this.basketMode="";this.basketData={useProps:false,emptyProps:false,quantity:"quantity",props:"prop",basketUrl:"",sku_props:"",sku_props_var:"basket_props",add_url:"",buy_url:""};this.compareData={compareUrl:"",compareDeleteUrl:"",comparePath:""};this.defaultPict={pict:null,secondPict:null};this.defaultSliderOptions={interval:3000,wrap:true};this.slider={options:{},items:[],active:null,sliding:null,paused:null,interval:null,progress:null};this.touch=null;this.quantityDelay=null;this.quantityTimer=null;this.checkQuantity=false;this.maxQuantity=0;this.minQuantity=0;this.stepQuantity=1;this.isDblQuantity=false;this.canBuy=true;this.precision=6;this.precisionFactor=Math.pow(10,this.precision);this.bigData=false;this.fullDisplayMode=false;this.viewMode="";this.templateTheme="";this.currentPriceMode="";this.currentPrices=[];this.currentPriceSelected=0;this.currentQuantityRanges=[];this.currentQuantityRangeSelected=0;this.offers=[];this.offerNum=0;this.treeProps=[];this.selectedValues={};this.obProduct=null;this.blockNodes={};this.obQuantity=null;this.obQuantityUp=null;this.obQuantityDown=null;this.obQuantityLimit={};this.obPict=null;this.obSecondPict=null;this.obPictSlider=null;this.obPictSliderIndicator=null;this.obPrice=null;this.obTree=null;this.obBuyBtn=null;this.obBasketActions=null;this.obNotAvail=null;this.obSubscribe=null;this.obDscPerc=null;this.obSecondDscPerc=null;this.obSkuProps=null;this.obMeasure=null;this.obCompare=null;this.obPopupWin=null;this.basketUrl="";this.basketParams={};this.isTouchDevice=BX.hasClass(document.documentElement,"bx-touch");this.hoverTimer=null;this.hoverStateChangeForbidden=false;this.mouseX=null;this.mouseY=null;this.useEnhancedEcommerce=false;this.dataLayerName="dataLayer";this.brandProperty=false;this.errorCode=0;if(typeof a==="object"){if(a.PRODUCT_TYPE){this.productType=parseInt(a.PRODUCT_TYPE,10)}this.showQuantity=a.SHOW_QUANTITY;this.showAbsent=a.SHOW_ABSENT;this.secondPict=a.SECOND_PICT;this.showOldPrice=a.SHOW_OLD_PRICE;this.showMaxQuantity=a.SHOW_MAX_QUANTITY;this.relativeQuantityFactor=parseInt(a.RELATIVE_QUANTITY_FACTOR);this.showPercent=a.SHOW_DISCOUNT_PERCENT;this.showSkuProps=a.SHOW_SKU_PROPS;this.showSubscription=a.USE_SUBSCRIBE;if(a.ADD_TO_BASKET_ACTION){this.basketAction=a.ADD_TO_BASKET_ACTION}this.showClosePopup=a.SHOW_CLOSE_POPUP;this.useCompare=a.DISPLAY_COMPARE;this.fullDisplayMode=a.PRODUCT_DISPLAY_MODE==="Y";this.bigData=a.BIG_DATA;this.viewMode=a.VIEW_MODE||"";this.templateTheme=a.TEMPLATE_THEME||"";this.useEnhancedEcommerce=a.USE_ENHANCED_ECOMMERCE==="Y";this.dataLayerName=a.DATA_LAYER_NAME;this.brandProperty=a.BRAND_PROPERTY;this.visual=a.VISUAL;switch(this.productType){case 0:case 1:case 2:if(a.PRODUCT&&typeof a.PRODUCT==="object"){this.currentPriceMode=a.PRODUCT.ITEM_PRICE_MODE;this.currentPrices=a.PRODUCT.ITEM_PRICES;this.currentPriceSelected=a.PRODUCT.ITEM_PRICE_SELECTED;this.currentQuantityRanges=a.PRODUCT.ITEM_QUANTITY_RANGES;this.currentQuantityRangeSelected=a.PRODUCT.ITEM_QUANTITY_RANGE_SELECTED;if(this.showQuantity){this.product.checkQuantity=a.PRODUCT.CHECK_QUANTITY;this.product.isDblQuantity=a.PRODUCT.QUANTITY_FLOAT;if(this.product.checkQuantity){this.product.maxQuantity=(this.product.isDblQuantity?parseFloat(a.PRODUCT.MAX_QUANTITY):parseInt(a.PRODUCT.MAX_QUANTITY,10))}this.product.stepQuantity=(this.product.isDblQuantity?parseFloat(a.PRODUCT.STEP_QUANTITY):parseInt(a.PRODUCT.STEP_QUANTITY,10));this.checkQuantity=this.product.checkQuantity;this.isDblQuantity=this.product.isDblQuantity;this.stepQuantity=this.product.stepQuantity;this.maxQuantity=this.product.maxQuantity;this.minQuantity=this.currentPriceMode==="Q"?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity;if(this.isDblQuantity){this.stepQuantity=Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor}}this.product.canBuy=a.PRODUCT.CAN_BUY;if(a.PRODUCT.MORE_PHOTO_COUNT){this.product.morePhotoCount=a.PRODUCT.MORE_PHOTO_COUNT;this.product.morePhoto=a.PRODUCT.MORE_PHOTO}if(a.PRODUCT.RCM_ID){this.product.rcmId=a.PRODUCT.RCM_ID}this.canBuy=this.product.canBuy;this.product.name=a.PRODUCT.NAME;this.product.pict=a.PRODUCT.PICT;this.product.id=a.PRODUCT.ID;this.product.DETAIL_PAGE_URL=a.PRODUCT.DETAIL_PAGE_URL;if(a.PRODUCT.ADD_URL){this.product.addUrl=a.PRODUCT.ADD_URL}if(a.PRODUCT.BUY_URL){this.product.buyUrl=a.PRODUCT.BUY_URL}if(a.BASKET&&typeof a.BASKET==="object"){this.basketData.useProps=a.BASKET.ADD_PROPS;this.basketData.emptyProps=a.BASKET.EMPTY_PROPS}}else{this.errorCode=-1}break;case 3:if(a.PRODUCT&&typeof a.PRODUCT==="object"){this.product.name=a.PRODUCT.NAME;this.product.id=a.PRODUCT.ID;this.product.DETAIL_PAGE_URL=a.PRODUCT.DETAIL_PAGE_URL;this.product.morePhotoCount=a.PRODUCT.MORE_PHOTO_COUNT;this.product.morePhoto=a.PRODUCT.MORE_PHOTO;if(a.PRODUCT.RCM_ID){this.product.rcmId=a.PRODUCT.RCM_ID}}if(a.OFFERS&&BX.type.isArray(a.OFFERS)){this.offers=a.OFFERS;this.offerNum=0;if(a.OFFER_SELECTED){this.offerNum=parseInt(a.OFFER_SELECTED,10)}if(isNaN(this.offerNum)){this.offerNum=0}if(a.TREE_PROPS){this.treeProps=a.TREE_PROPS}if(a.DEFAULT_PICTURE){this.defaultPict.pict=a.DEFAULT_PICTURE.PICTURE;this.defaultPict.secondPict=a.DEFAULT_PICTURE.PICTURE_SECOND}}break;default:this.errorCode=-1}if(a.BASKET&&typeof a.BASKET==="object"){if(a.BASKET.QUANTITY){this.basketData.quantity=a.BASKET.QUANTITY}if(a.BASKET.PROPS){this.basketData.props=a.BASKET.PROPS}if(a.BASKET.BASKET_URL){this.basketData.basketUrl=a.BASKET.BASKET_URL}if(3===this.productType){if(a.BASKET.SKU_PROPS){this.basketData.sku_props=a.BASKET.SKU_PROPS}}if(a.BASKET.ADD_URL_TEMPLATE){this.basketData.add_url=a.BASKET.ADD_URL_TEMPLATE}if(a.BASKET.BUY_URL_TEMPLATE){this.basketData.buy_url=a.BASKET.BUY_URL_TEMPLATE}if(this.basketData.add_url===""&&this.basketData.buy_url===""){this.errorCode=-1024}}if(this.useCompare){if(a.COMPARE&&typeof a.COMPARE==="object"){if(a.COMPARE.COMPARE_PATH){this.compareData.comparePath=a.COMPARE.COMPARE_PATH}if(a.COMPARE.COMPARE_URL_TEMPLATE){this.compareData.compareUrl=a.COMPARE.COMPARE_URL_TEMPLATE}else{this.useCompare=false}if(a.COMPARE.COMPARE_DELETE_URL_TEMPLATE){this.compareData.compareDeleteUrl=a.COMPARE.COMPARE_DELETE_URL_TEMPLATE}else{this.useCompare=false}}else{this.useCompare=false}}this.isFacebookConversionCustomizeProductEventEnabled=a.IS_FACEBOOK_CONVERSION_CUSTOMIZE_PRODUCT_EVENT_ENABLED}if(this.errorCode===0){BX.ready(BX.delegate(this.init,this))}};c.JCCatalogItem.prototype={init:function(){var i=0,a=null;this.obProduct=BX(this.visual.ID);if(!this.obProduct){this.errorCode=-1}this.obPict=BX(this.visual.PICT_ID);if(!this.obPict){this.errorCode=-2}if(this.secondPict&&this.visual.SECOND_PICT_ID){this.obSecondPict=BX(this.visual.SECOND_PICT_ID)}this.obPictSlider=BX(this.visual.PICT_SLIDER_ID);this.obPictSliderIndicator=BX(this.visual.PICT_SLIDER_ID+"_indicator");this.obPictSliderProgressBar=BX(this.visual.PICT_SLIDER_ID+"_progress_bar");if(!this.obPictSlider){this.errorCode=-4}this.obPrice=BX(this.visual.PRICE_ID);this.obPriceOld=BX(this.visual.PRICE_OLD_ID);this.obPriceTotal=BX(this.visual.PRICE_TOTAL_ID);if(!this.obPrice){this.errorCode=-16}if(this.showQuantity&&this.visual.QUANTITY_ID){this.obQuantity=BX(this.visual.QUANTITY_ID);this.blockNodes.quantity=this.obProduct.querySelector('[data-entity="quantity-block"]');if(!this.isTouchDevice){BX.bind(this.obQuantity,"focus",BX.proxy(this.onFocus,this));BX.bind(this.obQuantity,"blur",BX.proxy(this.onBlur,this))}if(this.visual.QUANTITY_UP_ID){this.obQuantityUp=BX(this.visual.QUANTITY_UP_ID)}if(this.visual.QUANTITY_DOWN_ID){this.obQuantityDown=BX(this.visual.QUANTITY_DOWN_ID)}}if(this.visual.QUANTITY_LIMIT&&this.showMaxQuantity!=="N"){this.obQuantityLimit.all=BX(this.visual.QUANTITY_LIMIT);if(this.obQuantityLimit.all){this.obQuantityLimit.value=this.obQuantityLimit.all.querySelector('[data-entity="quantity-limit-value"]');if(!this.obQuantityLimit.value){this.obQuantityLimit.all=null}}}if(this.productType===3&&this.fullDisplayMode){if(this.visual.TREE_ID){this.obTree=BX(this.visual.TREE_ID);if(!this.obTree){this.errorCode=-256}}if(this.visual.QUANTITY_MEASURE){this.obMeasure=BX(this.visual.QUANTITY_MEASURE)}}this.obBasketActions=BX(this.visual.BASKET_ACTIONS_ID);if(this.obBasketActions){if(this.visual.BUY_ID){this.obBuyBtn=BX(this.visual.BUY_ID)}}this.obNotAvail=BX(this.visual.NOT_AVAILABLE_MESS);if(this.showSubscription){this.obSubscribe=BX(this.visual.SUBSCRIBE_ID)}if(this.showPercent){if(this.visual.DSC_PERC){this.obDscPerc=BX(this.visual.DSC_PERC)}if(this.secondPict&&this.visual.SECOND_DSC_PERC){this.obSecondDscPerc=BX(this.visual.SECOND_DSC_PERC)}}if(this.showSkuProps){if(this.visual.DISPLAY_PROP_DIV){this.obSkuProps=BX(this.visual.DISPLAY_PROP_DIV)}}if(this.errorCode===0){if(this.isTouchDevice){BX.bind(this.obPictSlider,"touchstart",BX.proxy(this.touchStartEvent,this));BX.bind(this.obPictSlider,"touchend",BX.proxy(this.touchEndEvent,this));BX.bind(this.obPictSlider,"touchcancel",BX.proxy(this.touchEndEvent,this))}else{if(this.viewMode==="CARD"){BX.bind(this.obProduct,"mouseenter",BX.proxy(this.hoverOn,this));BX.bind(this.obProduct,"mouseleave",BX.proxy(this.hoverOff,this))}BX.bind(this.obProduct,"mouseenter",BX.proxy(this.cycleSlider,this));BX.bind(this.obProduct,"mouseleave",BX.proxy(this.stopSlider,this))}if(this.bigData){var j=BX.findChildren(this.obProduct,{tag:"a"},true);if(j){for(i in j){if(j.hasOwnProperty(i)){if(j[i].getAttribute("href")==this.product.DETAIL_PAGE_URL){BX.bind(j[i],"click",BX.proxy(this.rememberProductRecommendation,this))}}}}}if(this.showQuantity){var h=this.isTouchDevice?"touchstart":"mousedown";var b=this.isTouchDevice?"touchend":"mouseup";if(this.obQuantityUp){BX.bind(this.obQuantityUp,h,BX.proxy(this.startQuantityInterval,this));BX.bind(this.obQuantityUp,b,BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityUp,"mouseout",BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityUp,"click",BX.delegate(this.quantityUp,this))}if(this.obQuantityDown){BX.bind(this.obQuantityDown,h,BX.proxy(this.startQuantityInterval,this));BX.bind(this.obQuantityDown,b,BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityDown,"mouseout",BX.proxy(this.clearQuantityInterval,this));BX.bind(this.obQuantityDown,"click",BX.delegate(this.quantityDown,this))}if(this.obQuantity){BX.bind(this.obQuantity,"change",BX.delegate(this.quantityChange,this))}}switch(this.productType){case 0:case 1:case 2:if(parseInt(this.product.morePhotoCount)>1&&this.obPictSlider){this.initializeSlider()}this.checkQuantityControls();break;case 3:if(this.offers.length>0){a=BX.findChildren(this.obTree,{tagName:"li"},true);if(a&&a.length){for(i=0;i<a.length;i++){BX.bind(a[i],"click",BX.delegate(this.selectOfferProp,this))}}this.setCurrent()}else{if(parseInt(this.product.morePhotoCount)>1&&this.obPictSlider){this.initializeSlider()}}break}if(this.obBuyBtn){if(this.basketAction==="ADD"){BX.bind(this.obBuyBtn,"click",BX.proxy(this.add2Basket,this))}else{BX.bind(this.obBuyBtn,"click",BX.proxy(this.buyBasket,this))}}if(this.useCompare){this.obCompare=BX(this.visual.COMPARE_LINK_ID);if(this.obCompare){BX.bind(this.obCompare,"click",BX.proxy(this.compare,this))}BX.addCustomEvent("onCatalogDeleteCompare",BX.proxy(this.checkDeletedCompare,this))}}},setAnalyticsDataLayer:function(q){if(!this.useEnhancedEcommerce||!this.dataLayerName){return}var a={},s={},i=[],j,p,k,t,b,r;switch(this.productType){case 0:case 1:case 2:a={id:this.product.id,name:this.product.name,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,brand:BX.type.isArray(this.brandProperty)?this.brandProperty.join("/"):this.brandProperty};break;case 3:for(j in this.offers[this.offerNum].TREE){if(this.offers[this.offerNum].TREE.hasOwnProperty(j)){t=j.substring(5);b=this.offers[this.offerNum].TREE[j];for(p in this.treeProps){if(this.treeProps.hasOwnProperty(p)&&this.treeProps[p].ID==t){for(k in this.treeProps[p].VALUES){r=this.treeProps[p].VALUES[k];if(r.ID==b){i.push(r.NAME);break}}}}}}a={id:this.offers[this.offerNum].ID,name:this.offers[this.offerNum].NAME,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,brand:BX.type.isArray(this.brandProperty)?this.brandProperty.join("/"):this.brandProperty,variant:i.join("/")};break}switch(q){case"addToCart":s={ecommerce:{currencyCode:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].CURRENCY||"",add:{products:[{name:a.name||"",id:a.id||"",price:a.price||0,brand:a.brand||"",category:a.category||"",variant:a.variant||"",quantity:this.showQuantity&&this.obQuantity?this.obQuantity.value:1}]}}};break}c[this.dataLayerName]=c[this.dataLayerName]||[];c[this.dataLayerName].push(s)},hoverOn:function(a){clearTimeout(this.hoverTimer);this.obProduct.style.height=getComputedStyle(this.obProduct).height;BX.addClass(this.obProduct,"hover");BX.PreventDefault(a)},hoverOff:function(a){if(this.hoverStateChangeForbidden){return}BX.removeClass(this.obProduct,"hover");this.hoverTimer=setTimeout(BX.delegate(function(){this.obProduct.style.height="auto"},this),300);BX.PreventDefault(a)},onFocus:function(){this.hoverStateChangeForbidden=true;BX.bind(document,"mousemove",BX.proxy(this.captureMousePosition,this))},onBlur:function(){this.hoverStateChangeForbidden=false;BX.unbind(document,"mousemove",BX.proxy(this.captureMousePosition,this));var a=document.elementFromPoint(this.mouseX,this.mouseY);if(!a||!this.obProduct.contains(a)){this.hoverOff()}},captureMousePosition:function(a){this.mouseX=a.clientX;this.mouseY=a.clientY},getCookie:function(b){var a=document.cookie.match(new RegExp("(?:^|; )"+b.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return a?decodeURIComponent(a[1]):null},rememberProductRecommendation:function(){var a=BX.cookie_prefix+"_RCM_PRODUCT_LOG",m=this.getCookie(a),l=false;var b=[],o;if(m){b=m.split(".")}var n=b.length;while(n--){o=b[n].split("-");if(o[0]==this.product.id){o=b[n].split("-");o[1]=this.product.rcmId;o[2]=BX.current_server_time;b[n]=o.join("-");l=true}else{if((BX.current_server_time-o[2])>3600*24*30){b.splice(n,1)}}}if(!l){b.push([this.product.id,this.product.rcmId,BX.current_server_time].join("-"))}var p=b.join("."),i=new Date(new Date().getTime()+1000*3600*24*365*10).toUTCString();document.cookie=a+"="+p+"; path=/; expires="+i+"; domain="+BX.cookie_domain},startQuantityInterval:function(){var a=BX.proxy_context;var b=a.id===this.visual.QUANTITY_DOWN_ID?BX.proxy(this.quantityDown,this):BX.proxy(this.quantityUp,this);this.quantityDelay=setTimeout(BX.delegate(function(){this.quantityTimer=setInterval(b,150)},this),300)},clearQuantityInterval:function(){clearTimeout(this.quantityDelay);clearInterval(this.quantityTimer)},quantityUp:function(){var a=0,b=true;if(this.errorCode===0&&this.showQuantity&&this.canBuy){a=(this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10));if(!isNaN(a)){a+=this.stepQuantity;if(this.checkQuantity){if(a>this.maxQuantity){b=false}}if(b){if(this.isDblQuantity){a=Math.round(a*this.precisionFactor)/this.precisionFactor}this.obQuantity.value=a;this.setPrice()}}}},quantityDown:function(){var a=0,b=true;if(this.errorCode===0&&this.showQuantity&&this.canBuy){a=(this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10));if(!isNaN(a)){a-=this.stepQuantity;this.checkPriceRange(a);if(a<this.minQuantity){b=false}if(b){if(this.isDblQuantity){a=Math.round(a*this.precisionFactor)/this.precisionFactor}this.obQuantity.value=a;this.setPrice()}}}},quantityChange:function(){var a=0,b;if(this.errorCode===0&&this.showQuantity){if(this.canBuy){a=this.isDblQuantity?parseFloat(this.obQuantity.value):Math.round(this.obQuantity.value);if(!isNaN(a)){if(this.checkQuantity){if(a>this.maxQuantity){a=this.maxQuantity}}this.checkPriceRange(a);b=Math.floor(Math.round(a*this.precisionFactor/this.stepQuantity)/this.precisionFactor)||1;a=(b<=1?this.stepQuantity:b*this.stepQuantity);a=Math.round(a*this.precisionFactor)/this.precisionFactor;if(a<this.minQuantity){a=this.minQuantity}this.obQuantity.value=a}else{this.obQuantity.value=this.minQuantity}}else{this.obQuantity.value=this.minQuantity}this.setPrice()}},quantitySet:function(i){var b,j;var a=this.offers[i],l=this.offers[this.offerNum];if(this.errorCode===0){this.canBuy=a.CAN_BUY;this.currentPriceMode=a.ITEM_PRICE_MODE;this.currentPrices=a.ITEM_PRICES;this.currentPriceSelected=a.ITEM_PRICE_SELECTED;this.currentQuantityRanges=a.ITEM_QUANTITY_RANGES;this.currentQuantityRangeSelected=a.ITEM_QUANTITY_RANGE_SELECTED;if(this.canBuy){if(this.blockNodes.quantity){BX.style(this.blockNodes.quantity,"display","")}if(this.obBasketActions){BX.style(this.obBasketActions,"display","")}if(this.obNotAvail){BX.style(this.obNotAvail,"display","none")}if(this.obSubscribe){BX.style(this.obSubscribe,"display","none")}}else{if(this.blockNodes.quantity){BX.style(this.blockNodes.quantity,"display","none")}if(this.obBasketActions){BX.style(this.obBasketActions,"display","none")}if(this.obNotAvail){BX.style(this.obNotAvail,"display","")}if(this.obSubscribe){if(a.CATALOG_SUBSCRIBE==="Y"){BX.style(this.obSubscribe,"display","");this.obSubscribe.setAttribute("data-item",a.ID);BX(this.visual.SUBSCRIBE_ID+"_hidden").click()}else{BX.style(this.obSubscribe,"display","none")}}}this.isDblQuantity=a.QUANTITY_FLOAT;this.checkQuantity=a.CHECK_QUANTITY;if(this.isDblQuantity){this.stepQuantity=Math.round(parseFloat(a.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor;this.maxQuantity=parseFloat(a.MAX_QUANTITY);this.minQuantity=this.currentPriceMode==="Q"?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity}else{this.stepQuantity=parseInt(a.STEP_QUANTITY,10);this.maxQuantity=parseInt(a.MAX_QUANTITY,10);this.minQuantity=this.currentPriceMode==="Q"?parseInt(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity}if(this.showQuantity){var k=l.ITEM_PRICES.length&&l.ITEM_PRICES[l.ITEM_PRICE_SELECTED]&&l.ITEM_PRICES[l.ITEM_PRICE_SELECTED].MIN_QUANTITY!=this.minQuantity;if(this.isDblQuantity){b=Math.round(parseFloat(l.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor!==this.stepQuantity||k||l.MEASURE!==a.MEASURE||(this.checkQuantity&&parseFloat(l.MAX_QUANTITY)>this.maxQuantity&&parseFloat(this.obQuantity.value)>this.maxQuantity)}else{b=parseInt(l.STEP_QUANTITY,10)!==this.stepQuantity||k||l.MEASURE!==a.MEASURE||(this.checkQuantity&&parseInt(l.MAX_QUANTITY,10)>this.maxQuantity&&parseInt(this.obQuantity.value,10)>this.maxQuantity)}this.obQuantity.disabled=!this.canBuy;if(b){this.obQuantity.value=this.minQuantity}if(this.obMeasure){if(a.MEASURE){BX.adjust(this.obMeasure,{html:a.MEASURE})}else{BX.adjust(this.obMeasure,{html:""})}}}if(this.obQuantityLimit.all){if(!this.checkQuantity||this.maxQuantity==0){BX.adjust(this.obQuantityLimit.value,{html:""});BX.adjust(this.obQuantityLimit.all,{style:{display:"none"}})}else{if(this.showMaxQuantity==="M"){j=(this.maxQuantity/this.stepQuantity>=this.relativeQuantityFactor)?BX.message("RELATIVE_QUANTITY_MANY"):BX.message("RELATIVE_QUANTITY_FEW")}else{j=this.maxQuantity;if(a.MEASURE){j+=(" "+a.MEASURE)}}BX.adjust(this.obQuantityLimit.value,{html:j});BX.adjust(this.obQuantityLimit.all,{style:{display:""}})}}}},initializeSlider:function(){var a=this.obPictSlider.getAttribute("data-slider-wrap");if(a){this.slider.options.wrap=a==="true"}else{this.slider.options.wrap=this.defaultSliderOptions.wrap}if(this.isTouchDevice){this.slider.options.interval=false}else{this.slider.options.interval=parseInt(this.obPictSlider.getAttribute("data-slider-interval"))||this.defaultSliderOptions.interval;if(this.slider.options.interval<700){this.slider.options.interval=700}if(this.obPictSliderIndicator){var f=this.obPictSliderIndicator.querySelectorAll("[data-go-to]");for(var b in f){if(f.hasOwnProperty(b)){BX.bind(f[b],"click",BX.proxy(this.sliderClickHandler,this))}}}if(this.obPictSliderProgressBar){if(this.slider.progress){this.resetProgress();this.cycleSlider()}else{this.slider.progress=new BX.easing({transition:BX.easing.transitions.linear,step:BX.delegate(function(e){this.obPictSliderProgressBar.style.width=e.width/10+"%"},this)})}}}},checkTouch:function(a){if(!a||!a.changedTouches){return false}return a.changedTouches[0].identifier===this.touch.identifier},touchStartEvent:function(a){if(a.touches.length!=1){return}this.touch=a.changedTouches[0]},touchEndEvent:function(a){if(!this.checkTouch(a)){return}var b=this.touch.pageX-a.changedTouches[0].pageX,f=this.touch.pageY-a.changedTouches[0].pageY;if(Math.abs(b)>=Math.abs(f)+10){if(b>0){this.slideNext()}if(b<0){this.slidePrev()}}},sliderClickHandler:function(f){var a=BX.getEventTarget(f),b=a.getAttribute("data-go-to");if(b){this.slideTo(b)}BX.PreventDefault(f)},slideNext:function(){if(this.slider.sliding){return}return this.slide("next")},slidePrev:function(){if(this.slider.sliding){return}return this.slide("prev")},slideTo:function(a){this.slider.active=BX.findChild(this.obPictSlider,{className:"item active"},true,false);this.slider.progress&&(this.slider.interval=true);var b=this.getItemIndex(this.slider.active);if(a>(this.slider.items.length-1)||a<0){return}if(this.slider.sliding){return false}if(b==a){this.stopSlider();this.cycleSlider();return}return this.slide(a>b?"next":"prev",this.eq(this.slider.items,a))},slide:function(k,l){var b=BX.findChild(this.obPictSlider,{className:"item active"},true,false),a=this.slider.interval,j=k==="next"?"left":"right";l=l||this.getItemForDirection(k,b);if(BX.hasClass(l,"active")){return(this.slider.sliding=false)}this.slider.sliding=true;a&&this.stopSlider();if(this.obPictSliderIndicator){BX.removeClass(this.obPictSliderIndicator.querySelector(".active"),"active");var n=this.obPictSliderIndicator.querySelectorAll("[data-go-to]")[this.getItemIndex(l)];n&&BX.addClass(n,"active")}if(BX.hasClass(this.obPictSlider,"slide")&&!BX.browser.IsIE()){var m=this;BX.addClass(l,k);l.offsetWidth;BX.addClass(b,j);BX.addClass(l,j);setTimeout(function(){BX.addClass(l,"active");BX.removeClass(b,"active");BX.removeClass(b,j);BX.removeClass(l,k);BX.removeClass(l,j);m.slider.sliding=false},700)}else{BX.addClass(l,"active");this.slider.sliding=false}this.obPictSliderProgressBar&&this.resetProgress();a&&this.cycleSlider()},stopSlider:function(a){a||(this.slider.paused=true);this.slider.interval&&clearInterval(this.slider.interval);if(this.slider.progress){this.slider.progress.stop();var b=parseInt(this.obPictSliderProgressBar.style.width);this.slider.progress.options.duration=this.slider.options.interval*b/200;this.slider.progress.options.start={width:b*10};this.slider.progress.options.finish={width:0};this.slider.progress.options.complete=null;this.slider.progress.animate()}},cycleSlider:function(a){a||(this.slider.paused=false);this.slider.interval&&clearInterval(this.slider.interval);if(this.slider.options.interval&&!this.slider.paused){if(this.slider.progress){this.slider.progress.stop();var b=parseInt(this.obPictSliderProgressBar.style.width);this.slider.progress.options.duration=this.slider.options.interval*(100-b)/100;this.slider.progress.options.start={width:b*10};this.slider.progress.options.finish={width:1000};this.slider.progress.options.complete=BX.delegate(function(){this.slider.interval=true;this.slideNext()},this);this.slider.progress.animate()}else{this.slider.interval=setInterval(BX.proxy(this.slideNext,this),this.slider.options.interval)}}},resetProgress:function(){this.slider.progress&&this.slider.progress.stop();this.obPictSliderProgressBar.style.width=0},getItemForDirection:function(b,i){var l=this.getItemIndex(i),k=b==="prev"&&l===0||b==="next"&&l==(this.slider.items.length-1);if(k&&!this.slider.options.wrap){return i}var a=b==="prev"?-1:1,j=(l+a)%this.slider.items.length;return this.eq(this.slider.items,j)},getItemIndex:function(a){this.slider.items=BX.findChildren(a.parentNode,{className:"item"},true);return this.slider.items.indexOf(a||this.slider.active)},eq:function(a,b){var h=a.length,g=+b+(b<0?h:0);return g>=0&&g<h?a[g]:{}},selectOfferProp:function(){var l=0,j="",k="",a=[],b=null,i=BX.proxy_context;if(i&&i.hasAttribute("data-treevalue")){if(BX.hasClass(i,"selected")){return}k=i.getAttribute("data-treevalue");a=k.split("_");if(this.searchOfferPropIndex(a[0],a[1])){b=BX.findChildren(i.parentNode,{tagName:"li"},false);if(b&&0<b.length){for(l=0;l<b.length;l++){j=b[l].getAttribute("data-onevalue");if(j===a[1]){BX.addClass(b[l],"selected")}else{BX.removeClass(b[l],"selected")}}}if(this.isFacebookConversionCustomizeProductEventEnabled&&BX.Type.isArrayFilled(this.offers)&&BX.Type.isObject(this.offers[this.offerNum])){BX.ajax.runAction("sale.facebookconversion.customizeProduct",{data:{offerId:this.offers[this.offerNum]["ID"]}})}}}},searchOfferPropIndex:function(t,b){var p="",a=false,s,u,j=[],v=[],r=-1,q={},i=[];for(s=0;s<this.treeProps.length;s++){if(this.treeProps[s].ID===t){r=s;break}}if(-1<r){for(s=0;s<r;s++){p="PROP_"+this.treeProps[s].ID;q[p]=this.selectedValues[p]}p="PROP_"+this.treeProps[r].ID;a=this.getRowValues(q,p);if(!a){return false}if(!BX.util.in_array(b,a)){return false}q[p]=b;for(s=r+1;s<this.treeProps.length;s++){p="PROP_"+this.treeProps[s].ID;a=this.getRowValues(q,p);if(!a){return false}v=[];if(this.showAbsent){j=[];i=[];i=BX.clone(q,true);for(u=0;u<a.length;u++){i[p]=a[u];v[v.length]=a[u];if(this.getCanBuy(i)){j[j.length]=a[u]}}}else{j=a}if(this.selectedValues[p]&&BX.util.in_array(this.selectedValues[p],j)){q[p]=this.selectedValues[p]}else{if(this.showAbsent){q[p]=(j.length>0?j[0]:v[0])}else{q[p]=j[0]}}this.updateRow(s,q[p],a,j)}this.selectedValues=q;this.changeInfo()}return true},updateRow:function(a,p,o,s){var r=0,i="",t=false,n=null;var b=this.obTree.querySelectorAll('[data-entity="sku-line-block"]'),q;if(a>-1&&a<b.length){q=b[a].querySelector("ul");n=BX.findChildren(q,{tagName:"li"},false);if(n&&0<n.length){for(r=0;r<n.length;r++){i=n[r].getAttribute("data-onevalue");t=i===p;if(t){BX.addClass(n[r],"selected")}else{BX.removeClass(n[r],"selected")}if(BX.util.in_array(i,s)){BX.removeClass(n[r],"notallowed")}else{BX.addClass(n[r],"notallowed")}n[r].style.display=BX.util.in_array(i,o)?"":"none";if(t){b[a].style.display=(i==0&&s.length==1)?"none":""}}}}},getRowValues:function(m,j){var i=0,l,n=[],b=false,a=true;if(0===m.length){for(i=0;i<this.offers.length;i++){if(!BX.util.in_array(this.offers[i].TREE[j],n)){n[n.length]=this.offers[i].TREE[j]}}b=true}else{for(i=0;i<this.offers.length;i++){a=true;for(l in m){if(m[l]!==this.offers[i].TREE[l]){a=false;break}}if(a){if(!BX.util.in_array(this.offers[i].TREE[j],n)){n[n.length]=this.offers[i].TREE[j]}b=true}}}return(b?n:false)},getCanBuy:function(j){var h,i,b=false,a=true;for(h=0;h<this.offers.length;h++){a=true;for(i in j){if(j[i]!==this.offers[h].TREE[i]){a=false;break}}if(a){if(this.offers[h].CAN_BUY){b=true;break}}}return b},setCurrent:function(){var i,j=0,p=[],b="",m=false,n={},o=[],a=this.offers[this.offerNum].TREE;for(i=0;i<this.treeProps.length;i++){b="PROP_"+this.treeProps[i].ID;m=this.getRowValues(n,b);if(!m){break}if(BX.util.in_array(a[b],m)){n[b]=a[b]}else{n[b]=m[0];this.offerNum=0}if(this.showAbsent){p=[];o=[];o=BX.clone(n,true);for(j=0;j<m.length;j++){o[b]=m[j];if(this.getCanBuy(o)){p[p.length]=m[j]}}}else{p=m}this.updateRow(i,n[b],m,p)}this.selectedValues=n;this.changeInfo()},changeInfo:function(){var h,i,j=-1,b=true,a;for(h=0;h<this.offers.length;h++){b=true;for(i in this.selectedValues){if(this.selectedValues[i]!==this.offers[h].TREE[i]){b=false;break}}if(b){j=h;break}}if(j>-1){if(parseInt(this.offers[j].MORE_PHOTO_COUNT)>1&&this.obPictSlider){if(this.obPict){this.obPict.style.display="none"}if(this.obSecondPict){this.obSecondPict.style.display="none"}BX.cleanNode(this.obPictSlider);for(h in this.offers[j].MORE_PHOTO){if(this.offers[j].MORE_PHOTO.hasOwnProperty(h)){this.obPictSlider.appendChild(BX.create("SPAN",{props:{className:"product-item-image-slide item"+(h==0?" active":"")},style:{backgroundImage:"url('"+this.offers[j].MORE_PHOTO[h].SRC+"')"}}))}}if(this.obPictSliderIndicator){BX.cleanNode(this.obPictSliderIndicator);for(h in this.offers[j].MORE_PHOTO){if(this.offers[j].MORE_PHOTO.hasOwnProperty(h)){this.obPictSliderIndicator.appendChild(BX.create("DIV",{attrs:{"data-go-to":h},props:{className:"product-item-image-slider-control"+(h==0?" active":"")}}));this.obPictSliderIndicator.appendChild(document.createTextNode(" "))}}this.obPictSliderIndicator.style.display=""}if(this.obPictSliderProgressBar){this.obPictSliderProgressBar.style.display=""}this.obPictSlider.style.display="";this.initializeSlider()}else{if(this.obPictSlider){this.obPictSlider.style.display="none"}if(this.obPictSliderIndicator){this.obPictSliderIndicator.style.display="none"}if(this.obPictSliderProgressBar){this.obPictSliderProgressBar.style.display="none"}if(this.obPict){if(this.offers[j].PREVIEW_PICTURE){BX.adjust(this.obPict,{style:{backgroundImage:"url('"+this.offers[j].PREVIEW_PICTURE.SRC+"')"}})}else{BX.adjust(this.obPict,{style:{backgroundImage:"url('"+this.defaultPict.pict.SRC+"')"}})}this.obPict.style.display=""}if(this.secondPict&&this.obSecondPict){if(this.offers[j].PREVIEW_PICTURE_SECOND){BX.adjust(this.obSecondPict,{style:{backgroundImage:"url('"+this.offers[j].PREVIEW_PICTURE_SECOND.SRC+"')"}})}else{if(this.offers[j].PREVIEW_PICTURE.SRC){BX.adjust(this.obSecondPict,{style:{backgroundImage:"url('"+this.offers[j].PREVIEW_PICTURE.SRC+"')"}})}else{if(this.defaultPict.secondPict){BX.adjust(this.obSecondPict,{style:{backgroundImage:"url('"+this.defaultPict.secondPict.SRC+"')"}})}else{BX.adjust(this.obSecondPict,{style:{backgroundImage:"url('"+this.defaultPict.pict.SRC+"')"}})}}}this.obSecondPict.style.display=""}}if(this.showSkuProps&&this.obSkuProps){if(this.offers[j].DISPLAY_PROPERTIES.length){BX.adjust(this.obSkuProps,{style:{display:""},html:this.offers[j].DISPLAY_PROPERTIES})}else{BX.adjust(this.obSkuProps,{style:{display:"none"},html:""})}}this.quantitySet(j);this.setPrice();this.setCompared(this.offers[j].COMPARED);this.offerNum=j}},checkPriceRange:function(a){if(typeof a==="undefined"||this.currentPriceMode!="Q"){return}var i,b=false;for(var h in this.currentQuantityRanges){if(this.currentQuantityRanges.hasOwnProperty(h)){i=this.currentQuantityRanges[h];if(parseInt(a)>=parseInt(i.SORT_FROM)&&(i.SORT_TO=="INF"||parseInt(a)<=parseInt(i.SORT_TO))){b=true;this.currentQuantityRangeSelected=i.HASH;break}}}if(!b&&(i=this.getMinPriceRange())){this.currentQuantityRangeSelected=i.HASH}for(var j in this.currentPrices){if(this.currentPrices.hasOwnProperty(j)){if(this.currentPrices[j].QUANTITY_HASH==this.currentQuantityRangeSelected){this.currentPriceSelected=j;break}}}},getMinPriceRange:function(){var b;for(var a in this.currentQuantityRanges){if(this.currentQuantityRanges.hasOwnProperty(a)){if(!b||parseInt(this.currentQuantityRanges[a].SORT_FROM)<parseInt(b.SORT_FROM)){b=this.currentQuantityRanges[a]}}}return b},checkQuantityControls:function(){if(!this.obQuantity){return}var a=this.checkQuantity&&parseFloat(this.obQuantity.value)+this.stepQuantity>this.maxQuantity,b=parseFloat(this.obQuantity.value)-this.stepQuantity<this.minQuantity;if(a){BX.addClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")}else{if(BX.hasClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")){BX.removeClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")}}if(b){BX.addClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")}else{if(BX.hasClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")){BX.removeClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")}}if(a&&b){this.obQuantity.setAttribute("disabled","disabled")}else{this.obQuantity.removeAttribute("disabled")}},setPrice:function(){var a,b;if(this.obQuantity){this.checkPriceRange(this.obQuantity.value)}this.checkQuantityControls();b=this.currentPrices[this.currentPriceSelected];if(this.obPrice){if(b){BX.adjust(this.obPrice,{html:BX.Currency.currencyFormat(b.RATIO_PRICE,b.CURRENCY,true)})}else{BX.adjust(this.obPrice,{html:""})}if(this.showOldPrice&&this.obPriceOld){if(b&&b.RATIO_PRICE!==b.RATIO_BASE_PRICE){BX.adjust(this.obPriceOld,{style:{display:""},html:BX.Currency.currencyFormat(b.RATIO_BASE_PRICE,b.CURRENCY,true)})}else{BX.adjust(this.obPriceOld,{style:{display:"none"},html:""})}}if(this.obPriceTotal){if(b&&this.obQuantity&&this.obQuantity.value!=this.stepQuantity){BX.adjust(this.obPriceTotal,{html:BX.message("PRICE_TOTAL_PREFIX")+" <strong>"+BX.Currency.currencyFormat(b.PRICE*this.obQuantity.value,b.CURRENCY,true)+"</strong>",style:{display:""}})}else{BX.adjust(this.obPriceTotal,{html:"",style:{display:"none"}})}}if(this.showPercent){if(b&&parseInt(b.PERCENT)>0){a={style:{display:""},html:-b.PERCENT+"%"}}else{a={style:{display:"none"},html:""}}if(this.obDscPerc){BX.adjust(this.obDscPerc,a)}if(this.obSecondDscPerc){BX.adjust(this.obSecondDscPerc,a)}}}},compare:function(j){var b=this.obCompare.querySelector('[data-entity="compare-checkbox"]'),a=BX.getEventTarget(j),k=true;if(b){k=a===b?b.checked:!b.checked}var l=k?this.compareData.compareUrl:this.compareData.compareDeleteUrl,i;if(l){if(a!==b){BX.PreventDefault(j);this.setCompared(k)}switch(this.productType){case 0:case 1:case 2:i=l.replace("#ID#",this.product.id.toString());break;case 3:i=l.replace("#ID#",this.offers[this.offerNum].ID);break}BX.ajax({method:"POST",dataType:k?"json":"html",url:i+(i.indexOf("?")!==-1?"&":"?")+"ajax_action=Y",onsuccess:k?BX.proxy(this.compareResult,this):BX.proxy(this.compareDeleteResult,this)})}},compareResult:function(f){var b,a;if(this.obPopupWin){this.obPopupWin.close()}if(!BX.type.isPlainObject(f)){return}this.initPopupWindow();if(this.offers.length>0){this.offers[this.offerNum].COMPARED=f.STATUS==="OK"}if(f.STATUS==="OK"){BX.onCustomEvent("OnCompareChange");b='<div style="width: 100%; margin: 0; text-align: center;"><p>'+BX.message("COMPARE_MESSAGE_OK")+"</p></div>";if(this.showClosePopup){a=[new d({text:BX.message("BTN_MESSAGE_COMPARE_REDIRECT"),events:{click:BX.delegate(this.compareRedirect,this)},style:{marginRight:"10px"}}),new d({text:BX.message("BTN_MESSAGE_CLOSE_POPUP"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}else{a=[new d({text:BX.message("BTN_MESSAGE_COMPARE_REDIRECT"),events:{click:BX.delegate(this.compareRedirect,this)}})]}}else{b='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(f.MESSAGE?f.MESSAGE:BX.message("COMPARE_UNKNOWN_ERROR"))+"</p></div>";a=[new d({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}this.obPopupWin.setTitleBar(BX.message("COMPARE_TITLE"));this.obPopupWin.setContent(b);this.obPopupWin.setButtons(a);this.obPopupWin.show()},compareDeleteResult:function(){BX.onCustomEvent("OnCompareChange");if(this.offers&&this.offers.length){this.offers[this.offerNum].COMPARED=false}},setCompared:function(a){if(!this.obCompare){return}var b=this.obCompare.querySelector('[data-entity="compare-checkbox"]');if(b){b.checked=a}},setCompareInfo:function(b){if(!BX.type.isArray(b)){return}for(var a in this.offers){if(this.offers.hasOwnProperty(a)){this.offers[a].COMPARED=BX.util.in_array(this.offers[a].ID,b)}}},compareRedirect:function(){if(this.compareData.comparePath){location.href=this.compareData.comparePath}else{this.obPopupWin.close()}},checkDeletedCompare:function(a){switch(this.productType){case 0:case 1:case 2:if(this.product.id==a){this.setCompared(false)}break;case 3:var b=this.offers.length;while(b--){if(this.offers[b].ID==a){this.offers[b].COMPARED=false;if(this.offerNum==b){this.setCompared(false)}break}}}},initBasketUrl:function(){this.basketUrl=(this.basketMode==="ADD"?this.basketData.add_url:this.basketData.buy_url);switch(this.productType){case 1:case 2:this.basketUrl=this.basketUrl.replace("#ID#",this.product.id.toString());break;case 3:this.basketUrl=this.basketUrl.replace("#ID#",this.offers[this.offerNum].ID);break}this.basketParams={ajax_basket:"Y"};if(this.showQuantity){this.basketParams[this.basketData.quantity]=this.obQuantity.value}if(this.basketData.sku_props){this.basketParams[this.basketData.sku_props_var]=this.basketData.sku_props}},fillBasketProps:function(){if(!this.visual.BASKET_PROP_DIV){return}var h=0,a=null,b=false,g=null;if(this.basketData.useProps&&!this.basketData.emptyProps){if(this.obPopupWin&&this.obPopupWin.contentContainer){g=this.obPopupWin.contentContainer}}else{g=BX(this.visual.BASKET_PROP_DIV)}if(g){a=g.getElementsByTagName("select");if(a&&a.length){for(h=0;h<a.length;h++){if(!a[h].disabled){switch(a[h].type.toLowerCase()){case"select-one":this.basketParams[a[h].name]=a[h].value;b=true;break;default:break}}}}a=g.getElementsByTagName("input");if(a&&a.length){for(h=0;h<a.length;h++){if(!a[h].disabled){switch(a[h].type.toLowerCase()){case"hidden":this.basketParams[a[h].name]=a[h].value;b=true;break;case"radio":if(a[h].checked){this.basketParams[a[h].name]=a[h].value;b=true}break;default:break}}}}}if(!b){this.basketParams[this.basketData.props]=[];this.basketParams[this.basketData.props][0]=0}},add2Basket:function(){this.basketMode="ADD";this.basket()},buyBasket:function(){this.basketMode="BUY";this.basket()},sendToBasket:function(){if(!this.canBuy){return}if(this.product&&this.product.id&&this.bigData){this.rememberProductRecommendation()}this.initBasketUrl();this.fillBasketProps();BX.ajax({method:"POST",dataType:"json",url:this.basketUrl,data:this.basketParams,onsuccess:BX.proxy(this.basketResult,this)})},basket:function(){var a="";if(!this.canBuy){return}switch(this.productType){case 1:case 2:if(this.basketData.useProps&&!this.basketData.emptyProps){this.initPopupWindow();this.obPopupWin.setTitleBar(BX.message("TITLE_BASKET_PROPS"));if(BX(this.visual.BASKET_PROP_DIV)){a=BX(this.visual.BASKET_PROP_DIV).innerHTML}this.obPopupWin.setContent(a);this.obPopupWin.setButtons([new d({text:BX.message("BTN_MESSAGE_SEND_PROPS"),events:{click:BX.delegate(this.sendToBasket,this)}})]);this.obPopupWin.show()}else{this.sendToBasket()}break;case 3:this.sendToBasket();break}},basketResult:function(h){var i="",b="",a,j=[];if(this.obPopupWin){this.obPopupWin.close()}if(!BX.type.isPlainObject(h)){return}a=h.STATUS==="OK";if(a){this.setAnalyticsDataLayer("addToCart")}if(a&&this.basketAction==="BUY"){this.basketRedirect()}else{this.initPopupWindow();if(a){BX.onCustomEvent("OnBasketChange");if(BX.findParent(this.obProduct,{className:"bx_sale_gift_main_products"},10)){BX.onCustomEvent("onAddToBasketMainProduct",[this])}switch(this.productType){case 1:case 2:b=this.product.pict.SRC;break;case 3:b=(this.offers[this.offerNum].PREVIEW_PICTURE?this.offers[this.offerNum].PREVIEW_PICTURE.SRC:this.defaultPict.pict.SRC);break}i='<div style="width: 100%; margin: 0; text-align: center;"><img src="'+b+'" height="130" style="max-height:130px"><p>'+this.product.name+"</p></div>";if(this.showClosePopup){j=[new d({text:BX.message("BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(this.basketRedirect,this)},style:{marginRight:"10px"}}),new d({text:BX.message("BTN_MESSAGE_CLOSE_POPUP"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}else{j=[new d({text:BX.message("BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(this.basketRedirect,this)}})]}}else{i='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(h.MESSAGE?h.MESSAGE:BX.message("BASKET_UNKNOWN_ERROR"))+"</p></div>";j=[new d({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]}this.obPopupWin.setTitleBar(a?BX.message("TITLE_SUCCESSFUL"):BX.message("TITLE_ERROR"));this.obPopupWin.setContent(i);this.obPopupWin.setButtons(j);this.obPopupWin.show()}},basketRedirect:function(){location.href=(this.basketData.basketUrl?this.basketData.basketUrl:BX.message("BASKET_URL"))},initPopupWindow:function(){if(this.obPopupWin){return}this.obPopupWin=BX.PopupWindowManager.create("CatalogSectionBasket_"+this.visual.ID,null,{autoHide:true,offsetLeft:0,offsetTop:0,overlay:true,closeByEsc:true,titleBar:true,closeIcon:true,contentColor:"white",className:this.templateTheme?"bx-"+this.templateTheme:""})}}})(window);