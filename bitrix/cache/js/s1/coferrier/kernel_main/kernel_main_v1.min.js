function CBXSession(){var a=this;this.dateInput=new Date;this.dateCheck=new Date;this.dateHit=new Date;this.notifier=null;this.checkInterval=60;this.checkImmediately=false;this.Expand=function(b){this.key=b;BX.ready(function(){BX.bind(document,"keypress",a.OnUserInput);BX.bind(document.body,"mousemove",a.OnUserInput);BX.bind(document.body,"click",a.OnUserInput);setInterval(a.CheckSession,a.checkInterval*1000)})};this.OnUserInput=function(){var b=new Date;a.dateInput.setTime(b.valueOf());if((b-a.dateHit)/1000>a.checkInterval+5&&a.checkImmediately===false){a.checkImmediately=true;a.CheckSession()}};this.CheckSession=function(){var c=new Date;if((c-a.dateCheck)/1000<a.checkInterval-1&&a.checkImmediately===false){return}a.dateCheck.setTime(c.valueOf());if(a.dateInput>a.dateHit){var b={method:"GET",headers:[{name:"X-Bitrix-Csrf-Token",value:BX.bitrix_sessid()}],dataType:"html",url:"/bitrix/tools/public_session.php?k="+a.key,data:"",onsuccess:function(d){a.CheckResult(d)},lsId:"sess_expand",lsTimeout:a.checkInterval-5};BX.ajax(b)}};this.CheckResult=function(c){var b=new Date;a.dateHit.setTime(b.valueOf());a.checkImmediately=false;if(c=="SESSION_EXPIRED"){if(BX.message("SessExpired")){if(!a.notifier){a.notifier=document.body.appendChild(BX.create("DIV",{props:{className:"bx-session-message"},style:{top:"0",backgroundColor:"#FFEB41",border:"1px solid #EDDA3C",width:"630px",fontFamily:"Arial,Helvetica,sans-serif",fontSize:"13px",fontWeight:"bold",textAlign:"center",color:"black",position:"absolute",zIndex:"10000",padding:"10px"},html:'<a class="bx-session-message-close" style="display:block; width:12px; height:12px; background:url(/bitrix/js/main/core/images/close.gif) center no-repeat; float:right;" href="javascript:bxSession.Close()"></a>'+BX.message("SessExpired")}));BX.ZIndexManager.register(a.notifier);BX.ZIndexManager.bringToFront(a.notifier);var d=BX.GetWindowScrollPos();var e=BX.GetWindowInnerSize();a.notifier.style.left=parseInt(d.scrollLeft+e.innerWidth/2-parseInt(a.notifier.clientWidth)/2)+"px";if(BX.browser.IsIE()){a.notifier.style.top=d.scrollTop+"px";BX.bind(window,"scroll",function(){var f=BX.GetWindowScrollPos();a.notifier.style.top=f.scrollTop+"px"})}else{a.notifier.style.position="fixed"}}a.notifier.style.display=""}}};this.Close=function(){this.notifier.style.display="none"}}var bxSession=new CBXSession;window.BX=BX||{};BX.PageObject={getRootWindow:function(){return BX.PageObject.getTopWindowOfCurrentHost(window)},isCrossOriginObject:function(a){try{void a.location.host}catch(a){return true}return false},getTopWindowOfCurrentHost:function(a){if(!BX.PageObject.isCrossOriginObject(a.parent)&&a.parent!==a&&a.parent.location.host===a.location.host){return BX.PageObject.getTopWindowOfCurrentHost(a.parent)}return a},getParentWindowOfCurrentHost:function(a){if(BX.PageObject.isCrossOriginObject(a.parent)){return a}return a.parent}};(function(window){if(BX.WindowManager){return}BX.WindowManager={_stack:[],_runtime_resize:{},_delta:2,_delta_start:1000,currently_loaded:null,settings_category:"BX.WindowManager.9.5",register:function(t){this.currently_loaded=null;t.WM_REG_INDEX=this._stack.length;this._stack.push(t);if(this._stack.length<2){BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))}},unregister:function(t){if(null==t.WM_REG_INDEX){return null}var e;if(this._stack.length>0){while((e=this.__pop_stack())!=t){if(!e){e=null;break}}if(this._stack.length<=0){this.enableKeyCheck()}return e}else{return null}},__pop_stack:function(t){if(this._stack.length>0){var e=this._stack.pop();e.WM_REG_INDEX=null;BX.onCustomEvent(e,"onWindowUnRegister",[t===true]);return e}else{return null}},clean:function(){while(this.__pop_stack(true)){}this._stack=null;this.disableKeyCheck()},Get:function(){if(this.currently_loaded){return this.currently_loaded}else{if(this._stack.length>0){return this._stack[this._stack.length-1]}else{return null}}},setStartZIndex:function(t){this._delta_start=t},restoreStartZIndex:function(){this._delta_start=1000},GetZIndex:function(){var t;return null!=(t=this._stack[this._stack.length-1])?parseInt(t.Get().style.zIndex)+this._delta:this._delta_start},__get_check_url:function(t){var e=t.indexOf("?");return e==-1?t:t.substring(0,e)},saveWindowSize:function(t,e){var i=this.__get_check_url(t);if(BX.userOptions){BX.userOptions.save(this.settings_category,"size_"+i,"width",e.width);BX.userOptions.save(this.settings_category,"size_"+i,"height",e.height)}this._runtime_resize[i]=e},saveWindowOptions:function(t,e){if(BX.userOptions){for(var i in e){if(e.hasOwnProperty(i)){BX.userOptions.save(this.settings_category,"options_"+t,i,e[i])}}}},getRuntimeWindowSize:function(t){return this._runtime_resize[this.__get_check_url(t)]},disableKeyCheck:function(){BX.unbind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},enableKeyCheck:function(){BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},__checkKeyPress:function(t){if(null==t){t=window.event}if(t.keyCode==27){var e=BX.WindowManager.Get();if(e&&!e.unclosable){e.Close()}}}};BX.garbage(BX.WindowManager.clean,BX.WindowManager);BX.CWindowButton=function(t){if(t.btn){this.btn=t.btn;this.parentWindow=t.parentWindow;if(/save|apply/i.test(this.btn.name)){BX.bind(this.btn,"click",BX.delegate(this.disableUntilError,this))}}else{this.title=t.title;this.hint=t.hint;this.id=t.id;this.name=t.name;this.className=t.className;this.action=t.action;this.onclick=t.onclick;if(t.Button&&BX.type.isFunction(t.Button)){this.Button=t.Button}this.btn=null}};BX.CWindowButton.prototype.disable=function(){if(this.btn){this.parentWindow.showWait(this.btn)}};BX.CWindowButton.prototype.enable=function(){if(this.btn){this.parentWindow.closeWait(this.btn)}};BX.CWindowButton.prototype.emulate=function(){if(this.btn&&this.btn.disabled){return}var t=this.action?BX.delegate(this.action,this):this.onclick?this.onclick:this.btn?this.btn.getAttribute("onclick"):"";if(t){setTimeout(t,50);if(this.btn&&/save|apply/i.test(this.btn.name)&&!this.action){this.disableUntilError()}}};BX.CWindowButton.prototype.Button=function(parentWindow){this.parentWindow=parentWindow;var btn={props:{type:"button",name:this.id?this.id:this.name,value:this.title?this.title:this.name,id:this.id}};if(this.hint){btn.props.title=this.hint}if(!!this.className){btn.props.className=this.className}if(this.action){btn.events={click:BX.delegate(this.action,this)}}else{if(this.onclick){if(BX.browser.IsIE()){btn.events={click:BX.delegate((function(){eval(this.onclick)}),this)}}else{btn.attrs={onclick:this.onclick}}}}this.btn=BX.create("INPUT",btn);return this.btn};BX.CWindowButton.prototype.disableUntilError=function(){this.disable();if(!this.__window_error_handler_set){BX.addCustomEvent(this.parentWindow,"onWindowError",BX.delegate(this.enable,this));this.__window_error_handler_set=true}};BX.CWindow=function(t,e){this.DIV=t||document.createElement("DIV");this.SETTINGS={resizable:false,min_height:0,min_width:0,top:0,left:0,draggable:false,drag_restrict:true,resize_restrict:true};this.ELEMENTS={draggable:[],resizer:[],close:[]};this.type=e=="float"?"float":"dialog";BX.adjust(this.DIV,{props:{className:"bx-core-window"},style:{zIndex:0,position:"absolute",display:"none",top:this.SETTINGS.top+"px",left:this.SETTINGS.left+"px",height:"100px",width:"100px"}});this.isOpen=false;BX.addCustomEvent(this,"onWindowRegister",BX.delegate(this.onRegister,this));BX.addCustomEvent(this,"onWindowUnRegister",BX.delegate(this.onUnRegister,this));this.MOUSEOVER=null;BX.bind(this.DIV,"mouseover",BX.delegate(this.__set_msover,this));BX.bind(this.DIV,"mouseout",BX.delegate(this.__unset_msover,this));BX.ready(BX.delegate((function(){document.body.appendChild(this.DIV);BX.ZIndexManager.register(this.DIV)}),this))};BX.CWindow.prototype.Get=function(){return this.DIV};BX.CWindow.prototype.visible=function(){return this.isOpen};BX.CWindow.prototype.Show=function(t){this.DIV.style.display="block";if(!t){BX.WindowManager.register(this);BX.onCustomEvent(this,"onWindowRegister")}BX.ZIndexManager.bringToFront(this.DIV)};BX.CWindow.prototype.Hide=function(){BX.WindowManager.unregister(this);this.DIV.style.display="none"};BX.CWindow.prototype.onRegister=function(){this.isOpen=true};BX.CWindow.prototype.onUnRegister=function(t){this.isOpen=false;if(t||this.PARAMS&&this.PARAMS.content_url){if(t){BX.onCustomEvent(this,"onWindowClose",[this,true])}if(this.DIV.parentNode){this.DIV.parentNode.removeChild(this.DIV)}}else{this.DIV.style.display="none"}};BX.CWindow.prototype.CloseDialog=BX.CWindow.prototype.Close=function(t){BX.onCustomEvent(this,"onBeforeWindowClose",[this]);if(t!==true){if(this.denyClose){return false}}BX.onCustomEvent(this,"onWindowClose",[this]);if(this.bExpanded){var e=BX.GetDocElement();BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this));e.style.overflow=this.__expand_settings.overflow}BX.WindowManager.unregister(this);return true};BX.CWindow.prototype.SetResize=function(t){t.style.cursor="se-resize";BX.bind(t,"mousedown",BX.proxy(this.__startResize,this));this.ELEMENTS.resizer.push(t);this.SETTINGS.resizable=true};BX.CWindow.prototype.SetExpand=function(t,e){e=e||"click";BX.bind(t,e,BX.proxy(this.__expand,this))};BX.CWindow.prototype.__expand_onresize=function(){var t=BX.GetWindowInnerSize();this.DIV.style.width=t.innerWidth+"px";this.DIV.style.height=t.innerHeight+"px";BX.onCustomEvent(this,"onWindowResize")};BX.CWindow.prototype.__expand=function(){var t=BX.GetDocElement();if(!this.bExpanded){var e=BX.GetWindowScrollPos(),i=BX.GetWindowInnerSize();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.DIV.style.width,height:this.DIV.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,overflow:BX.style(t,"overflow")};this.SETTINGS.resizable=false;this.SETTINGS.draggable=false;window.scrollTo(0,0);t.style.overflow="hidden";this.DIV.style.top="0px";this.DIV.style.left="0px";this.DIV.style.width=i.innerWidth+"px";this.DIV.style.height=i.innerHeight+"px";this.bExpanded=true;BX.onCustomEvent(this,"onWindowExpand");BX.onCustomEvent(this,"onWindowResize");BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}else{BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this));this.SETTINGS.resizable=this.__expand_settings.resizable;this.SETTINGS.draggable=this.__expand_settings.draggable;t.style.overflow=this.__expand_settings.overflow;this.DIV.style.top=this.__expand_settings.top;this.DIV.style.left=this.__expand_settings.left;this.DIV.style.width=this.__expand_settings.width;this.DIV.style.height=this.__expand_settings.height;window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop);this.bExpanded=false;BX.onCustomEvent(this,"onWindowNarrow");BX.onCustomEvent(this,"onWindowResize")}};BX.CWindow.prototype.Resize=function(t,e){var i=Math.max(t-this.pos.left+this.dx,this.SETTINGS.min_width);var s=Math.max(e-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var o=BX.GetWindowScrollSize();if(this.pos.left+i>o.scrollWidth-this.dw){i=o.scrollWidth-this.pos.left-this.dw}}this.DIV.style.width=i+"px";this.DIV.style.height=s+"px";BX.onCustomEvent(this,"onWindowResize")};BX.CWindow.prototype.__startResize=function(t){if(!this.SETTINGS.resizable){return false}if(!t){t=window.event}this.wndSize=BX.GetWindowScrollPos();this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth;this.pos=BX.pos(this.DIV);this.x=t.clientX+this.wndSize.scrollLeft;this.y=t.clientY+this.wndSize.scrollTop;this.dx=this.pos.left+this.pos.width-this.x;this.dy=this.pos.top+this.pos.height-this.y;this.dw=this.pos.width-parseInt(this.DIV.style.width);BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this));BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this));if(document.body.setCapture){document.body.setCapture()}document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False;e.style.MozUserSelect=this.DIV.style.MozUserSelect="none";e.style.cursor="se-resize";BX.onCustomEvent(this,"onWindowResizeStart");return true};BX.CWindow.prototype.__moveResize=function(t){if(!t){t=window.event}var e=BX.GetWindowScrollPos();var i=t.clientX+e.scrollLeft;var s=t.clientY+e.scrollTop;if(this.x==i&&this.y==s){return}this.Resize(i,s);this.x=i;this.y=s};BX.CWindow.prototype.__stopResize=function(){if(document.body.releaseCapture){document.body.releaseCapture()}BX.unbind(document,"mousemove",BX.proxy(this.__moveResize,this));BX.unbind(document,"mouseup",BX.proxy(this.__stopResize,this));document.onmousedown=null;var t=document.body;t.ondrag=t.onselectstart=null;t.style.MozUserSelect=this.DIV.style.MozUserSelect="";t.style.cursor="";BX.onCustomEvent(this,"onWindowResizeFinished")};BX.CWindow.prototype.SetClose=function(t){BX.bind(t,"click",BX.proxy(this.Close,this));this.ELEMENTS.close.push(t)};BX.CWindow.prototype.SetDraggable=function(t){BX.bind(t,"mousedown",BX.proxy(this.__startDrag,this));t.style.cursor="move";this.ELEMENTS.draggable.push(t);this.SETTINGS.draggable=true};BX.CWindow.prototype.Move=function(t,e){var i=1;var s=parseInt(this.DIV.style.left)+t;var o=parseInt(this.DIV.style.top)+e;if(this.SETTINGS.drag_restrict){if(s<0){s=0}var n=BX.GetWindowScrollSize();var r=this.DIV.offsetWidth;var h=this.DIV.offsetHeight;if(s>n.scrollWidth-r-i){s=n.scrollWidth-r-i}var a=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight,n.scrollHeight);if(o>a-h-i){o=a-h-i}if(o<0){o=0}}this.DIV.style.left=s+"px";this.DIV.style.top=o+"px"};BX.CWindow.prototype.__startDrag=function(t){if(!this.SETTINGS.draggable){return false}if(!t){t=window.event}this.x=t.clientX+document.body.scrollLeft;this.y=t.clientY+document.body.scrollTop;this.__bWasDragged=false;BX.bind(document,"mousemove",BX.proxy(this.__moveDrag,this));BX.bind(document,"mouseup",BX.proxy(this.__stopDrag,this));if(document.body.setCapture){document.body.setCapture()}document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False;e.style.MozUserSelect=this.DIV.style.MozUserSelect="none";e.style.cursor="move";return BX.PreventDefault(t)};BX.CWindow.prototype.__moveDrag=function(t){if(!t){t=window.event}var e=t.clientX+document.body.scrollLeft;var i=t.clientY+document.body.scrollTop;if(this.x==e&&this.y==i){return}this.Move(e-this.x,i-this.y);this.x=e;this.y=i;if(!this.__bWasDragged){BX.onCustomEvent(this,"onWindowDragStart");this.__bWasDragged=true;BX.bind(BX.proxy_context,"click",BX.PreventDefault)}BX.onCustomEvent(this,"onWindowDrag")};BX.CWindow.prototype.__stopDrag=function(t){if(document.body.releaseCapture){document.body.releaseCapture()}BX.unbind(document,"mousemove",BX.proxy(this.__moveDrag,this));BX.unbind(document,"mouseup",BX.proxy(this.__stopDrag,this));document.onmousedown=null;var e=document.body;e.ondrag=e.onselectstart=null;e.style.MozUserSelect=this.DIV.style.MozUserSelect="";e.style.cursor="";if(this.__bWasDragged){BX.onCustomEvent(this,"onWindowDragFinished");var i=BX.proxy_context;setTimeout((function(){BX.unbind(i,"click",BX.PreventDefault)}),100);this.__bWasDragged=false}return BX.PreventDefault(t)};BX.CWindow.prototype.DenyClose=function(){this.denyClose=true};BX.CWindow.prototype.AllowClose=function(){this.denyClose=false};BX.CWindow.prototype.ShowError=function(t){BX.onCustomEvent(this,"onWindowError",[t]);if(this._wait){BX.closeWait(this._wait)}window.alert(t)};BX.CWindow.prototype.__set_msover=function(){this.MOUSEOVER=true};BX.CWindow.prototype.__unset_msover=function(){this.MOUSEOVER=false};BX.CWindowDialog=function(){var t=arguments;t[1]="dialog";BX.CWindowDialog.superclass.constructor.apply(this,t);this.DIV.style.top="10px";this.OVERLAY=null};BX.extend(BX.CWindowDialog,BX.CWindow);BX.CWindowDialog.prototype.__resizeOverlay=function(){var t=BX.GetWindowScrollSize();this.OVERLAY.style.width=t.scrollWidth+"px"};BX.CWindowDialog.prototype.CreateOverlay=function(t){if(null==this.OVERLAY){var e=BX.GetWindowScrollSize();var i=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight,e.scrollHeight);this.OVERLAY=document.body.appendChild(BX.create("DIV",{style:{position:"absolute",top:"0px",left:"0px",zIndex:t||parseInt(this.DIV.style.zIndex)-2,width:e.scrollWidth+"px",height:i+"px"}}));var s=BX.ZIndexManager.getComponent(this.DIV);if(s){s.setOverlay(this.OVERLAY)}}return this.OVERLAY};BX.CWindowDialog.prototype.Show=function(){BX.CWindowDialog.superclass.Show.apply(this,arguments);this.CreateOverlay();this.OVERLAY.style.display="block";BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this));BX.bind(window,"resize",BX.proxy(this.__resizeOverlay,this))};BX.CWindowDialog.prototype.onUnRegister=function(t){BX.CWindowDialog.superclass.onUnRegister.apply(this,arguments);if(this.clean){if(this.OVERLAY.parentNode){this.OVERLAY.parentNode.removeChild(this.OVERLAY)}}else{this.OVERLAY.style.display="none"}BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this))};BX.CDialog=function(t){BX.CDialog.superclass.constructor.apply(this);this._sender="core_window_cdialog";this.PARAMS=t||{};for(var e in this.defaultParams){if(typeof this.PARAMS[e]=="undefined"){this.PARAMS[e]=this.defaultParams[e]}}this.PARAMS.width=!isNaN(parseInt(this.PARAMS.width))?this.PARAMS.width:this.defaultParams.width;this.PARAMS.height=!isNaN(parseInt(this.PARAMS.height))?this.PARAMS.height:this.defaultParams.height;if(this.PARAMS.resize_id||this.PARAMS.content_url){var i=BX.WindowManager.getRuntimeWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url);if(i){this.PARAMS.width=i.width;this.PARAMS.height=i.height}}BX.addClass(this.DIV,"bx-core-adm-dialog");this.DIV.id="bx-admin-prefix";this.PARTS={};this.DIV.style.height=null;this.DIV.style.width=null;this.PARTS.TITLEBAR=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head"}}));this.PARTS.TITLE_CONTAINER=this.PARTS.TITLEBAR.appendChild(BX.create("SPAN",{props:{className:"bx-core-adm-dialog-head-inner"},text:this.PARAMS.title}));this.PARTS.TITLEBAR_ICONS=this.PARTS.TITLEBAR.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-icons"},children:this.PARAMS.resizable?[BX.create("SPAN",{props:{className:"bx-core-adm-icon-expand",title:BX.message("JS_CORE_WINDOW_EXPAND")}}),BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]:[BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]}));this.PARTS.CONTENT=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap adm-workarea"}}));this.PARTS.CONTENT_DATA=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content"},style:{height:this.PARAMS.height+"px",width:this.PARAMS.width+"px"}}));this.PARTS.HEAD=this.PARTS.CONTENT_DATA.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-block"+(this.PARAMS.icon?" "+this.PARAMS.icon:"")}}));this.SetHead(this.PARAMS.head);this.SetContent(this.PARAMS.content);this.SetTitle(this.PARAMS.title);this.SetClose(this.PARTS.TITLEBAR_ICONS.lastChild);if(this.PARAMS.resizable){this.SetExpand(this.PARTS.TITLEBAR_ICONS.firstChild);this.SetExpand(this.PARTS.TITLEBAR,"dblclick");BX.addCustomEvent(this,"onWindowExpand",BX.proxy(this.__onexpand,this));BX.addCustomEvent(this,"onWindowNarrow",BX.proxy(this.__onexpand,this))}this.PARTS.FOOT=this.PARTS.BUTTONS_CONTAINER=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-buttons"},children:this.ShowButtons()}));if(this.PARAMS.draggable){this.SetDraggable(this.PARTS.TITLEBAR)}if(this.PARAMS.resizable){this.PARTS.RESIZER=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-resizer"}}));this.SetResize(this.PARTS.RESIZER);this.SETTINGS.min_width=this.PARAMS.min_width;this.SETTINGS.min_height=this.PARAMS.min_height}this.auth_callback=BX.delegate((function(){this.PARAMS.content="";this.hideNotify();this.Show()}),this)};BX.extend(BX.CDialog,BX.CWindowDialog);BX.CDialog.prototype.defaultParams={width:700,height:400,min_width:500,min_height:300,resizable:true,draggable:true,title:"",icon:""};BX.CDialog.prototype.showWait=function(t){if(BX.type.isElementNode(t)&&(t.type=="button"||t.type=="submit")){BX.defer((function(){t.disabled=true}))();var e=BX.hasClass(t,"adm-btn-save")||BX.hasClass(t,"adm-btn-save"),i=BX.pos(t,true);t.bxwaiter=this.PARTS.FOOT.appendChild(BX.create("DIV",{props:{className:"adm-btn-load-img"+(e?"-green":"")},style:{top:parseInt((i.bottom+i.top)/2-10)+"px",left:parseInt((i.right+i.left)/2-10)+"px"}}));BX.addClass(t,"adm-btn-load");this.lastWaitElement=t;return t.bxwaiter}return null};BX.CDialog.prototype.closeWait=function(t){t=t||this.lastWaitElement;if(BX.type.isElementNode(t)){if(t.bxwaiter){if(t.bxwaiter.parentNode){t.bxwaiter.parentNode.removeChild(t.bxwaiter)}t.bxwaiter=null}t.disabled=false;BX.removeClass(t,"adm-btn-load");if(this.lastWaitElement==t){this.lastWaitElement=null}}};BX.CDialog.prototype.Authorize=function(t){this.bSkipReplaceContent=true;this.ShowError(BX.message("JSADM_AUTH_REQ"));BX.onCustomEvent(this,"onWindowError",[]);BX.closeWait();new BX.CAuthDialog({content_url:this.PARAMS.content_url,auth_result:t,callback:BX.delegate((function(){if(this.auth_callback){this.auth_callback()}}),this)}).Show()};BX.CDialog.prototype.ShowError=function(t){BX.onCustomEvent(this,"onWindowError",[t]);this.closeWait();if(this._wait){BX.closeWait(this._wait)}this.Notify(t,true)};BX.CDialog.prototype.__expandGetSize=function(){var t=BX.GetDocElement();t.style.overflow="hidden";var e=BX.GetWindowInnerSize();t.scrollTop=0;this.DIV.style.top="-"+this.dxShadow+"px";this.DIV.style.left="-"+this.dxShadow+"px";return{width:e.innerWidth-parseInt(BX.style(this.PARTS.CONTENT,"padding-right"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-left"))+this.dxShadow,height:e.innerHeight-this.PARTS.TITLEBAR.offsetHeight-this.PARTS.FOOT.offsetHeight-parseInt(BX.style(this.PARTS.CONTENT,"padding-top"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-bottom"))+this.dxShadow}};BX.CDialog.prototype.__expand=function(){var t=BX.GetDocElement();this.dxShadow=2;if(!this.bExpanded){var e=BX.GetWindowScrollPos();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.PARTS.CONTENT_DATA.style.width,height:this.PARTS.CONTENT_DATA.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,overflow:BX.style(t,"overflow")};this.SETTINGS.resizable=false;this.SETTINGS.draggable=false;var i=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=i.width+"px";this.PARTS.CONTENT_DATA.style.height=i.height+"px";window.scrollTo(0,0);t.style.overflow="hidden";this.bExpanded=true;BX.onCustomEvent(this,"onWindowExpand");BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[{width:i.width,height:i.height}]);BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}else{BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this));this.SETTINGS.resizable=this.__expand_settings.resizable;this.SETTINGS.draggable=this.__expand_settings.draggable;t.style.overflow=this.__expand_settings.overflow;this.DIV.style.top=this.__expand_settings.top;this.DIV.style.left=this.__expand_settings.left;this.PARTS.CONTENT_DATA.style.width=this.__expand_settings.width;this.PARTS.CONTENT_DATA.style.height=this.__expand_settings.height;window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop);this.bExpanded=false;BX.onCustomEvent(this,"onWindowNarrow");BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[{width:parseInt(this.__expand_settings.width),height:parseInt(this.__expand_settings.height)}])}};BX.CDialog.prototype.__expand_onresize=function(){var t=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=t.width+"px";this.PARTS.CONTENT_DATA.style.height=t.height+"px";BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[t])};BX.CDialog.prototype.__onexpand=function(){var t=this.PARTS.TITLEBAR_ICONS.firstChild;t.className=BX.toggle(t.className,["bx-core-adm-icon-expand","bx-core-adm-icon-narrow"]);t.title=BX.toggle(t.title,[BX.message("JS_CORE_WINDOW_EXPAND"),BX.message("JS_CORE_WINDOW_NARROW")]);if(this.PARTS.RESIZER){this.PARTS.RESIZER.style.display=this.bExpanded?"none":"block"}};BX.CDialog.prototype.__startResize=function(t){if(!this.SETTINGS.resizable){return false}if(!t){t=window.event}this.wndSize=BX.GetWindowScrollPos();this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth;this.pos=BX.pos(this.PARTS.CONTENT_DATA);this.x=t.clientX+this.wndSize.scrollLeft;this.y=t.clientY+this.wndSize.scrollTop;this.dx=this.pos.left+this.pos.width-this.x;this.dy=this.pos.top+this.pos.height-this.y;this.dw=this.pos.width-parseInt(this.PARTS.CONTENT_DATA.style.width)+parseInt(BX.style(this.PARTS.CONTENT,"padding-right"));BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this));BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this));if(document.body.setCapture){document.body.setCapture()}document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False;e.style.MozUserSelect=this.DIV.style.MozUserSelect="none";e.style.cursor="se-resize";BX.onCustomEvent(this,"onWindowResizeStart");return true};BX.CDialog.prototype.Resize=function(t,e){var i=Math.max(t-this.pos.left+this.dx,this.SETTINGS.min_width);var s=Math.max(e-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var o=BX.GetWindowScrollSize();if(this.pos.left+i>o.scrollWidth-this.dw){i=o.scrollWidth-this.pos.left-this.dw}}this.PARTS.CONTENT_DATA.style.width=i+"px";this.PARTS.CONTENT_DATA.style.height=s+"px";BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[{height:s,width:i}])};BX.CDialog.prototype.SetSize=function(t){this.PARTS.CONTENT_DATA.style.width=t.width+"px";this.PARTS.CONTENT_DATA.style.height=t.height+"px";BX.onCustomEvent(this,"onWindowResize");BX.onCustomEvent(this,"onWindowResizeExt",[t])};BX.CDialog.prototype.GetParameters=function(t){var e=this.GetForm();if(!e){return""}var i,s="";var o=e.elements.length;var n="";for(i=0;i<o;i++){if(s!=""){n="&"}var r=e.elements[i];if(r.disabled){continue}switch(r.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":if(null==t&&r.name.substr(r.name.length-4)=="_alt"&&e.elements[r.name.substr(0,r.name.length-4)]){break}s+=n+r.name+"="+BX.util.urlencode(r.value);break;case"radio":if(r.checked){s+=n+r.name+"="+BX.util.urlencode(r.value)}break;case"checkbox":s+=n+r.name+"="+BX.util.urlencode(r.checked?"Y":"N");break;case"select-one":var h="";if(null==t&&e.elements[r.name+"_alt"]&&r.selectedIndex==0){h=e.elements[r.name+"_alt"].value}else{h=r.value}s+=n+r.name+"="+BX.util.urlencode(h);break;case"select-multiple":var a,l=false;var d=r.options.length;for(a=0;a<d;a++){if(r.options[a].selected){s+=n+r.name+"="+BX.util.urlencode(r.options[a].value);l=true}}if(!l){s+=n+r.name+"="}break;default:break}}return s};BX.CDialog.prototype.PostParameters=function(t){var e=this.PARAMS.content_url;if(null==t){t=""}t+=(t==""?"":"&")+"bxsender="+this._sender;var i=e.indexOf("?");if(i==-1){e+="?"+t}else{e=e.substring(0,i)+"?"+t+"&"+e.substring(i+1)}BX.showWait();this.auth_callback=BX.delegate((function(){this.hideNotify();this.PostParameters(t)}),this);BX.ajax.Setup({skipAuthCheck:true},true);BX.ajax.post(e,this.GetParameters(),BX.delegate((function(t){BX.closeWait();if(!this.bSkipReplaceContent){this.ClearButtons();this.SetContent(t);this.Show(true)}this.bSkipReplaceContent=false}),this))};BX.CDialog.prototype.Submit=function(t,e){var i=this.GetForm();if(i){i.onsubmit=null;i.method="POST";if(!i.action||e){e=e||this.PARAMS.content_url;if(null!=t){var s=e.indexOf("?");if(s==-1){e+="?"+t}else{e=e.substring(0,s)+"?"+t+"&"+e.substring(s+1)}}i.action=e}if(!i._bxsender){i._bxsender=i.appendChild(BX.create("INPUT",{attrs:{type:"hidden",name:"bxsender",value:this._sender}}))}this._wait=BX.showWait();this.auth_callback=BX.delegate((function(){this.hideNotify();this.Submit(t)}),this);BX.ajax.submit(i,BX.delegate((function(){this.closeWait()}),this))}else{window.alert("no form registered!")}};BX.CDialog.prototype.GetForm=function(){if(null==this.__form){var t=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__form=t[0]?t[0]:null}return this.__form};BX.CDialog.prototype.GetRealForm=function(){if(null==this.__rform){var t=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__rform=t[1]?t[1]:t[0]?t[0]:null}return this.__rform};BX.CDialog.prototype._checkButton=function(t){var e=["btnSave","btnCancel","btnClose"];for(var i=0;i<e.length;i++){if(this[e[i]]&&t==this[e[i]]){return e[i]}}return false};BX.CDialog.prototype.ShowButtons=function(){var t=[];if(this.PARAMS.buttons){if(this.PARAMS.buttons.title){this.PARAMS.buttons=[this.PARAMS.buttons]}for(var e=0,i=this.PARAMS.buttons.length;e<i;e++){if(BX.type.isNotEmptyString(this.PARAMS.buttons[e])){t.push(this.PARAMS.buttons[e])}else{if(BX.type.isElementNode(this.PARAMS.buttons[e])){t.push(this.PARAMS.buttons[e])}else{if(this.PARAMS.buttons[e]){if(!BX.is_subclass_of(this.PARAMS.buttons[e],BX.CWindowButton)){var s=this._checkButton(this.PARAMS.buttons[e]);this.PARAMS.buttons[e]=new BX.CWindowButton(this.PARAMS.buttons[e]);if(s){this[s]=this.PARAMS.buttons[e]}}t.push(this.PARAMS.buttons[e].Button(this))}}}}}return t};BX.CDialog.prototype.setAutosave=function(){if(!this.bSetAutosaveDelay){this.bSetAutosaveDelay=true;setTimeout(BX.proxy(this.setAutosave,this),10)}};BX.CDialog.prototype.SetTitle=function(t){this.PARAMS.title=t;BX.cleanNode(this.PARTS.TITLE_CONTAINER).appendChild(document.createTextNode(this.PARAMS.title))};BX.CDialog.prototype.SetHead=function(t){this.PARAMS.head=BX.util.trim(t);this.PARTS.HEAD.innerHTML=this.PARAMS.head||"&nbsp;";this.PARTS.HEAD.style.display=this.PARAMS.head?"block":"none";this.adjustSize()};BX.CDialog.prototype.Notify=function(t,e,i){if(!this.PARTS.NOTIFY){this.PARTS.NOTIFY=this.DIV.insertBefore(BX.create("DIV",{props:{className:"adm-warning-block"},children:[BX.create("SPAN",{props:{className:"adm-warning-text"}}),BX.create("SPAN",{props:{className:"adm-warning-icon"}}),BX.create("SPAN",{props:{className:"adm-warning-close"},events:{click:BX.proxy(this.hideNotify,this)}})]}),this.DIV.firstChild)}if(e){BX.addClass(this.PARTS.NOTIFY,"adm-warning-block-red")}else{BX.removeClass(this.PARTS.NOTIFY,"adm-warning-block-red")}if(i!==true){t=BX.util.htmlspecialchars(t)}this.PARTS.NOTIFY.firstChild.innerHTML=t||"&nbsp;";this.PARTS.NOTIFY.firstChild.style.width=this.PARAMS.width-50+"px";BX.removeClass(this.PARTS.NOTIFY,"adm-warning-animate")};BX.CDialog.prototype.hideNotify=function(){BX.addClass(this.PARTS.NOTIFY,"adm-warning-animate")};BX.CDialog.prototype.__adjustHeadToIcon=function(){if(!this.PARTS.HEAD.offsetHeight){setTimeout(BX.delegate(this.__adjustHeadToIcon,this),50)}else{if(this.icon_image&&this.icon_image.height&&this.icon_image.height>this.PARTS.HEAD.offsetHeight-5){this.PARTS.HEAD.style.height=this.icon_image.height+5+"px";this.adjustSize()}this.icon_image.onload=null;this.icon_image=null}};BX.CDialog.prototype.SetIcon=function(t){if(this.PARAMS.icon!=t){if(this.PARAMS.icon){BX.removeClass(this.PARTS.HEAD,this.PARAMS.icon)}this.PARAMS.icon=t;if(this.PARAMS.icon){BX.addClass(this.PARTS.HEAD,this.PARAMS.icon);var e=BX.style(this.PARTS.HEAD,"background-image")||BX.style(this.PARTS.HEAD,"backgroundImage");if(BX.type.isNotEmptyString(e)&&e!="none"){var i=e.match(new RegExp("url\\s*\\(\\s*('|\"|)(.+?)(\\1)\\s*\\)"));if(i){e=i[2];if(BX.type.isNotEmptyString(e)){this.icon_image=new Image;this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this);this.icon_image.src=e}}}}}this.adjustSize()};BX.CDialog.prototype.SetIconFile=function(t){this.icon_image=new Image;this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this);this.icon_image.src=t;BX.adjust(this.PARTS.HEAD,{style:{backgroundImage:"url("+t+")",backgroundPosition:"right 9px"}});this.adjustSize()};BX.CDialog.prototype.SetButtons=function(t){if(BX.type.isString(t)){if(t.length>0){this.PARTS.BUTTONS_CONTAINER.innerHTML+=t;var e=this.PARTS.BUTTONS_CONTAINER.getElementsByTagName("INPUT");if(e.length>0){this.PARAMS.buttons=[];for(var i=0;i<e.length;i++){this.PARAMS.buttons.push(new BX.CWindowButton({btn:e[i],parentWindow:this}))}}}}else{this.PARAMS.buttons=t;BX.adjust(this.PARTS.BUTTONS_CONTAINER,{children:this.ShowButtons()})}this.adjustSize()};BX.CDialog.prototype.ClearButtons=function(){BX.cleanNode(this.PARTS.BUTTONS_CONTAINER);this.adjustSize()};BX.CDialog.prototype.SetContent=function(t){this.__form=null;if(BX.type.isElementNode(t)){if(t.parentNode){t.parentNode.removeChild(t)}}else{if(BX.type.isString(t)){t=BX.create("DIV",{html:t})}}this.PARAMS.content=t;BX.cleanNode(this.PARTS.CONTENT_DATA);BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARTS.HEAD,BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap-inner"},children:[this.PARAMS.content]})]});if(this.PARAMS.content_url&&this.GetForm()){this.__form.submitbtn=this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}}));this.__form.onsubmit=BX.delegate(this.__submit,this)}};BX.CDialog.prototype.__submit=function(t){for(var e=0,i=this.PARAMS.buttons.length;e<i;e++){if(this.PARAMS.buttons[e]&&(this.PARAMS.buttons[e].name&&/save|apply/i.test(this.PARAMS.buttons[e].name)||this.PARAMS.buttons[e].btn&&this.PARAMS.buttons[e].btn.name&&/save|apply/i.test(this.PARAMS.buttons[e].btn.name))){this.PARAMS.buttons[e].emulate();break}}return BX.PreventDefault(t)};BX.CDialog.prototype.SwapContent=function(t){t=BX(t);BX.cleanNode(this.PARTS.CONTENT_DATA);t.parentNode.removeChild(t);this.PARTS.CONTENT_DATA.appendChild(t);t.style.display="block";this.SetContent(t.innerHTML)};BX.CDialog.prototype.adjustSize=function(){};BX.CDialog.prototype.__adjustSize=function(){};BX.CDialog.prototype.adjustSizeEx=function(){BX.defer(this.__adjustSizeEx,this)()};BX.CDialog.prototype.__adjustSizeEx=function(){var t=this.PARTS.CONTENT_DATA.firstChild,e=0,i,s;while(t){if(BX.type.isElementNode(t)){i=parseInt(BX.style(t,"margin-top"),10);if(isNaN(i)){i=0}s=parseInt(BX.style(t,"margin-bottom"),10);if(isNaN(s)){s=0}e+=t.offsetHeight+i+s}t=BX.nextSibling(t)}if(e){this.PARTS.CONTENT_DATA.style.height=e+"px"}};BX.CDialog.prototype.__onResizeFinished=function(){BX.WindowManager.saveWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url,{height:parseInt(this.PARTS.CONTENT_DATA.style.height),width:parseInt(this.PARTS.CONTENT_DATA.style.width)})};BX.CDialog.prototype.Show=function(t){if(!this.PARAMS.content&&this.PARAMS.content_url&&BX.ajax&&!t){var e=BX.showWait();BX.WindowManager.currently_loaded=this;this.CreateOverlay();this.OVERLAY.style.display="block";this.OVERLAY.className="bx-core-dialog-overlay";var i="",s="GET";if(this.PARAMS.content_post){i=this.PARAMS.content_post;s="POST"}var o=this.PARAMS.content_url+(this.PARAMS.content_url.indexOf("?")<0?"?":"&")+"bxsender="+this._sender;this.auth_callback=BX.delegate((function(){this.PARAMS.content="";this.hideNotify();this.Show()}),this);BX.ajax({method:s,dataType:"html",url:o,data:i,skipAuthCheck:true,onsuccess:BX.delegate((function(t){BX.closeWait(null,e);this.SetContent(t||"&nbsp;");this.Show()}),this)})}else{BX.WindowManager.currently_loaded=null;BX.CDialog.superclass.Show.apply(this,arguments);this.adjustPos();this.OVERLAY.className="bx-core-dialog-overlay";this.__adjustSize();BX.removeCustomEvent(this,"onWindowResize",BX.proxy(this.__adjustSize,this));BX.addCustomEvent(this,"onWindowResize",BX.proxy(this.__adjustSize,this));if(this.PARAMS.resizable&&(this.PARAMS.content_url||this.PARAMS.resize_id)){BX.removeCustomEvent(this,"onWindowResizeFinished",BX.proxy(this.__onResizeFinished,this));BX.addCustomEvent(this,"onWindowResizeFinished",BX.proxy(this.__onResizeFinished,this))}}};BX.CDialog.prototype.GetInnerPos=function(){return{width:parseInt(this.PARTS.CONTENT_DATA.style.width),height:parseInt(this.PARTS.CONTENT_DATA.style.height)}};BX.CDialog.prototype.adjustPos=function(){if(!this.bExpanded){var t=window;var e=BX.PageObject.getRootWindow();if(e.BX.SidePanel&&e.BX.SidePanel.Instance&&e.BX.SidePanel.Instance.getTopSlider()){t=e.BX.SidePanel.Instance.getTopSlider().getWindow()}var i=t.BX.GetWindowInnerSize();var s=t.BX.GetWindowScrollPos();var o={left:parseInt(s.scrollLeft+i.innerWidth/2-parseInt(this.DIV.offsetWidth)/2)+"px",top:Math.max(parseInt(s.scrollTop+i.innerHeight/2-parseInt(this.DIV.offsetHeight)/2),0)+"px"};BX.adjust(this.DIV,{style:o})}};BX.CDialog.prototype.GetContent=function(){return this.PARTS.CONTENT_DATA};BX.CDialog.prototype.btnSave=BX.CDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:BX.browser.IsIE()&&BX.browser.IsDoctype()&&!BX.browser.IsIE10()?"":"adm-btn-save",action:function(){this.disableUntilError();this.parentWindow.PostParameters()}};BX.CDialog.prototype.btnCancel=BX.CDialog.btnCancel={title:BX.message("JS_CORE_WINDOW_CANCEL"),id:"cancel",name:"cancel",action:function(){this.parentWindow.Close()}};BX.CDialog.prototype.btnClose=BX.CDialog.btnClose={title:BX.message("JS_CORE_WINDOW_CLOSE"),id:"close",name:"close",action:function(){this.parentWindow.Close()}};BX.CAdminDialog=function(t){BX.CAdminDialog.superclass.constructor.apply(this,arguments);this._sender="core_window_cadmindialog";BX.addClass(this.DIV,"bx-core-adm-admin-dialog");this.PARTS.CONTENT.insertBefore(this.PARTS.HEAD,this.PARTS.CONTENT.firstChild);this.PARTS.HEAD.className="bx-core-adm-dialog-tabs"};BX.extend(BX.CAdminDialog,BX.CDialog);BX.CAdminDialog.prototype.SetHead=function(){BX.CAdminDialog.superclass.SetHead.apply(this,arguments);if(this.PARTS.HEAD.firstChild&&BX.type.isElementNode(this.PARTS.HEAD.firstChild)){var t=this.PARTS.HEAD.firstChild,e=0,i=0,s=0;while(t){if(BX.type.isElementNode(t)){i=parseInt(BX.style(t,"margin-left"),10);if(isNaN(i)){i=0}s=parseInt(BX.style(t,"margin-right"),10);if(isNaN(s)){s=0}e+=t.offsetWidth+i+s}t=BX.nextSibling(t)}this.SETTINGS.min_width=Math.max(e,this.SETTINGS.min_width)-2;if(this.PARAMS.width<this.SETTINGS.min_width){BX.adjust(this.PARTS.CONTENT_DATA,{style:{width:this.SETTINGS.min_width+"px"}})}}};BX.CAdminDialog.prototype.SetContent=function(t){this.__form=null;if(BX.type.isElementNode(t)){if(t.parentNode){t.parentNode.removeChild(t)}}this.PARAMS.content=t;BX.cleanNode(this.PARTS.CONTENT_DATA);BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARAMS.content||"&nbsp;"]});if(this.PARAMS.content_url&&this.GetForm()){this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}}));this.__form.onsubmit=BX.delegate(this.__submit,this)}};BX.CAdminDialog.prototype.__expandGetSize=function(){var t=BX.CAdminDialog.superclass.__expandGetSize.apply(this,arguments);t.width-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-right"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-left"));t.height-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-top"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-bottom"));t.height-=this.PARTS.HEAD.offsetHeight;return t};BX.CAdminDialog.prototype.Submit=function(){var t=this.GetForm();if(t&&!t.bxpublic&&!/bxpublic=/.test(t.action)){t.appendChild(BX.create("INPUT",{props:{type:"hidden",name:"bxpublic",value:"Y"}}))}return BX.CAdminDialog.superclass.Submit.apply(this,arguments)};BX.CAdminDialog.prototype.btnSave=BX.CAdminDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError();this.parentWindow.Submit()}};BX.CAdminDialog.btnCancel=BX.CAdminDialog.superclass.btnCancel;BX.CAdminDialog.btnClose=BX.CAdminDialog.superclass.btnClose;BX.CDebugDialog=function(t){BX.CDebugDialog.superclass.constructor.apply(this,arguments)};BX.extend(BX.CDebugDialog,BX.CDialog);BX.CDebugDialog.prototype.ShowDetails=function(t){var e=BX(t);if(e){if(this.div_detail_current){this.div_detail_current.style.display="none"}e.style.display="block";this.div_detail_current=e}};BX.CDebugDialog.prototype.SetContent=function(t){if(!t){return}var e=t.split("#DIVIDER#");if(e.length>1){this.PARAMS.content=e[1];this.PARTS.CONTENT_DATA.style.overflow="hidden";BX.CDebugDialog.superclass.SetContent.apply(this,[e[1]]);this.PARTS.CONTENT_INNER=this.PARTS.CONTENT_DATA.firstChild.nextSibling;this.PARTS.CONTENT_TOP=this.PARTS.CONTENT_DATA.insertBefore(BX.create("DIV",{props:{className:"bx-debug-content-top"},html:e[0]}),this.PARTS.CONTENT_INNER);this.PARTS.CONTENT_INNER.style.overflow="auto"}else{BX.CDebugDialog.superclass.SetContent.apply(this,arguments)}};BX.CDebugDialog.prototype.__adjustSize=function(){BX.CDebugDialog.superclass.__adjustSize.apply(this,arguments);if(this.PARTS.CONTENT_TOP){var t=this.PARTS.CONTENT_DATA.offsetHeight-this.PARTS.HEAD.offsetHeight-this.PARTS.CONTENT_TOP.offsetHeight-38;if(t>0){this.PARTS.CONTENT_INNER.style.height=t+"px"}}};BX.CEditorDialog=function(t){BX.CEditorDialog.superclass.constructor.apply(this,arguments);BX.removeClass(this.PARTS.CONTENT,"bx-core-adm-dialog-content-wrap");BX.removeClass(this.PARTS.CONTENT_DATA,"bx-core-adm-dialog-content");BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner");BX.removeClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-adm-dialog-buttons");BX.addClass(this.PARTS.CONTENT,"bx-core-editor-dialog-content-wrap");BX.addClass(this.PARTS.CONTENT_DATA,"bx-core-editor-dialog-content");BX.addClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-editor-dialog-buttons")};BX.extend(BX.CEditorDialog,BX.CDialog);BX.CEditorDialog.prototype.SetContent=function(){BX.CEditorDialog.superclass.SetContent.apply(this,arguments);BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner")};BX.CWizardDialog=function(t){BX.CWizardDialog.superclass.constructor.apply(this,arguments);BX.removeClass(this.PARTS.CONTENT,"bx-core-adm-dialog-content-wrap");BX.removeClass(this.PARTS.CONTENT_DATA,"bx-core-adm-dialog-content");BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner");BX.removeClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-adm-dialog-buttons");BX.addClass(this.PARTS.CONTENT,"bx-core-wizard-dialog-content-wrap")};BX.extend(BX.CWizardDialog,BX.CDialog);BX.CAuthDialog=function(t){t.resizable=false;t.width=350;t.height=200;t.buttons=[this.btnSave];BX.CAuthDialog.superclass.constructor.apply(this,arguments);this._sender="core_window_cauthdialog";BX.addClass(this.DIV,"bx-core-auth-dialog");BX.AUTHAGENT=this};BX.extend(BX.CAuthDialog,BX.CDialog);BX.CAuthDialog.prototype.btnSave=BX.CAuthDialog.btnSave={title:BX.message("JS_CORE_WINDOW_AUTH"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError();this.parentWindow.Submit("",this.parentWindow.PARAMS.content_url)}};BX.CAuthDialog.prototype.SetError=function(t){BX.closeWait();if(!!t){this.ShowError(t.MESSAGE||t)}};BX.CAuthDialog.prototype.setAuthResult=function(t){BX.closeWait();if(t===false){this.Close();if(this.PARAMS.callback){this.PARAMS.callback()}}else{this.SetError(t)}};BX.CWindowFloat=function(t){BX.CWindowFloat.superclass.constructor.apply(this,[t,"float"]);this.SETTINGS.resizable=false};BX.extend(BX.CWindowFloat,BX.CWindow);BX.CWindowFloat.prototype.adjustPos=function(){if(this.PARAMS.parent){this.adjustToNode()}else{if(this.PARAMS.x&&this.PARAMS.y){this.adjustToPos([this.PARAMS.x,this.PARAMS.y])}}};BX.CWindowFloat.prototype.adjustToPos=function(t){this.DIV.style.left=parseInt(t[0])+"px";this.DIV.style.top=parseInt(t[1])+"px"};BX.CWindowFloat.prototype.adjustToNodeGetPos=function(){return BX.pos(this.PARAMS.parent)};BX.CWindowFloat.prototype.adjustToNode=function(t){t=t||this.PARAMS.parent;this.PARAMS.parent=BX(t);if(this.PARAMS.parent){var e=this.adjustToNodeGetPos();this.DIV.style.top=e.top+"px";this.DIV.style.left=e.left+"px";this.PARAMS.parent.OPENER=this}};BX.CWindowFloat.prototype.Show=function(){this.adjustToPos([-1000,-1000]);BX.CWindowFloat.superclass.Show.apply(this,arguments);this.adjustPos()};BX.COpener=function(t){this.PARAMS=t||{};this.MENU=t.MENU||[];this.DIV=t.DIV;this.ATTACH=t.ATTACH||t.DIV;this.ATTACH_MODE=t.ATTACH_MODE||"bottom";this.ACTIVE_CLASS=t.ACTIVE_CLASS||"";this.PUBLIC_FRAME=t.PUBLIC_FRAME||0;this.LEVEL=t.LEVEL||0;this.CLOSE_ON_CLICK=typeof t.CLOSE_ON_CLICK!="undefined"?!!t.CLOSE_ON_CLICK:true;this.ADJUST_ON_CLICK=typeof t.ADJUST_ON_CLICK!="undefined"?!!t.ADJUST_ON_CLICK:true;this.TYPE=this.PARAMS.TYPE=="hover"?"hover":"click";this._openTimeout=null;if(this.PARAMS.TYPE=="hover"&&t.TIMEOUT!==0){this.TIMEOUT=t.TIMEOUT||1000}else{this.TIMEOUT=0}this.bMenuInit=false;if(!!this.PARAMS.MENU_URL){this.bMenuLoaded=false;this.bMenuLoading=false;this.MENU=[{TEXT:BX.message("JS_CORE_LOADING"),CLOSE_ON_CLICK:false}];if(this.PARAMS.MENU_PRELOAD){BX.defer(this.Load,this)()}}BX.ready(BX.defer(this.Init,this))};BX.COpener.prototype.Init=function(){this.DIV=BX(this.DIV);switch(this.TYPE){case"hover":BX.bind(this.DIV,"mouseover",BX.proxy(this.Open,this));BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this));break;case"click":BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this));break}};BX.COpener.prototype.Load=function(){if(this.PARAMS.MENU_URL&&!this.bMenuLoaded){if(!this.bMenuLoading){var t=this.PARAMS.MENU_URL;if(t.indexOf("sessid=")<=0){t+=(t.indexOf("?")>0?"&":"?")+"sessid="+BX.bitrix_sessid()}this.bMenuLoading=true;BX.ajax.loadJSON(t,BX.proxy(this.SetMenu,this),BX.proxy(this.LoadFailed,this))}}};BX.COpener.prototype.SetMenu=function(t){this.bMenuLoaded=true;this.bMenuLoading=false;if(this.bMenuInit){this.MENU.setItems(t)}else{this.MENU=t}};BX.COpener.prototype.LoadFailed=function(t,e){this.bMenuLoading=false;this.SetMenu([{TEXT:BX.message("JS_CORE_NO_DATA"),CLOSE_ON_CLICK:true}]);BX.debug(arguments)};BX.COpener.prototype.checkAdminMenu=function(){if(document.documentElement.id=="bx-admin-prefix"){return true}return !!BX.findParent(this.DIV,{property:{id:"bx-admin-prefix"}})};BX.COpener.prototype.Toggle=function(t){this.__clear_timeout();if(!this.bMenuInit||!this.MENU.visible()){var e=this.TIMEOUT;this.TIMEOUT=0;this.Open(t);this.TIMEOUT=e}else{this.MENU.Close()}return !!(t||window.event)&&BX.PreventDefault(t)};BX.COpener.prototype.GetMenu=function(){if(!this.bMenuInit){if(BX.type.isArray(this.MENU)){this.MENU=new BX.CMenu({ITEMS:this.MENU,ATTACH_MODE:this.ATTACH_MODE,SET_ID:this.checkAdminMenu()?"bx-admin-prefix":"",CLOSE_ON_CLICK:!!this.CLOSE_ON_CLICK,ADJUST_ON_CLICK:!!this.ADJUST_ON_CLICK,PUBLIC_FRAME:!!this.PUBLIC_FRAME,LEVEL:this.LEVEL,parent:BX(this.DIV),parent_attach:BX(this.ATTACH)});if(this.LEVEL>0){BX.bind(this.MENU.DIV,"mouseover",BX.proxy(this._on_menu_hover,this));BX.bind(this.MENU.DIV,"mouseout",BX.proxy(this._on_menu_hout,this))}}BX.addCustomEvent(this.MENU,"onMenuOpen",BX.proxy(this.handler_onopen,this));BX.addCustomEvent(this.MENU,"onMenuClose",BX.proxy(this.handler_onclose,this));BX.addCustomEvent("onMenuItemHover",BX.proxy(this.handler_onover,this));this.bMenuInit=true}return this.MENU};BX.COpener.prototype.Open=function(){this.GetMenu();this.bOpen=true;this.__clear_timeout();if(this.TIMEOUT>0){BX.bind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this));this._openTimeout=setTimeout(BX.proxy(this.__open,this),this.TIMEOUT)}else{this.__open()}if(!!this.PARAMS.MENU_URL&&!this.bMenuLoaded){this._loadTimeout=setTimeout(BX.proxy(this.Load,this),parseInt(this.TIMEOUT/2))}return true};BX.COpener.prototype.__clear_timeout=function(){if(!!this._openTimeout){clearTimeout(this._openTimeout)}if(!!this._loadTimeout){clearTimeout(this._loadTimeout)}BX.unbind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this))};BX.COpener.prototype._on_menu_hover=function(){this.bMenuHover=true;this.__clear_timeout();if(this.ACTIVE_CLASS){BX.addClass(this.DIV,this.ACTIVE_CLASS)}};BX.COpener.prototype._on_menu_hout=function(){this.bMenuHover=false};BX.COpener.prototype.handler_onover=function(t,e){if(this.bMenuHover){return}if(e!=this&&t==this.LEVEL-1&&this.ACTIVE_CLASS){BX.removeClass(this.DIV,this.ACTIVE_CLASS)}if(this.bMenuInit&&t<=this.LEVEL-1&&this.MENU.visible()){if(e!=this){this.__clear_timeout();this._openTimeout=setTimeout(BX.proxy(this.Close,this),this.TIMEOUT)}}};BX.COpener.prototype.handler_onopen=function(){this.bOpen=true;if(this.ACTIVE_CLASS){BX.addClass(this.DIV,this.ACTIVE_CLASS)}BX.defer((function(){BX.onCustomEvent(this,"onOpenerMenuOpen")}),this)()};BX.COpener.prototype.handler_onclose=function(){this.bOpen=false;BX.onCustomEvent(this,"onOpenerMenuClose");if(this.ACTIVE_CLASS){BX.removeClass(this.DIV,this.ACTIVE_CLASS)}};BX.COpener.prototype.Close=function(){if(!this.bMenuInit){return}if(!!this._openTimeout){clearTimeout(this._openTimeout)}this.bOpen=false;this.__close()};BX.COpener.prototype.__open=function(){this.__clear_timeout();if(this.bMenuInit&&this.bOpen&&!this.MENU.visible()){this.MENU.Show()}};BX.COpener.prototype.__close=function(){if(this.bMenuInit&&!this.bOpen&&this.MENU.visible()){this.MENU.Hide()}};BX.COpener.prototype.__close_immediately=function(){this.bOpen=false;this.__close()};BX.COpener.prototype.isMenuVisible=function(){return null!=this.MENU.visible&&this.MENU.visible()};BX.CMenu=function(t){BX.CMenu.superclass.constructor.apply(this);this.DIV.style.width="auto";this.DIV.style.height="auto";this.PARAMS=t||{};this.PARTS={};this.PARAMS.ATTACH_MODE=this.PARAMS.ATTACH_MODE||"bottom";this.PARAMS.CLOSE_ON_CLICK=typeof this.PARAMS.CLOSE_ON_CLICK=="undefined"?true:this.PARAMS.CLOSE_ON_CLICK;this.PARAMS.ADJUST_ON_CLICK=typeof this.PARAMS.ADJUST_ON_CLICK=="undefined"?true:this.PARAMS.ADJUST_ON_CLICK;this.PARAMS.PUBLIC_FRAME=typeof this.PARAMS.PUBLIC_FRAME=="undefined"?false:this.PARAMS.PUBLIC_FRAME;this.PARAMS.LEVEL=this.PARAMS.LEVEL||0;this.DIV.className="bx-core-popup-menu bx-core-popup-menu-"+this.PARAMS.ATTACH_MODE+" bx-core-popup-menu-level"+this.PARAMS.LEVEL+(typeof this.PARAMS.ADDITIONAL_CLASS!="undefined"?" "+this.PARAMS.ADDITIONAL_CLASS:"");if(!!this.PARAMS.SET_ID){this.DIV.id=this.PARAMS.SET_ID}if(this.PARAMS.LEVEL==0){this.ARROW=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-core-popup-menu-angle"},style:{left:"15px"}}))}if(!!this.PARAMS.CLASS_NAME){this.DIV.className+=" "+this.PARAMS.CLASS_NAME}BX.bind(this.DIV,"click",BX.eventCancelBubble);this.ITEMS=[];this.setItems(this.PARAMS.ITEMS);BX.addCustomEvent("onMenuOpen",BX.proxy(this._onMenuOpen,this));BX.addCustomEvent("onMenuItemSelected",BX.proxy(this.Hide,this))};BX.extend(BX.CMenu,BX.CWindowFloat);BX.CMenu.broadcastCloseEvent=function(){BX.onCustomEvent("onMenuItemSelected")};BX.CMenu._toggleChecked=function(){BX.toggleClass(this,"bx-core-popup-menu-item-checked")};BX.CMenu._itemDblClick=function(){window.location.href=this.href};BX.CMenu.prototype.toggleArrow=function(t){if(!!this.ARROW){if(typeof t=="undefined"){t=this.ARROW.style.visibility=="hidden"}this.ARROW.style.visibility=!!t?"visible":"hidden"}};BX.CMenu.prototype.visible=function(){return this.DIV.style.display!=="none"};BX.CMenu.prototype._onMenuOpen=function(t,e){if(this.visible()){if(e==this.PARAMS.LEVEL&&t!=this){this.Hide()}}};BX.CMenu.prototype.onUnRegister=function(){if(!this.visible()){return}this.Hide()};BX.CMenu.prototype.setItems=function(t){this.PARAMS.ITEMS=t;BX.cleanNode(this.DIV);if(!!this.ARROW){this.DIV.appendChild(this.ARROW)}if(this.PARAMS.ITEMS){this.PARAMS.ITEMS=BX.util.array_values(this.PARAMS.ITEMS);var e=false;var i=0;for(var s=0,o=this.PARAMS.ITEMS.length;s<o;s++){if((s==0||s==o-1)&&this.PARAMS.ITEMS[s].SEPARATOR){continue}i++;if(!e){e=!!this.PARAMS.ITEMS[s].GLOBAL_ICON}this.addItem(this.PARAMS.ITEMS[s],s)}if(i===1){BX.addClass(this.DIV,"bx-core-popup-menu-single-item")}else{BX.removeClass(this.DIV,"bx-core-popup-menu-single-item")}if(!e){BX.addClass(this.DIV,"bx-core-popup-menu-no-icons")}else{BX.removeClass(this.DIV,"bx-core-popup-menu-no-icons")}}};BX.CMenu.prototype.addItem=function(t){this.ITEMS.push(t);if(t.SEPARATOR){t.NODE=BX.create("DIV",{props:{className:"bx-core-popup-menu-separator"}})}else{var e=!!t.MENU&&(BX.type.isArray(t.MENU)&&t.MENU.length>0||t.MENU instanceof BX.CMenu)||!!t.MENU_URL;if(t.DISABLED){t.CLOSE_ON_CLICK=false;t.LINK=null;t.ONCLICK=null;t.ACTION=null}var i={};if(!!t.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()){i.href=t.LINK||"javascript:void(0)"}if(this.PARAMS.PUBLIC_FRAME){i.target="_top"}t.NODE=BX.create(!!t.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()?"A":"SPAN",{props:{className:"bx-core-popup-menu-item"+(e?" bx-core-popup-menu-item-opener":"")+(!!t.DEFAULT?" bx-core-popup-menu-item-default":"")+(!!t.DISABLED?" bx-core-popup-menu-item-disabled":"")+(!!t.CHECKED?" bx-core-popup-menu-item-checked":""),title:!!BX.message.MENU_ENABLE_TOOLTIP||!!t.SHOW_TITLE?t.TITLE||"":"",BXMENULEVEL:this.PARAMS.LEVEL},attrs:i,events:{mouseover:function(){BX.onCustomEvent("onMenuItemHover",[this.BXMENULEVEL,this.OPENER])}},html:'<span class="bx-core-popup-menu-item-icon'+(t.GLOBAL_ICON?" "+t.GLOBAL_ICON:"")+'"></span><span class="bx-core-popup-menu-item-text">'+(t.HTML||(t.TEXT?BX.util.htmlspecialchars(t.TEXT):""))+"</span>"});if(e&&!t.DISABLED){t.NODE.OPENER=new BX.COpener({DIV:t.NODE,ACTIVE_CLASS:"bx-core-popup-menu-item-opened",TYPE:"hover",MENU:t.MENU,MENU_URL:t.MENU_URL,MENU_PRELOAD:!!t.MENU_PRELOAD,LEVEL:this.PARAMS.LEVEL+1,ATTACH_MODE:"right",TIMEOUT:500})}else{if(this.PARAMS.CLOSE_ON_CLICK&&(typeof t.CLOSE_ON_CLICK=="undefined"||!!t.CLOSE_ON_CLICK)){BX.bind(t.NODE,"click",BX.CMenu.broadcastCloseEvent)}else{if(this.PARAMS.ADJUST_ON_CLICK&&(typeof t.ADJUST_ON_CLICK=="undefined"||!!t.ADJUST_ON_CLICK)){BX.bind(t.NODE,"click",BX.defer(this.adjustPos,this))}}}if(e&&!!t.LINK){BX.bind(t.NODE,"dblclick",BX.CMenu._itemDblClick)}if(typeof t.CHECKED!="undefined"){BX.bind(t.NODE,"click",BX.CMenu._toggleChecked)}t.ONCLICK=t.ACTION||t.ONCLICK;if(!!t.ONCLICK){if(BX.type.isString(t.ONCLICK)){t.ONCLICK=new Function("event",t.ONCLICK)}BX.bind(t.NODE,"click",t.ONCLICK)}}this.DIV.appendChild(t.NODE)};BX.CMenu.prototype._documentClickBind=function(){this._documentClickUnBind();BX.bind(document,"click",BX.proxy(this._documentClick,this))};BX.CMenu.prototype._documentClickUnBind=function(){BX.unbind(document,"click",BX.proxy(this._documentClick,this))};BX.CMenu.prototype._documentClick=function(t){t=t||window.event;if(!!t&&!(BX.getEventButton(t)&BX.MSLEFT)){return}this.Close()};BX.CMenu.prototype.Show=function(){BX.onCustomEvent(this,"onMenuOpen",[this,this.PARAMS.LEVEL]);BX.CMenu.superclass.Show.apply(this,[]);this.bCloseEventFired=false;BX.addCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this));BX.defer(this._documentClickBind,this)()};BX.CMenu.prototype.Close=BX.CMenu.prototype.Hide=function(){if(!this.visible()){return}BX.removeCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this));this._documentClickUnBind();if(!this.bCloseEventFired){BX.onCustomEvent(this,"onMenuClose",[this,this.PARAMS.LEVEL]);this.bCloseEventFired=true}BX.CMenu.superclass.Hide.apply(this,arguments)};BX.CMenu.prototype.__adjustMenuToNode=function(){var t=BX.pos(this.PARAMS.parent_attach),e=!!BX.findParent(this.PARAMS.parent_attach,BX.is_fixed);if(e){this.DIV.style.position="fixed"}else{this.DIV.style.position="absolute"}if(!t.top){this.DIV.style.top="-1000px";this.DIV.style.left="-1000px"}if(this.bTimeoutSet){return}var i=this.DIV.offsetWidth,s=this.DIV.offsetHeight;if(!i){setTimeout(BX.delegate((function(){this.bTimeoutSet=false;this.__adjustMenuToNode()}),this),100);this.bTimeoutSet=true;return}var o={},n=BX.GetWindowSize();switch(this.PARAMS.ATTACH_MODE){case"bottom":o.top=t.bottom+9;o.left=t.left;var r=0;if(!!this.ARROW){if(t.width>i){r=parseInt(i/2-7)}else{r=parseInt(Math.min(i,t.width)/2-7)}if(r<7){o.left-=15;r+=15}}if(o.left>n.scrollWidth-i-10){var h=o.left;o.left=n.scrollWidth-i-10;if(!!this.ARROW){r+=h-o.left}}if(e){o.left-=n.scrollLeft}if(!!this.ARROW){this.ARROW.style.left=r+"px"}break;case"right":o.top=t.top-1;o.left=t.right;if(o.left>n.scrollWidth-i-10){o.left=t.left-i-1}break}if(e){o.top-=n.scrollTop}if(!!this.ARROW){this.ARROW.className="bx-core-popup-menu-angle"}if(o.top+s>n.scrollTop+n.innerHeight||o.top+s>n.scrollHeight){var a=this.PARAMS.ATTACH_MODE=="bottom"?t.top-s-9:t.bottom-s+1;if(a>n.scrollTop||o.top+s>n.scrollHeight){if(o.top+s>n.scrollHeight){o.top=Math.max(0,n.scrollHeight-s);this.toggleArrow(false)}else{o.top=a;if(!!this.ARROW){this.ARROW.className="bx-core-popup-menu-angle-bottom"}}}}if(o.top+o.left==0){this.Hide()}else{this.DIV.style.top=o.top+"px";this.DIV.style.left=o.left+"px"}};BX.CMenu.prototype.adjustToNode=function(t){this.PARAMS.parent_attach=BX(t)||this.PARAMS.parent_attach||this.PARAMS.parent;this.__adjustMenuToNode()};BX.CMenuOpener=function(t){BX.CMenuOpener.superclass.constructor.apply(this);this.PARAMS=t||{};this.setParent(this.PARAMS.parent);this.PARTS={};this.SETTINGS.drag_restrict=true;this.defaultAction=null;this.timeout=500;this.DIV.className="bx-component-opener";this.DIV.ondblclick=BX.PreventDefault;if(this.PARAMS.component_id){this.PARAMS.transform=!!this.PARAMS.transform}this.OPENERS=[];this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar"+(this.PARAMS.transform?" bx-context-toolbar-vertical-mode":"")}}));this.PARTS.INNER=this.DIV.firstChild.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-inner"},html:'<span class="bx-context-toolbar-drag-icon"></span><span class="bx-context-toolbar-vertical-line"></span><br>'}));this.EXTRA_BUTTONS={};var e=0;for(var i=0,s=this.PARAMS.menu.length;i<s;i++){var o=this.addItem(this.PARAMS.menu[i]);if(null!=o){e++;this.PARTS.INNER.appendChild(o);this.PARTS.INNER.appendChild(BX.create("BR"))}}var n=e>0;this.PARTS.ICONS=this.PARTS.INNER.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-icons"}}));if(this.PARAMS.component_id){this.PARAMS.pin=!!this.PARAMS.pin;if(n){this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-separator"}}))}this.PARTS.ICON_PIN=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin"},events:{click:BX.delegate(this.__pin_btn_clicked,this)}}))}if(this.EXTRA_BUTTONS.components2_props){var r=this.EXTRA_BUTTONS.components2_props||{URL:"javascript:void(0)"};if(null==this.defaultAction){this.defaultAction=r.ONCLICK;this.defaultActionTitle=r.TITLE||r.TEXT}r.URL="javascript:"+BX.util.urlencode(r.ONCLICK);this.ATTACH=this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button bx-context-toolbar-button-settings"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"},children:[BX.create("A",{attrs:{href:r.URL},events:{mouseover:BX.proxy(this.__msover_text,this),mouseout:BX.proxy(this.__msout_text,this),mousedown:BX.proxy(this.__msdown_text,this)},html:'<span class="bx-context-toolbar-button-icon bx-context-toolbar-settings-icon"></span>'}),BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-button-arrow"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},html:'<span class="bx-context-toolbar-button-arrow"></span>'})]})]}));this.OPENER=this.ATTACH.firstChild.lastChild;var h=this.attachMenu(this.EXTRA_BUTTONS.components2_submenu["MENU"]);BX.addCustomEvent(h,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this));BX.addCustomEvent(h,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))}if(e>1){this.PARTS.ICONS.appendChild(BX.create("span",{props:{className:"bx-context-toolbar-separator bx-context-toolbar-separator-switcher"}}));this.ICON_TRANSFORM=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-switcher"},events:{click:BX.delegate(this.__trf_btn_clicked,this)}}))}if(this.PARAMS.HINT){this.DIV.BXHINT=this.HINT=new BX.CHint({parent:this.DIV,hint:this.PARAMS.HINT.TEXT||"",title:this.PARAMS.HINT.TITLE||"",hide_timeout:this.timeout/2,preventHide:false})}BX.addCustomEvent(this,"onWindowDragFinished",BX.delegate(this.__onMoveFinished,this));BX.addCustomEvent("onDynamicModeChange",BX.delegate(this.__onDynamicModeChange,this));BX.addCustomEvent("onTopPanelCollapse",BX.delegate(this.__onPanelCollapse,this));BX.addCustomEvent("onMenuOpenerMoved",BX.delegate(this.checkPosition,this));BX.addCustomEvent("onMenuOpenerUnhide",BX.delegate(this.checkPosition,this));BX.Event.EventEmitter.incrementMaxListeners("onDynamicModeChange");BX.Event.EventEmitter.incrementMaxListeners("onTopPanelCollapse");BX.Event.EventEmitter.incrementMaxListeners("onMenuOpenerMoved");BX.Event.EventEmitter.incrementMaxListeners("onMenuOpenerUnhide");if(this.OPENERS){for(i=0,s=this.OPENERS.length;i<s;i++){BX.addCustomEvent(this.OPENERS[i],"onOpenerMenuOpen",BX.proxy(this.__hide_hint,this))}}};BX.extend(BX.CMenuOpener,BX.CWindowFloat);BX.CMenuOpener.prototype.setParent=function(t){t=BX(t);if(!t){return}if(t.OPENER&&t.OPENER!=this){t.OPENER.Close();t.OPENER.clearHoverHoutEvents()}if(this.PARAMS.parent&&this.PARAMS.parent!=t){this.clearHoverHoutEvents();this.PARAMS.parent.OPENER=null}this.PARAMS.parent=t;this.PARAMS.parent.OPENER=this};BX.CMenuOpener.prototype.setHoverHoutEvents=function(t,e){if(!this.__opener_events_set){BX.bind(this.Get(),"mouseover",t);BX.bind(this.Get(),"mouseout",e);this.__opener_events_set=true}};BX.CMenuOpener.prototype.clearHoverHoutEvents=function(){if(this.Get()){BX.unbindAll(this.Get());this.__opener_events_set=false}};BX.CMenuOpener.prototype.unclosable=true;BX.CMenuOpener.prototype.__check_intersection=function(t,e){return !(e.right<=t.left||e.left>=t.right||e.bottom<=t.top||e.top>=t.bottom)};BX.CMenuOpener.prototype.__msover_text=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-hover")}};BX.CMenuOpener.prototype.__msout_text=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.ATTACH,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")}};BX.CMenuOpener.prototype.__msover_arrow=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover")}};BX.CMenuOpener.prototype.__msout_arrow=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")}};BX.CMenuOpener.prototype.__msdown_text=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-active")}};BX.CMenuOpener.prototype.__msdown_arrow=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-active")}};BX.CMenuOpener.prototype.__menu_close=function(){this._menu_open=false;this.bx_active=false;BX.removeClass(this.ATTACH,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active");if(!this.bx_hover){BX.removeClass(this.ATTACH,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover");this.bx_hover=false}};BX.CMenuOpener.prototype.__menu_open=function(){this._menu_open=true};BX.CMenuOpener.prototype.checkPosition=function(){if(this.isMenuVisible()||this.DIV.style.display=="none"||this==BX.proxy_context||BX.proxy_context.zIndex>this.zIndex){return}this.correctPosition(BX.proxy_context)};BX.CMenuOpener.prototype.correctPosition=function(t){var e=BX.pos(this.DIV),i=BX.pos(t.Get());if(this.__check_intersection(e,i)){var s=i.top-e.height;if(s<0){s=i.bottom}this.DIV.style.top=s+"px";BX.addCustomEvent(t,"onMenuOpenerHide",BX.proxy(this.restorePosition,this));BX.onCustomEvent(this,"onMenuOpenerMoved")}};BX.CMenuOpener.prototype.restorePosition=function(){if(!this.MOUSEOVER&&!this.isMenuVisible()){if(this.originalPos){this.DIV.style.top=this.originalPos.top+"px"}BX.removeCustomEvent(BX.proxy_context,"onMenuOpenerHide",BX.proxy(this.restorePosition,this));if(this.restore_pos_timeout){clearTimeout(this.restore_pos_timeout)}}else{this.restore_pos_timeout=setTimeout(BX.proxy(this.restorePosition,this),this.timeout)}};BX.CMenuOpener.prototype.Show=function(){BX.CMenuOpener.superclass.Show.apply(this,arguments);this.SetDraggable(this.PARTS.INNER.firstChild);this.DIV.style.width="auto";this.DIV.style.height="auto";if(!this.PARAMS.pin){this.DIV.style.left="-1000px";this.DIV.style.top="-1000px";this.Hide()}else{this.bPosAdjusted=true;this.bMoved=true;if(this.PARAMS.top){this.DIV.style.top=this.PARAMS.top+"px"}if(this.PARAMS.left){this.DIV.style.left=this.PARAMS.left+"px"}this.DIV.style.display=!BX.admin.dynamic_mode||BX.admin.dynamic_mode_show_borders?"block":"none";if(this.DIV.style.display=="block"){setTimeout(BX.delegate((function(){BX.onCustomEvent(this,"onMenuOpenerUnhide")}),this),50)}}};BX.CMenuOpener.prototype.executeDefaultAction=function(){if(this.defaultAction){if(BX.type.isFunction(this.defaultAction)){this.defaultAction()}else{if(BX.type.isString(this.defaultAction)){BX.evalGlobal(this.defaultAction)}}}};BX.CMenuOpener.prototype.__onDynamicModeChange=function(t){this.DIV.style.display=t?"block":"none"};BX.CMenuOpener.prototype.__onPanelCollapse=function(t,e){this.DIV.style.top=parseInt(this.DIV.style.top)+e+"px";if(this.PARAMS.pin){this.__savePosition()}};BX.CMenuOpener.prototype.__onMoveFinished=function(){BX.onCustomEvent(this,"onMenuOpenerMoved");this.bMoved=true;if(this.PARAMS.pin){this.__savePosition()}};BX.CMenuOpener.prototype.__savePosition=function(){var t={};t.pin=this.PARAMS.pin;if(!this.PARAMS.pin){t.top=false;t.left=false;t.transform=false}else{t.transform=this.PARAMS.transform;if(this.bMoved){t.left=parseInt(this.DIV.style.left);t.top=parseInt(this.DIV.style.top)}}BX.WindowManager.saveWindowOptions(this.PARAMS.component_id,t)};BX.CMenuOpener.prototype.__pin_btn_clicked=function(){this.Pin()};BX.CMenuOpener.prototype.Pin=function(t){if(null==t){this.PARAMS.pin=!this.PARAMS.pin}else{this.PARAMS.pin=!!t}this.PARTS.ICON_PIN.className=this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin";this.__savePosition()};BX.CMenuOpener.prototype.__trf_btn_clicked=function(){this.Transform()};BX.CMenuOpener.prototype.Transform=function(t){var e={};if(null==t){this.PARAMS.transform=!this.PARAMS.transform}else{this.PARAMS.transform=!!t}if(this.bMoved){e=BX.pos(this.DIV)}if(this.PARAMS.transform){BX.addClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode")}else{BX.removeClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode")}if(!this.bMoved){this.adjustPos()}else{this.DIV.style.left=e.right-this.DIV.offsetWidth-(BX.browser.IsIE()&&!BX.browser.IsDoctype()?2:0)+"px"}this.__savePosition()};BX.CMenuOpener.prototype.adjustToNodeGetPos=function(){var t=BX.pos(this.PARAMS.parent);var e=BX.GetWindowScrollSize();var i=this.DIV.offsetWidth;t.left-=BX.admin.__border_dx;t.top-=BX.admin.__border_dx;if(true||!this.PARAMS.transform){t.top-=45}if(t.left>e.scrollWidth-i){t.left=e.scrollWidth-i}return t};BX.CMenuOpener.prototype.addItem=function(t){if(t.TYPE){this.EXTRA_BUTTONS[t.TYPE]=t;return null}else{var e=new BX.CMenuOpenerItem(t);if(null==this.defaultAction){if(e.item.ONCLICK){this.defaultAction=t.ONCLICK}else{if(e.item.MENU){this.defaultAction=BX.delegate((function(){this.Open()}),e.item.OPENER)}}this.defaultActionTitle=t.TITLE||t.TEXT;BX.addClass(e.Get(),"bx-content-toolbar-default")}if(e.item.OPENER){this.OPENERS[this.OPENERS.length]=e.item.OPENER}return e.Get()}};BX.CMenuOpener.prototype.attachMenu=function(t){var e=new BX.COpener({DIV:this.OPENER,ATTACH:this.ATTACH,MENU:t,TYPE:"click"});this.OPENERS[this.OPENERS.length]=e;return e};BX.CMenuOpener.prototype.__hide_hint=function(){if(this.HINT){this.HINT.__hide_immediately()}};BX.CMenuOpener.prototype.isMenuVisible=function(){for(var t=0,e=this.OPENERS.length;t<e;t++){if(this.OPENERS[t].isMenuVisible()){return true}}return false};BX.CMenuOpener.prototype.Hide=function(){if(!this.PARAMS.pin){this.DIV.style.display="none";BX.onCustomEvent(this,"onMenuOpenerHide")}};BX.CMenuOpener.prototype.UnHide=function(){this.DIV.style.display="block";if(!this.bPosAdjusted&&!this.PARAMS.pin){this.adjustPos();this.bPosAdjusted=true}if(null==this.originalPos&&!this.bMoved){this.originalPos=BX.pos(this.DIV)}BX.onCustomEvent(this,"onMenuOpenerUnhide")};BX.CMenuOpenerItem=function(t){this.item=t;if(this.item.ACTION&&!this.item.ONCLICK){this.item.ONCLICK=this.item.ACTION}this.DIV=BX.create("SPAN");this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-underlay"}}));this.WRAPPER=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-wrapper"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button",title:t.TITLE},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"}})]})]}));var e=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-icon"+(this.item.ICON||this.item.ICONCLASS?" "+(this.item.ICON||this.item.ICONCLASS):"")},attrs:!(this.item.ICON||this.item.ICONCLASS)&&(this.item.SRC||this.item.IMAGE)?{style:"background: scroll transparent url("+(this.item.SRC||this.item.IMAGE)+") no-repeat center center !important;"}:{}}),i=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-text"},text:this.item.TEXT});if(this.item.ACTION&&!this.item.ONCLICK){this.item.ONCLICK=this.item.ACTION}this.bHasMenu=!!this.item.MENU;this.bHasAction=!!this.item.ONCLICK;if(this.bHasAction){this.LINK=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:this.bHasMenu?BX.proxy(this.__msover_text,this):BX.proxy(this.__msover,this),mouseout:this.bHasMenu?BX.proxy(this.__msout_text,this):BX.proxy(this.__msout,this),mousedown:this.bHasMenu?BX.proxy(this.__msdown_text,this):BX.proxy(this.__msdown,this)},children:[e,i]}));if(this.bHasMenu){this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{props:{className:"bx-context-toolbar-button-arrow"},attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-arrow"}})]}))}}else{if(this.bHasMenu){this.item.ONCLICK=null;this.LINK=this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover,this),mouseout:BX.proxy(this.__msout,this),mousedown:BX.proxy(this.__msdown,this)},children:[e,i]}));this.LINK.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-single-button-arrow"}}))}}if(this.bHasMenu){this.item.SUBMENU=new BX.CMenu({ATTACH_MODE:"bottom",ITEMS:this.item.MENU,parent:this.LINK_MENU,parent_attach:this.WRAPPER.firstChild});this.item.OPENER=new BX.COpener({DIV:this.LINK_MENU,TYPE:"click",MENU:this.item.SUBMENU});BX.addCustomEvent(this.item.OPENER,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this));BX.addCustomEvent(this.item.OPENER,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))}if(this.bHasAction){BX.bind(this.LINK,"click",BX.delegate(this.__click,this))}};BX.CMenuOpenerItem.prototype.Get=function(){return this.DIV};BX.CMenuOpenerItem.prototype.__msover=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover")}};BX.CMenuOpenerItem.prototype.__msout=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-active")}};BX.CMenuOpenerItem.prototype.__msover_text=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover")}};BX.CMenuOpenerItem.prototype.__msout_text=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")}};BX.CMenuOpenerItem.prototype.__msover_arrow=function(){this.bx_hover=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover")}};BX.CMenuOpenerItem.prototype.__msout_arrow=function(){this.bx_hover=false;if(!this._menu_open){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")}};BX.CMenuOpenerItem.prototype.__msdown=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active")}};BX.CMenuOpenerItem.prototype.__msdown_text=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-active")}};BX.CMenuOpenerItem.prototype.__msdown_arrow=function(){this.bx_active=true;if(!this._menu_open){BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-active")}};BX.CMenuOpenerItem.prototype.__menu_close=function(){this._menu_open=false;this.bx_active=false;BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active");if(!this.bx_hover){BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover");this.bx_hover=false}};BX.CMenuOpenerItem.prototype.__menu_open=function(){this._menu_open=true};BX.CMenuOpenerItem.prototype.__click=function(){BX.evalGlobal(this.item.ONCLICK)};BX.CPageOpener=function(t){BX.CPageOpener.superclass.constructor.apply(this,arguments);this.timeout=505;window.PAGE_EDIT_CONTROL=this};BX.extend(BX.CPageOpener,BX.CMenuOpener);BX.CPageOpener.prototype.checkPosition=function(){if(this==BX.proxy_context){return}this.correctPosition(BX.proxy_context)};BX.CPageOpener.prototype.correctPosition=function(t){if(this.bPosCorrected){return}var e;if(this.DIV.style.display=="none"){e=this.adjustToNodeGetPos();e.bottom=e.top+30;e.right=e.left+300}else{e=BX.pos(this.DIV)}var i=BX.pos(t.Get());if(this.__check_intersection(e,i)){this.DIV.style.display="none";var s=BX.proxy(this.restorePosition,this);BX.removeCustomEvent(t,"onMenuOpenerHide",s);BX.addCustomEvent(t,"onMenuOpenerHide",s);this.bPosCorrected=true}};BX.CPageOpener.prototype.restorePosition=function(){if(BX.proxy_context&&BX.proxy_context.Get().style.display=="none"){this.bPosCorrected=false;if(this.PARAMS.parent.bx_over||this.PARAMS.pin){this.UnHide()}BX.removeCustomEvent("onMenuOpenerHide",BX.proxy(this.restorePosition,this))}};BX.CPageOpener.prototype.UnHide=function(){if(!this.bPosCorrected){BX.CPageOpener.superclass.UnHide.apply(this,arguments)}};BX.CPageOpener.prototype.Remove=function(){BX.admin.removeComponentBorder(this.PARAMS.parent);BX.userOptions.save("global","settings","page_edit_control_enable","N");this.DIV.style.display="none"};BX.CHintSimple=function(){BX.CHintSimple.superclass.constructor.apply(this,arguments)};BX.extend(BX.CHintSimple,BX.CHint);BX.CHintSimple.prototype.Init=function(){this.DIV=document.body.appendChild(BX.create("DIV",{props:{className:"bx-tooltip-simple"},style:{display:"none"},children:[this.CONTENT=BX.create("DIV")]}));BX.ZIndexManager.register(this.DIV);if(this.HINT_TITLE){this.CONTENT.appendChild(BX.create("B",{text:this.HINT_TITLE}))}if(this.HINT){this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV")).appendChild(BX.create("SPAN",{html:this.HINT}))}if(this.PARAMS.preventHide){BX.bind(this.DIV,"mouseout",BX.proxy(this.Hide,this));BX.bind(this.DIV,"mouseover",BX.proxy(this.Show,this))}this.bInited=true};BX.adminInformer={itemsShow:3,Init:function(t){if(t){BX.adminInformer.itemsShow=t}var e=BX("admin-informer");if(e){document.body.appendChild(e);BX.ZIndexManager.register(e)}BX.addCustomEvent("onTopPanelCollapse",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},Toggle:function(t){var e=BX("admin-informer");if(!e){return false}var i=BX.pos(t);e.style.top=parseInt(i.top)+parseInt(i.height)+7+"px";e.style.left=i.left+"px";if(!BX.hasClass(e,"adm-informer-active")){BX.adminInformer.Show(e)}else{BX.adminInformer.Hide(e)}return false},Close:function(){BX.adminInformer.Hide(BX("admin-informer"))},OnInnerClick:function(t){var e=t.target||t.srcElement;if(e.nodeName.toLowerCase()!="a"||BX.hasClass(e,"adm-informer-footer")){return BX.PreventDefault(t)}return true},ToggleExtra:function(){var t=BX("adm-informer-footer");if(BX.hasClass(t,"adm-informer-footer-collapsed")){this.ShowAll()}else{this.HideExtra()}return false},ShowAll:function(){var t=BX("admin-informer");for(var e=0;e<t.children.length;e++){if(BX.hasClass(t.children[e],"adm-informer-item")&&t.children[e].style.display=="none"){t.children[e].style.display="block"}}var i=BX("adm-informer-footer");if(i.textContent!==undefined){i.textContent=BX.message("JSADM_AI_HIDE_EXTRA")}else{i.innerText=BX.message("JSADM_AI_HIDE_EXTRA")}BX.removeClass(i,"adm-informer-footer-collapsed");return false},HideExtra:function(){var t=BX("admin-informer");var e=0;for(var i=BX.adminInformer.itemsShow+1;i<t.children.length;i++){if(BX.hasClass(t.children[i],"adm-informer-item")&&t.children[i].style.display=="block"){t.children[i].style.display="none";e++}}var s=BX("adm-informer-footer");var o=BX.message("JSADM_AI_ALL_NOTIF")+" ("+(BX.adminInformer.itemsShow+parseInt(e))+")";if(s.textContent!==undefined){s.textContent=o}else{s.innerText=o}BX.addClass(s,"adm-informer-footer-collapsed");return false},Show:function(t){var e=BX("adm-header-notif-block");if(e){BX.addClass(e,"adm-header-notif-block-active")}BX.onCustomEvent(t,"onBeforeAdminInformerShow");setTimeout(BX.proxy((function(){BX.bind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer))}),BX.adminInformer),0);BX.addClass(t,"adm-informer-active");BX.ZIndexManager.bringToFront(t);setTimeout((function(){BX.addClass(t,"adm-informer-animate")}),0)},Hide:function(t){var e=BX("adm-header-notif-block");if(e){BX.removeClass(e,"adm-header-notif-block-active")}BX.unbind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer));BX.removeClass(t,"adm-informer-animate");if(this.IsAnimationSupported()){setTimeout((function(){BX.removeClass(t,"adm-informer-active")}),300)}else{BX.removeClass(t,"adm-informer-active")}BX.onCustomEvent(t,"onAdminInformerHide")},IsAnimationSupported:function(){var t=document.body||document.documentElement;if(typeof t.style.transition=="string"){return true}else{if(typeof t.style.MozTransition=="string"){return true}else{if(typeof t.style.OTransition=="string"){return true}else{if(typeof t.style.WebkitTransition=="string"){return true}else{if(typeof t.style.msTransition=="string"){return true}}}}}return false},SetItemHtml:function(t,e){var i=BX("adm-informer-item-html-"+t);if(!i){return false}i.innerHTML=e;return true},SetItemFooter:function(t,e){var i=BX("adm-informer-item-footer-"+t);if(!i){return false}i.innerHTML=e;if(e){i.style.display="block"}else{i.style.display="none"}return true}}})(window);(function(c){if(!c.BX){c.BX={}}if(!c.BX.Main){c.BX.Main={}}else{if(c.BX.Main.Date){return}}var a=c.BX;a.Main.Date={AM_PM_MODE:{UPPER:1,LOWER:2,NONE:false},format:function(X,B,ab,K){var aa=this;var G=b.isDate(B)?new Date(B.getTime()):b.isNumber(B)?new Date(B*1000):new Date;var Q=b.isDate(ab)?new Date(ab.getTime()):b.isNumber(ab)?new Date(ab*1000):new Date;var C=!!K;if(b.isArray(X)){return V(X,G,Q,C)}else{if(!b.isNotEmptyString(X)){return""}}var J=(X.match(/{{([^{}]*)}}/g)||[]).map(function(d){return(d.match(/[^{}]+/)||[""])[0]});if(J.length>0){J.forEach(function(d,e){X=X.replace("{{"+d+"}}","{{"+e+"}}")})}var v=/\\?(sago|iago|isago|Hago|dago|mago|Yago|sdiff|idiff|Hdiff|ddiff|mdiff|Ydiff|sshort|ishort|Hshort|dshort|mhort|Yshort|yesterday|today|tommorow|tomorrow|[a-z])/gi;var y={d:function(){return b.strPadLeft(Z(G).toString(),2,"0")},D:function(){return aa._getMessage("DOW_"+w(G))},j:function(){return Z(G)},l:function(){return aa._getMessage("DAY_OF_WEEK_"+w(G))},N:function(){return w(G)||7},S:function(){if(Z(G)%10==1&&Z(G)!=11){return"st"}else{if(Z(G)%10==2&&Z(G)!=12){return"nd"}else{if(Z(G)%10==3&&Z(G)!=13){return"rd"}else{return"th"}}}},w:function(){return w(G)},z:function(){var f=new Date(x(G),0,1);var d=new Date(x(G),j(G),Z(G));return Math.ceil((d-f)/(24*3600*1000))},W:function(){var g=new Date(G.getTime());var f=(w(G)+6)%7;p(g,Z(g)-f+3);var d=g.getTime();k(g,0,1);if(w(g)!=4){k(g,0,1+(4-w(g)+7)%7)}var h=1+Math.ceil((d-g)/(7*24*3600*1000));return b.strPadLeft(h.toString(),2,"0")},F:function(){return aa._getMessage("MONTH_"+(j(G)+1)+"_S")},f:function(){return aa._getMessage("MONTH_"+(j(G)+1))},m:function(){return b.strPadLeft((j(G)+1).toString(),2,"0")},M:function(){return aa._getMessage("MON_"+(j(G)+1))},n:function(){return j(G)+1},t:function(){var d=C?new Date(Date.UTC(x(G),j(G)+1,0)):new Date(x(G),j(G)+1,0);return Z(d)},L:function(){var d=x(G);return d%4==0&&d%100!=0||d%400==0?1:0},o:function(){var d=new Date(G.getTime());p(d,Z(d)-(w(G)+6)%7+3);return x(d)},Y:function(){return x(G)},y:function(){return x(G).toString().slice(2)},a:function(){return z(G)>11?"pm":"am"},A:function(){return z(G)>11?"PM":"AM"},B:function(){var d=(G.getUTCHours()+1)%24+G.getUTCMinutes()/60+G.getUTCSeconds()/3600;return b.strPadLeft(Math.floor(d*1000/24).toString(),3,"0")},g:function(){return z(G)%12||12},G:function(){return z(G)},h:function(){return b.strPadLeft((z(G)%12||12).toString(),2,"0")},H:function(){return b.strPadLeft(z(G).toString(),2,"0")},i:function(){return b.strPadLeft(P(G).toString(),2,"0")},s:function(){return b.strPadLeft(I(G).toString(),2,"0")},u:function(){return b.strPadLeft((L(G)*1000).toString(),6,"0")},e:function(){if(C){return"UTC"}return""},I:function(){if(C){return 0}var h=new Date(x(G),0,1);var f=Date.UTC(x(G),0,1);var g=new Date(x(G),6,0);var d=Date.UTC(x(G),6,0);return 0+(h-f!==g-d)},O:function(){if(C){return"+0000"}var f=G.getTimezoneOffset();var d=Math.abs(f);return(f>0?"-":"+")+b.strPadLeft((Math.floor(d/60)*100+d%60).toString(),4,"0")},P:function(){if(C){return"+00:00"}var d=this.O();return d.substr(0,3)+":"+d.substr(3)},Z:function(){if(C){return 0}return -G.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(v,U)},r:function(){return"D, d M Y H:i:s O".replace(v,U)},U:function(){return Math.floor(G.getTime()/1000)},sago:function(){return Y(r((Q-G)/1000),{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"})},sdiff:function(){return Y(r((Q-G)/1000),{0:"FD_SECOND_DIFF_0",1:"FD_SECOND_DIFF_1","10_20":"FD_SECOND_DIFF_10_20",MOD_1:"FD_SECOND_DIFF_MOD_1",MOD_2_4:"FD_SECOND_DIFF_MOD_2_4",MOD_OTHER:"FD_SECOND_DIFF_MOD_OTHER"})},sshort:function(){return aa._getMessage("FD_SECOND_SHORT").replace(/#VALUE#/g,r((Q-G)/1000))},iago:function(){return Y(r((Q-G)/60/1000),{0:"FD_MINUTE_AGO_0",1:"FD_MINUTE_AGO_1","10_20":"FD_MINUTE_AGO_10_20",MOD_1:"FD_MINUTE_AGO_MOD_1",MOD_2_4:"FD_MINUTE_AGO_MOD_2_4",MOD_OTHER:"FD_MINUTE_AGO_MOD_OTHER"})},idiff:function(){return Y(r((Q-G)/60/1000),{0:"FD_MINUTE_DIFF_0",1:"FD_MINUTE_DIFF_1","10_20":"FD_MINUTE_DIFF_10_20",MOD_1:"FD_MINUTE_DIFF_MOD_1",MOD_2_4:"FD_MINUTE_DIFF_MOD_2_4",MOD_OTHER:"FD_MINUTE_DIFF_MOD_OTHER"})},isago:function(){var g=r((Q-G)/60/1000);var d=Y(g,{0:"FD_MINUTE_0",1:"FD_MINUTE_1","10_20":"FD_MINUTE_10_20",MOD_1:"FD_MINUTE_MOD_1",MOD_2_4:"FD_MINUTE_MOD_2_4",MOD_OTHER:"FD_MINUTE_MOD_OTHER"});d+=" ";var f=r((Q-G)/1000)-g*60;d+=Y(f,{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"});return d},ishort:function(){return aa._getMessage("FD_MINUTE_SHORT").replace(/#VALUE#/g,r((Q-G)/60/1000))},Hago:function(){return Y(r((Q-G)/60/60/1000),{0:"FD_HOUR_AGO_0",1:"FD_HOUR_AGO_1","10_20":"FD_HOUR_AGO_10_20",MOD_1:"FD_HOUR_AGO_MOD_1",MOD_2_4:"FD_HOUR_AGO_MOD_2_4",MOD_OTHER:"FD_HOUR_AGO_MOD_OTHER"})},Hdiff:function(){return Y(r((Q-G)/60/60/1000),{0:"FD_HOUR_DIFF_0",1:"FD_HOUR_DIFF_1","10_20":"FD_HOUR_DIFF_10_20",MOD_1:"FD_HOUR_DIFF_MOD_1",MOD_2_4:"FD_HOUR_DIFF_MOD_2_4",MOD_OTHER:"FD_HOUR_DIFF_MOD_OTHER"})},Hshort:function(){return aa._getMessage("FD_HOUR_SHORT").replace(/#VALUE#/g,r((Q-G)/60/60/1000))},yesterday:function(){return aa._getMessage("FD_YESTERDAY")},today:function(){return aa._getMessage("FD_TODAY")},tommorow:function(){return aa._getMessage("FD_TOMORROW")},tomorrow:function(){return aa._getMessage("FD_TOMORROW")},dago:function(){return Y(r((Q-G)/60/60/24/1000),{0:"FD_DAY_AGO_0",1:"FD_DAY_AGO_1","10_20":"FD_DAY_AGO_10_20",MOD_1:"FD_DAY_AGO_MOD_1",MOD_2_4:"FD_DAY_AGO_MOD_2_4",MOD_OTHER:"FD_DAY_AGO_MOD_OTHER"})},ddiff:function(){return Y(r((Q-G)/60/60/24/1000),{0:"FD_DAY_DIFF_0",1:"FD_DAY_DIFF_1","10_20":"FD_DAY_DIFF_10_20",MOD_1:"FD_DAY_DIFF_MOD_1",MOD_2_4:"FD_DAY_DIFF_MOD_2_4",MOD_OTHER:"FD_DAY_DIFF_MOD_OTHER"})},dshort:function(){return aa._getMessage("FD_DAY_SHORT").replace(/#VALUE#/g,r((Q-G)/60/60/24/1000))},mago:function(){return Y(r((Q-G)/60/60/24/31/1000),{0:"FD_MONTH_AGO_0",1:"FD_MONTH_AGO_1","10_20":"FD_MONTH_AGO_10_20",MOD_1:"FD_MONTH_AGO_MOD_1",MOD_2_4:"FD_MONTH_AGO_MOD_2_4",MOD_OTHER:"FD_MONTH_AGO_MOD_OTHER"})},mdiff:function(){return Y(r((Q-G)/60/60/24/31/1000),{0:"FD_MONTH_DIFF_0",1:"FD_MONTH_DIFF_1","10_20":"FD_MONTH_DIFF_10_20",MOD_1:"FD_MONTH_DIFF_MOD_1",MOD_2_4:"FD_MONTH_DIFF_MOD_2_4",MOD_OTHER:"FD_MONTH_DIFF_MOD_OTHER"})},mshort:function(){return aa._getMessage("FD_MONTH_SHORT").replace(/#VALUE#/g,r((Q-G)/60/60/24/31/1000))},Yago:function(){return Y(r((Q-G)/60/60/24/365/1000),{0:"FD_YEARS_AGO_0",1:"FD_YEARS_AGO_1","10_20":"FD_YEARS_AGO_10_20",MOD_1:"FD_YEARS_AGO_MOD_1",MOD_2_4:"FD_YEARS_AGO_MOD_2_4",MOD_OTHER:"FD_YEARS_AGO_MOD_OTHER"})},Ydiff:function(){return Y(r((Q-G)/60/60/24/365/1000),{0:"FD_YEARS_DIFF_0",1:"FD_YEARS_DIFF_1","10_20":"FD_YEARS_DIFF_10_20",MOD_1:"FD_YEARS_DIFF_MOD_1",MOD_2_4:"FD_YEARS_DIFF_MOD_2_4",MOD_OTHER:"FD_YEARS_DIFF_MOD_OTHER"})},Yshort:function(){return Y(r((Q-G)/60/60/24/365/1000),{0:"FD_YEARS_SHORT_0",1:"FD_YEARS_SHORT_1","10_20":"FD_YEARS_SHORT_10_20",MOD_1:"FD_YEARS_SHORT_MOD_1",MOD_2_4:"FD_YEARS_SHORT_MOD_2_4",MOD_OTHER:"FD_YEARS_SHORT_MOD_OTHER"})},x:function(){var f=aa.isAmPmMode(true);var d=f===aa.AM_PM_MODE.LOWER?"g:i a":f===aa.AM_PM_MODE.UPPER?"g:i A":"H:i";return aa.format([["tomorrow","tomorrow, "+d],["-",aa.convertBitrixFormat(aa._getMessage("FORMAT_DATETIME")).replace(/:s/g,"")],["s","sago"],["i","iago"],["today","today, "+d],["yesterday","yesterday, "+d],["",aa.convertBitrixFormat(aa._getMessage("FORMAT_DATETIME")).replace(/:s/g,"")]],G,Q,C)},X:function(){var h=aa.isAmPmMode(true);var f=h===aa.AM_PM_MODE.LOWER?"g:i a":h===aa.AM_PM_MODE.UPPER?"g:i A":"H:i";var g=aa.format([["tomorrow","tomorrow"],["-",aa.convertBitrixFormat(aa._getMessage("FORMAT_DATE"))],["today","today"],["yesterday","yesterday"],["",aa.convertBitrixFormat(aa._getMessage("FORMAT_DATE"))]],G,Q,C);var d=aa.format([["tomorrow",f],["today",f],["yesterday",f],["",""]],G,Q,C);if(d.length>0){return aa._getMessage("FD_DAY_AT_TIME").replace(/#DAY#/g,g).replace(/#TIME#/g,d)}else{return g}},Q:function(){var d=r((Q-G)/60/60/24/1000);if(d==0){return aa._getMessage("FD_DAY_DIFF_1").replace(/#VALUE#/g,1)}else{return aa.format([["d","ddiff"],["m","mdiff"],["","Ydiff"]],G,Q)}}};var W=false;if(X[0]&&X[0]=="^"){W=true;X=X.substr(1)}var q=X.replace(v,U);if(W){q=q.replace(/\s*00:00:00\s*/g,"").replace(/(\d\d:\d\d)(:00)/g,"$1").replace(/(\s*00:00\s*)(?!:)/g,"")}if(J.length>0){J.forEach(function(f,d){q=q.replace("{{"+d+"}}",f)})}return q;function V(ak,N,T,al){var ae=r((T-N)/1000);for(var S=0;S<ak.length;S++){var ah=ak[S][0];var R=ak[S][1];var ad=null;if(ah=="s"){if(ae<60){return aa.format(R,N,T,al)}}else{if((ad=/^s(\d+)\>?(\d+)?/.exec(ah))!=null){if(ad[1]&&ad[2]){if(ae<ad[1]&&ae>ad[2]){return aa.format(R,N,T,al)}}else{if(ae<ad[1]){return aa.format(R,N,T,al)}}}else{if(ah=="i"){if(ae<60*60){return aa.format(R,N,T,al)}}else{if((ad=/^i(\d+)\>?(\d+)?/.exec(ah))!=null){if(ad[1]&&ad[2]){if(ae<ad[1]*60&&ae>ad[2]*60){return aa.format(R,N,T,al)}}else{if(ae<ad[1]*60){return aa.format(R,N,T,al)}}}else{if(ah=="H"){if(ae<24*60*60){return aa.format(R,N,T,al)}}else{if((ad=/^H(\d+)\>?(\d+)?/.exec(ah))!=null){if(ad[1]&&ad[2]){if(ae<ad[1]*60*60&&ae>ad[2]*60*60){return aa.format(R,N,T,al)}}else{if(ae<ad[1]*60*60){return aa.format(R,N,T,al)}}}else{if(ah=="d"){if(ae<31*24*60*60){return aa.format(R,N,T,al)}}else{if((ad=/^d(\d+)\>?(\d+)?/.exec(ah))!=null){if(ad[1]&&ad[2]){if(ae<ad[1]*24*60*60&&ae>ad[2]*24*60*60){return aa.format(R,N,T,al)}}else{if(ae<ad[1]*24*60*60){return aa.format(R,N,T,al)}}}else{if(ah=="m"){if(ae<365*24*60*60){return aa.format(R,N,T,al)}}else{if((ad=/^m(\d+)\>?(\d+)?/.exec(ah))!=null){if(ad[1]&&ad[2]){if(ae<ad[1]*31*24*60*60&&ae>ad[2]*31*24*60*60){return aa.format(R,N,T,al)}}else{if(ae<ad[1]*31*24*60*60){return aa.format(R,N,T,al)}}}else{if(ah=="now"){if(N.getTime()==T.getTime()){return aa.format(R,N,T,al)}}else{if(ah=="today"){var h=x(T),F=j(T),aj=Z(T);var d=al?new Date(Date.UTC(h,F,aj,0,0,0,0)):new Date(h,F,aj,0,0,0,0);var ai=al?new Date(Date.UTC(h,F,aj+1,0,0,0,0)):new Date(h,F,aj+1,0,0,0,0);if(N>=d&&N<ai){return aa.format(R,N,T,al)}}else{if(ah=="todayFuture"){var h=x(T),F=j(T),aj=Z(T);var d=T.getTime();var ai=al?new Date(Date.UTC(h,F,aj+1,0,0,0,0)):new Date(h,F,aj+1,0,0,0,0);if(N>=d&&N<ai){return aa.format(R,N,T,al)}}else{if(ah=="yesterday"){h=x(T);F=j(T);aj=Z(T);var H=al?new Date(Date.UTC(h,F,aj-1,0,0,0,0)):new Date(h,F,aj-1,0,0,0,0);var ag=al?new Date(Date.UTC(h,F,aj,0,0,0,0)):new Date(h,F,aj,0,0,0,0);if(N>=H&&N<ag){return aa.format(R,N,T,al)}}else{if(ah=="tommorow"||ah=="tomorrow"){h=x(T);F=j(T);aj=Z(T);var ac=al?new Date(Date.UTC(h,F,aj+1,0,0,0,0)):new Date(h,F,aj+1,0,0,0,0);var af=al?new Date(Date.UTC(h,F,aj+2,0,0,0,0)):new Date(h,F,aj+2,0,0,0,0);if(N>=ac&&N<af){return aa.format(R,N,T,al)}}else{if(ah=="-"){if(ae<0){return aa.format(R,N,T,al)}}}}}}}}}}}}}}}}}}return ak.length>0?aa.format(ak[ak.length-1][1],N,T,al):""}function x(d){return C?d.getUTCFullYear():d.getFullYear()}function Z(d){return C?d.getUTCDate():d.getDate()}function j(d){return C?d.getUTCMonth():d.getMonth()}function z(d){return C?d.getUTCHours():d.getHours()}function P(d){return C?d.getUTCMinutes():d.getMinutes()}function I(d){return C?d.getUTCSeconds():d.getSeconds()}function L(d){return C?d.getUTCMilliseconds():d.getMilliseconds()}function w(d){return C?d.getUTCDay():d.getDay()}function p(f,d){return C?f.setUTCDate(d):f.setDate(d)}function k(g,d,f){return C?g.setUTCMonth(d,f):g.setMonth(d,f)}function Y(h,f){var g=h<100?Math.abs(h):Math.abs(h%100);var d=g%10;var i="";if(g==0){i=aa._getMessage(f["0"])}else{if(g==1){i=aa._getMessage(f["1"])}else{if(g>=10&&g<=20){i=aa._getMessage(f["10_20"])}else{if(d==1){i=aa._getMessage(f.MOD_1)}else{if(2<=d&&d<=4){i=aa._getMessage(f.MOD_2_4)}else{i=aa._getMessage(f.MOD_OTHER)}}}}}return i.replace(/#VALUE#/g,h)}function U(f,d){if(y[f]){return y[f]()}else{return d}}function r(d){return d>=0?Math.floor(d):Math.ceil(d)}},convertBitrixFormat:function(d){if(!b.isNotEmptyString(d)){return""}return d.replace("YYYY","Y").replace("MMMM","F").replace("MM","m").replace("M","M").replace("DD","d").replace("G","g").replace(/GG/i,"G").replace("H","h").replace(/HH/i,"H").replace("MI","i").replace("SS","s").replace("TT","A").replace("T","a")},convertToUTC:function(d){if(!b.isDate(d)){return null}return new Date(Date.UTC(d.getFullYear(),d.getMonth(),d.getDate(),d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds()))},getNewDate:function(d){return new Date(this.getBrowserTimestamp(d))},getBrowserTimestamp:function(f){f=parseInt(f,10);var d=new Date(f*1000).getTimezoneOffset()*60;return(parseInt(f,10)+parseInt(this._getMessage("SERVER_TZ_OFFSET"))+d)*1000},getServerTimestamp:function(f){f=parseInt(f,10);var d=new Date(f).getTimezoneOffset()*60;return Math.round(f/1000-(parseInt(this._getMessage("SERVER_TZ_OFFSET"),10)+parseInt(d,10)))},formatLastActivityDate:function(l,h,j){var f=this.isAmPmMode(true);var m=f===this.AM_PM_MODE.LOWER?"g:i a":f===this.AM_PM_MODE.UPPER?"g:i A":"H:i";var d=[["tomorrow","#01#"+m],["now","#02#"],["todayFuture","#03#"+m],["yesterday","#04#"+m],["-",this.convertBitrixFormat(this._getMessage("FORMAT_DATETIME")).replace(/:s/g,"")],["s60","sago"],["i60","iago"],["H5","Hago"],["H24","#03#"+m],["d31","dago"],["m12>1","mago"],["m12>0","dago"],["","#05#"]];var k=this.format(d,l,h,j);var g=null;if((g=/^#(\d+)#(.*)/.exec(k))!=null){switch(g[1]){case"01":k=this._getMessage("FD_LAST_SEEN_TOMORROW").replace("#TIME#",g[2]);break;case"02":k=this._getMessage("FD_LAST_SEEN_NOW");break;case"03":k=this._getMessage("FD_LAST_SEEN_TODAY").replace("#TIME#",g[2]);break;case"04":k=this._getMessage("FD_LAST_SEEN_YESTERDAY").replace("#TIME#",g[2]);break;case"05":k=this._getMessage("FD_LAST_SEEN_MORE_YEAR");break;default:k=g[2];break}}return k},isAmPmMode:function(d){if(d===true){return this._getMessage("AMPM_MODE")}return this._getMessage("AMPM_MODE")!==false},_getMessage:function(d){return a.message(d)},parse:function(A,p,G,w){if(b.isNotEmptyString(A)){if(!G){G=this._getMessage("FORMAT_DATE")}if(!w){w=this._getMessage("FORMAT_DATETIME")}var C="";for(v=1;v<=12;v++){C=C+"|"+this._getMessage("MON_"+v)}var r=new RegExp("([0-9]+|[a-z]+"+C+")","ig"),x=A.match(r),q=G.match(/(DD|MI|MMMM|MM|M|YYYY)/gi),v,j,l=[],z=[],h={};if(!x){return null}if(x.length>q.length){q=w.match(/(DD|MI|MMMM|MM|M|YYYY|HH|H|SS|TT|T|GG|G)/gi)}for(v=0,j=x.length;v<j;v++){if(x[v].trim()!==""){l[l.length]=x[v]}}for(v=0,j=q.length;v<j;v++){if(q[v].trim()!==""){z[z.length]=q[v]}}var y=b.array_search("MMMM",z);if(y>0){l[y]=this.getMonthIndex(l[y]);z[y]="MM"}else{y=b.array_search("M",z);if(y>0){l[y]=this.getMonthIndex(l[y]);z[y]="MM"}}for(v=0,j=z.length;v<j;v++){var k=z[v].toUpperCase();h[k]=k==="T"||k==="TT"?l[v]:parseInt(l[v],10)}if(h.DD>0&&h.MM>0&&h.YYYY>0){var B=new Date;if(p){B.setUTCDate(1);B.setUTCFullYear(h.YYYY);B.setUTCMonth(h.MM-1);B.setUTCDate(h.DD);B.setUTCHours(0,0,0,0)}else{B.setDate(1);B.setFullYear(h.YYYY);B.setMonth(h.MM-1);B.setDate(h.DD);B.setHours(0,0,0,0)}if((!isNaN(h.HH)||!isNaN(h.GG)||!isNaN(h.H)||!isNaN(h.G))&&!isNaN(h.MI)){if(!isNaN(h.H)||!isNaN(h.G)){var d=(h.T||h.TT||"am").toUpperCase()==="PM",m=parseInt(h.H||h.G||0,10);if(d){h.HH=m+(m===12?0:12)}else{h.HH=m<12?m:0}}else{h.HH=parseInt(h.HH||h.GG||0,10)}if(isNaN(h.SS)){h.SS=0}if(p){B.setUTCHours(h.HH,h.MI,h.SS)}else{B.setHours(h.HH,h.MI,h.SS)}}return B}}return null},getMonthIndex:function(h){var f,g=h.toUpperCase(),d=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],i=["january","february","march","april","may","june","july","august","september","october","november","december"];for(f=1;f<=12;f++){if(g===this._getMessage("MON_"+f).toUpperCase()||g===this._getMessage("MONTH_"+f).toUpperCase()||g===d[f-1].toUpperCase()||g===i[f-1].toUpperCase()){return f}}return h}};var b={isDate:function(d){return d&&Object.prototype.toString.call(d)=="[object Date]"},isNumber:function(d){return d===0?true:d?typeof d=="number"||d instanceof Number:false},isArray:function(d){return d&&Object.prototype.toString.call(d)=="[object Array]"},isString:function(d){return d===""?true:d?typeof d=="string"||d instanceof String:false},isNotEmptyString:function(d){return this.isString(d)?d.length>0:false},strPadLeft:function(h,f,g){var d=h.length,i=g.length;if(d>=f){return h}for(;d<f;d+=i){h=g+h}return h},array_search:function(g,d){for(var f=0;f<d.length;f++){if(d[f]==g){return f}}return -1}}})(window);(function(){if(BX.date){return}BX.date=BX.Main.Date;var a=null;BX.calendar=function(b){return BX.calendar.get().Show(b)};BX.calendar.get=function(){if(!a){a=new BX.JCCalendar}return a};BX.calendar.InsertDaysBack=function(d,c){if(c!=""){var b=new Date;if(c>0){b.setTime(b.valueOf()-c*86400000)}d.value=BX.date.format(BX.date.convertBitrixFormat(BX.message("FORMAT_DATE")),b,null)}else{d.value=""}};BX.calendar.ValueToString=function(d,c,b){return BX.date.format(BX.date.convertBitrixFormat(BX.message(c?"FORMAT_DATETIME":"FORMAT_DATE")),d,null,!!b)};BX.calendar.ValueToStringFormat=function(d,c,b){return BX.date.format(BX.date.convertBitrixFormat(c),d,null,!!b)};BX.CalendarPeriod={Init:function(d,c,b){if((d.value!=""||c.value!="")&&b.value==""){b.value="interval"}b.onchange()},ChangeDirectOpts:function(d,c){var b=BX.findChild(c,{className:"adm-select adm-calendar-direction"},true);if(d=="week"){b.options[0].text=BX.message("JSADM_CALEND_PREV_WEEK");b.options[1].text=BX.message("JSADM_CALEND_CURR_WEEK");b.options[2].text=BX.message("JSADM_CALEND_NEXT_WEEK")}else{b.options[0].text=BX.message("JSADM_CALEND_PREV");b.options[1].text=BX.message("JSADM_CALEND_CURR");b.options[2].text=BX.message("JSADM_CALEND_NEXT")}},SaveAndClearInput:function(b){if(!window.SavedPeriodValues){window.SavedPeriodValues={}}window.SavedPeriodValues[b.id]=b.value;b.value=""},RestoreInput:function(b){if(!window.SavedPeriodValues||!window.SavedPeriodValues[b.id]){return}b.value=window.SavedPeriodValues[b.id];delete window.SavedPeriodValues[b.id]},OnChangeP:function(q){var w=q.parentNode.parentNode;var v,k,x,g;v=k=x=g=false;var b=BX.findChild(w,{className:"adm-input-wrap adm-calendar-inp adm-calendar-first"});var f=BX.findChild(w,{className:"adm-input-wrap adm-calendar-second"});var j=BX.findChild(w,{className:"adm-select-wrap adm-calendar-direction"});var d=BX.findChild(w,{className:"adm-calendar-separate"});var m=BX.findChild(w,{className:"adm-input adm-calendar-from"},true);var u=BX.findChild(w,{className:"adm-input adm-calendar-to"},true);switch(q.value){case"day":case"week":case"month":case"quarter":case"year":x=true;BX.CalendarPeriod.OnChangeD(j.children[0]);break;case"before":k=true;break;case"after":v=true;break;case"exact":v=true;break;case"interval":v=k=g=true;BX.CalendarPeriod.RestoreInput(m);BX.CalendarPeriod.RestoreInput(u);break;case"":BX.CalendarPeriod.SaveAndClearInput(m);BX.CalendarPeriod.SaveAndClearInput(u);break;default:break}BX.CalendarPeriod.ChangeDirectOpts(q.value,w);b.style.display=v?"inline-block":"none";f.style.display=k?"inline-block":"none";j.style.display=x?"inline-block":"none";d.style.display=g?"inline-block":"none"},OnChangeD:function(x){var C=x.parentNode.parentNode;var A=BX.findChild(C,{className:"adm-input adm-calendar-from"},true);var v=BX.findChild(C,{className:"adm-input adm-calendar-to"},true);var D=BX.findChild(C,{className:"adm-select adm-calendar-period"},true);var j=0;switch(x.value){case"previous":j=-1;break;case"next":j=1;break;case"current":default:break}var b=false;var g=false;var q=new Date;var f=q.getFullYear();var w=q.getMonth();var z=q.getDate();var B=q.getDay();if(B==0){B=7}switch(D.value){case"day":b=new Date(f,w,z+j,0,0,0);g=new Date(f,w,z+j,23,59,59);break;case"week":b=new Date(f,w,z-B+1+j*7,0,0,0);g=new Date(f,w,z+(7-B)+j*7,23,59,59);break;case"month":b=new Date(f,w+j,1,0,0,0);g=new Date(f,w+1+j,0,23,59,59);break;case"quarter":var y=Math.floor(w/3)+j;b=new Date(f,3*y,1,0,0,0);g=new Date(f,3*(y+1),0,23,59,59);break;case"year":b=new Date(f+j,0,1,0,0,0);g=new Date(f+1+j,0,0,23,59,59);break;default:break}var k=window[A.name+"_bTime"]?BX.message("FORMAT_DATETIME"):BX.message("FORMAT_DATE");if(b){A.value=BX.formatDate(b,k);BX.addClass(A,"adm-calendar-inp-setted")}if(g){v.value=BX.formatDate(g,k);BX.addClass(v,"adm-calendar-inp-setted")}}};BX.JCCalendar=function(){this.params={};this.bAmPm=BX.isAmPmMode();this.popup=null;this.popup_month=null;this.popup_year=null;this.month_popup_classname="";this.year_popup_classname="";this.value=null;this._layers={};this._current_layer=null;this.DIV=null;this.PARTS={};this.weekStart=0;this.numRows=6;this._create=function(b){this.popup=new BX.PopupWindow("calendar_popup_"+Math.random(),b.node,{closeByEsc:true,autoHide:false,content:this._get_content(),bindOptions:{forceBindPosition:true}});BX.bind(this.popup.popupContainer,"click",function(c){c.stopPropagation()})};this._auto_hide_disable=function(){BX.unbind(document,"click",BX.proxy(this._auto_hide,this))};this._auto_hide_enable=function(){BX.bind(document,"click",BX.proxy(this._auto_hide,this))};this._auto_hide=function(b){this._auto_hide_disable();this.popup.close()};this._get_content=function(){var d=BX.delegate(function(f){f=f||window.event;this.SetDate(new Date(parseInt(BX.proxy_context.getAttribute("data-date"))),f.type==="dblclick"||this.params.bCompatibility&&!this.params.bTimeVisibility)},this);this.DIV=BX.create("DIV",{props:{className:"bx-calendar"},children:[BX.create("DIV",{props:{className:"bx-calendar-header"},children:[BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-left-arrow"},events:{click:BX.proxy(this._prev,this)}}),BX.create("SPAN",{props:{className:"bx-calendar-header-content"},children:[this.PARTS.MONTH=BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-top-month"},events:{click:BX.proxy(this._menu_month,this)}}),this.PARTS.YEAR=BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-top-year"},events:{click:BX.proxy(this._menu_year,this)}})]}),BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-right-arrow"},events:{click:BX.proxy(this._next,this)}})]}),this.PARTS.WEEK=BX.create("DIV",{props:{className:"bx-calendar-name-day-wrap"}}),this.PARTS.LAYERS=BX.create("DIV",{props:{className:"bx-calendar-cell-block"},events:{click:BX.delegateEvent({className:"bx-calendar-cell"},d),dblclick:BX.delegateEvent({className:"bx-calendar-cell"},d)}}),this.PARTS.TIME=BX.create("DIV",{props:{className:"bx-calendar-set-time-wrap"},events:{click:BX.delegateEvent({attr:"data-action"},BX.delegate(this._time_actions,this))},html:'<a href="javascript:void(0)" data-action="time_show" class="bx-calendar-set-time"><i></i>'+BX.message("CAL_TIME_SET")+'</a><div class="bx-calendar-form-block"><span class="bx-calendar-form-text">'+BX.message("CAL_TIME")+'</span><span class="bx-calendar-form"><input type="text" class="bx-calendar-form-input" maxwidth="2" onkeyup="BX.calendar.get()._check_time()" /><span class="bx-calendar-form-separator"></span><input type="text" class="bx-calendar-form-input" maxwidth="2" onkeyup="BX.calendar.get()._check_time()" />'+(this.bAmPm?'<span class="bx-calendar-AM-PM-block"><span class="bx-calendar-AM-PM-text" data-action="time_ampm"></span><span class="bx-calendar-form-arrow-r"><a href="javascript:void(0)" class="bx-calendar-form-arrow-top" data-action="time_ampm_up"><i></i></a><a href="javascript:void(0)" class="bx-calendar-form-arrow-bottom" data-action="time_ampm_down"><i></i></a></span></span>':"")+'</span><a href="javascript:void(0)" data-action="time_hide" class="bx-calendar-form-close"><i></i></a></div>'}),this.PARTS.BUTTONS=BX.create("DIV",{props:{className:"bx-calendar-button-block"},events:{click:BX.delegateEvent({attr:"data-action"},BX.delegate(this._button_actions,this))},html:'<a href="javascript:void(0)" class="bx-calendar-button bx-calendar-button-select" data-action="submit"><span class="bx-calendar-button-left"></span><span class="bx-calendar-button-text">'+BX.message("CAL_BUTTON")+'</span><span class="bx-calendar-button-right"></span></a><a href="javascript:void(0)" class="bx-calendar-button bx-calendar-button-cancel" data-action="cancel"><span class="bx-calendar-button-left"></span><span class="bx-calendar-button-text">'+BX.message("JS_CORE_WINDOW_CLOSE")+'</span><span class="bx-calendar-button-right"></span></a>'})]});this.PARTS.TIME_INPUT_H=BX.findChild(this.PARTS.TIME,{tag:"INPUT"},true);this.PARTS.TIME_INPUT_M=this.PARTS.TIME_INPUT_H.nextSibling.nextSibling;if(this.bAmPm){this.PARTS.TIME_AMPM=this.PARTS.TIME_INPUT_M.nextSibling.firstChild}var c=new BX.JCSpinner({input:this.PARTS.TIME_INPUT_H,callback_change:BX.proxy(this._check_time,this),bSaveValue:false}).Show();c.className="bx-calendar-form-arrow-l";this.PARTS.TIME_INPUT_H.parentNode.insertBefore(c,this.PARTS.TIME_INPUT_H);c=new BX.JCSpinner({input:this.PARTS.TIME_INPUT_M,callback_change:BX.proxy(this._check_time,this),bSaveValue:true}).Show();c.className="bx-calendar-form-arrow-r";if(!this.PARTS.TIME_INPUT_M.nextSibling){this.PARTS.TIME_INPUT_M.parentNode.appendChild(c)}else{this.PARTS.TIME_INPUT_M.parentNode.insertBefore(c,this.PARTS.TIME_INPUT_M.nextSibling)}for(var b=0;b<7;b++){this.PARTS.WEEK.appendChild(BX.create("SPAN",{props:{className:"bx-calendar-name-day"},text:BX.message("DOW_"+(b+this.weekStart)%7)}))}return this.DIV};this._time_actions=function(){switch(BX.proxy_context.getAttribute("data-action")){case"time_show":BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-opened");if(this.params.bCompatibility){BX.removeClass(this.PARTS.BUTTONS,"bx-calendar-buttons-disabled")}this.popup.adjustPosition();break;case"time_hide":BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened");if(this.params.bCompatibility){this._saveChoice("hide");BX.addClass(this.PARTS.BUTTONS,"bx-calendar-buttons-disabled")}this.popup.adjustPosition();break;case"time_ampm":this.PARTS.TIME_AMPM.innerHTML=this.PARTS.TIME_AMPM.innerHTML=="AM"?"PM":"AM";break;case"time_ampm_up":this._check_time({bSaveValue:false},null,12);return;break;case"time_ampm_down":this._check_time({bSaveValue:false},null,-12);return;break}this._check_time()};this._button_actions=function(){switch(BX.proxy_context.getAttribute("data-action")){case"submit":if(this.params.bCompatibility){this._saveChoice("show")}this.SaveValue();break;case"cancel":this.Close();break}};this._saveChoice=function(b){if(this.params.bCategoryTimeVisibilityOption){BX.userOptions.save(this.params.bCategoryTimeVisibilityOption,this.params.bNameTimeVisibilityOption,"visibility",b==="show"?"Y":"N")}this._bTimeVisibility=b==="show";this.params.bTimeVisibility=this._bTimeVisibility};this._check_time=function(g,d,b){var c=parseInt(this.PARTS.TIME_INPUT_H.value.substring(0,5),10)||0,f=parseInt(this.PARTS.TIME_INPUT_M.value.substring(0,5),10)||0,h=false;if(!!g&&!g.bSaveValue){this.value.setUTCHours(this.value.getUTCHours()+b)}else{if(!isNaN(c)){if(this.bAmPm){if(c!=12&&this.PARTS.TIME_AMPM.innerHTML=="PM"){c+=12}}h=true;this.value.setUTCHours(c%24)}}if(!isNaN(f)){h=true;this.value.setUTCMinutes(f%60)}if(h){this.SetValue(this.value)}};this._set_layer=function(){var f=parseInt(this.value.getUTCFullYear()+""+BX.util.str_pad_left(this.value.getUTCMonth()+"",2,"0"));if(!this._layers[f]){this._layers[f]=this._create_layer();this._layers[f].BXLAYERID=f}if(this._current_layer){var d=new Date(this.value.valueOf());d.setUTCHours(0);d.setUTCMinutes(0);var b=BX.findChild(this._layers[f],{tag:"A",className:"bx-calendar-active"},true),c=BX.findChild(this._layers[f],{tag:"A",attr:{"data-date":d.valueOf()+""}},true);if(b){BX.removeClass(b,"bx-calendar-active")}if(c){BX.addClass(c,"bx-calendar-active")}this._replace_layer(this._current_layer,this._layers[f])}else{this.PARTS.LAYERS.appendChild(this._layers[f])}this._current_layer=this._layers[f]};this._replace_layer=function(h,d){if(h!=d){if(!BX.browser.IsIE()||BX.browser.IsDoctype()){var b=h.BXLAYERID>d.BXLAYERID?1:-1;var c=0;var f=-b*h.offsetHeight;h.style.position="relative";h.style.top="0px";h.style.zIndex=5;d.style.position="absolute";d.style.top=f+"px";d.style.zIndex=6;this.PARTS.LAYERS.appendChild(d);var j=15;var g;(g=function(){f+=b*j;c+=b*j;if(b*f<0){h.style.top=c+"px";d.style.top=f+"px";setTimeout(g,10)}else{h.parentNode.removeChild(h);d.style.top="0px";d.style.position="static";d.style.zIndex=0}})()}else{this.PARTS.LAYERS.replaceChild(d,h)}}};this._create_layer=function(){var j=BX.create("DIV",{props:{className:"bx-calendar-layer"}});var m=new Date(this.value);m.setUTCHours(0);m.setUTCMinutes(0);m.setUTCDate(1);if(m.getUTCDay()!=this.weekStart){var k=m.getUTCDay()-this.weekStart;k+=k<0?7:0;m.setUTCDate(m.getUTCDate()-k)}var h=this.value.getUTCMonth(),q=this.value.getUTCDate(),f="";for(var b=0;b<this.numRows;b++){f+='<div class="bx-calendar-range'+(b==this.numRows-1?" bx-calendar-range-noline":"")+'">';for(var d=0;d<7;d++){k=m.getUTCDate();var g=m.getUTCDay();var c="bx-calendar-cell";if(h!=m.getUTCMonth()){c+=" bx-calendar-date-hidden"}else{if(q==k){c+=" bx-calendar-active"}}if(g==0||g==6){c+=" bx-calendar-weekend"}f+='<a href="javascript:void(0)" class="'+c+'" data-date="'+m.valueOf()+'">'+k+"</a>";m.setUTCDate(m.getUTCDate()+1)}f+="</div>"}j.innerHTML=f;return j};this._prev=function(){this.SetMonth(this.value.getUTCMonth()-1)};this._next=function(){this.SetMonth(this.value.getUTCMonth()+1)};this._menu_month_content=function(){var d="",c=this.value.getMonth(),b;for(b=0;b<12;b++){d+='<span class="bx-calendar-month'+(b==c?" bx-calendar-month-active":"")+'" data-bx-month="'+b+'">'+BX.message("MONTH_"+(b+1))+"</span>"}return'<div class="bx-calendar-month-popup"><div class="bx-calendar-month-title" data-bx-month="'+this.value.getUTCMonth()+'">'+BX.message("MONTH_"+(this.value.getUTCMonth()+1))+'</div><div class="bx-calendar-month-content">'+d+"</div></div>"};this._menu_month=function(){if(!this.popup_month){this.popup_month=new BX.PopupWindow("calendar_popup_month_"+Math.random(),this.PARTS.MONTH,{content:this._menu_month_content(),closeByEsc:true,autoHide:true,offsetTop:-29,offsetLeft:-1,className:this.month_popup_classname,events:{onPopupShow:BX.delegate(function(){if(this.popup_year){this.popup_year.close()}},this)}});BX.bind(this.popup_month.popupContainer,"click",BX.proxy(this.month_popup_click,this));this.popup_month.BXMONTH=this.value.getUTCMonth()}else{if(this.popup_month.BXMONTH!=this.value.getUTCMonth()){this.popup_month.setContent(this._menu_month_content());this.popup_month.BXMONTH=this.value.getUTCMonth()}}this.popup_month.show()};this.month_popup_click=function(c){var b=c.target||c.srcElement;if(b&&b.getAttribute&&b.getAttribute("data-bx-month")){this.SetMonth(parseInt(b.getAttribute("data-bx-month")));this.popup_month.close()}};this._menu_year_content=function(){var c='<div class="bx-calendar-year-popup"><div class="bx-calendar-year-title" data-bx-year="'+this.value.getUTCFullYear()+'">'+this.value.getUTCFullYear()+'</div><div class="bx-calendar-year-content" id="bx-calendar-year-content">';for(var b=-3;b<=3;b++){c+='<span class="bx-calendar-year-number'+(b==0?" bx-calendar-year-active":"")+'" data-bx-year="'+(this.value.getUTCFullYear()-b)+'">'+(this.value.getUTCFullYear()-b)+"</span>"}c+='</div><input data-bx-year-input="Y" type="text" class="bx-calendar-year-input" maxlength="4" /></div>';return c};this._menu_year=function(){if(!this.popup_year){this.popup_year=new BX.PopupWindow("calendar_popup_year_"+Math.random(),this.PARTS.YEAR,{content:this._menu_year_content(),closeByEsc:true,autoHide:true,offsetTop:-29,offsetLeft:-1,className:this.year_popup_classname,events:{onPopupShow:BX.delegate(function(){if(this.popup_month){this.popup_month.close()}},this)}});BX.bind(this.popup_year.popupContainer,"click",BX.proxy(this.year_popup_click,this));BX.bind(this.popup_year.popupContainer,"keyup",BX.proxy(this.year_popup_keyup,this));this.popup_year.BXYEAR=this.value.getUTCFullYear()}else{if(this.popup_year.BXYEAR!=this.value.getUTCFullYear()){this.popup_year.setContent(this._menu_year_content());this.popup_year.BXYEAR=this.value.getUTCFullYear()}}this.popup_year.show()};this.year_popup_click=function(c){var b=c.target||c.srcElement;if(b&&b.getAttribute&&b.getAttribute("data-bx-year")){this.SetYear(parseInt(b.getAttribute("data-bx-year")));this.popup_year.close()}};this.year_popup_keyup=function(d){var c=d.target||d.srcElement;if(c&&c.getAttribute&&c.getAttribute("data-bx-year-input")=="Y"){var b=parseInt(c.value);if(b>=1900&&b<=2100){this.SetYear(b);this.popup_year.close()}}};this._check_date=function(c){var b=c;if(BX.type.isString(c)){b=BX.parseDate(c,true)}if(!BX.type.isDate(b)||isNaN(b.valueOf())){b=BX.date.convertToUTC(new Date);if(this.params.bHideTime){b.setUTCHours(0);b.setUTCMinutes(0)}}b.setUTCMilliseconds(0);b.setUTCSeconds(0);b.BXCHECKED=true;return b}};BX.JCCalendar.prototype.Show=function(f){if(!BX.isReady){BX.ready(BX.delegate(function(){this.Show(f)},this));return}f.node=f.node||document.body;if(BX.type.isNotEmptyString(f.node)){var d=BX(f.node);if(!d){d=document.getElementsByName(f.node);if(d&&d.length>0){d=d[0]}}f.node=d}if(!f.node){return}if(!!f.field){if(BX.type.isString(f.field)){d=BX(f.field);if(!!d){f.field=d}else{if(f.form){if(BX.type.isString(f.form)){f.form=document.forms[f.form]}}if(BX.type.isDomNode(f.form)&&!!f.form[f.field]){f.field=f.form[f.field]}else{d=document.getElementsByName(f.field);if(d&&d.length>0){d=d[0];f.field=d}}}if(BX.type.isString(f.field)){f.field=BX(f.field)}}}var b=!this.popup||!this.popup.isShown()||this.params.node!=f.node;this.params=f;this.params.bCompatibility=typeof this.params.bCompatibility=="undefined"?false:this.params.bCompatibility;this.params.bTimeVisibility=typeof this.params.bTimeVisibility=="undefined"?!this.params.bCompatibility:this.params.bTimeVisibility;if(this.params.bCompatibility){this.params.bCategoryTimeVisibilityOption=this.params.bCategoryTimeVisibilityOption?this.params.bCategoryTimeVisibilityOption:"";this.params.bNameTimeVisibilityOption=this.params.bNameTimeVisibilityOption?this.params.bNameTimeVisibilityOption:"time_visibility";if(typeof this._bTimeVisibility!=="undefined"){this.params.bTimeVisibility=this._bTimeVisibility}}this.params.bTime=typeof this.params.bTime=="undefined"?true:!!this.params.bTime;this.params.bHideTime=typeof this.params.bHideTime=="undefined"?true:!!this.params.bHideTime;this.params.bUseSecond=typeof this.params.bUseSecond=="undefined"?true:!!this.params.bUseSecond;this.weekStart=parseInt(this.params.weekStart||this.params.weekStart||BX.message("WEEK_START"));if(isNaN(this.weekStart)){this.weekStart=1}if(!this.popup){this._create(this.params)}else{this.popup.setBindElement(this.params.node)}var c=!!this.params.bHideTime;if(this.params.value){this.SetValue(this.params.value);c=this.value.getUTCHours()<=0&&this.value.getUTCMinutes()<=0}else{if(this.params.field){this.SetValue(this.params.field.value);c=this.value.getUTCHours()<=0&&this.value.getUTCMinutes()<=0}else{if(!!this.params.currentTime){this.SetValue(this.params.currentTime)}else{this.SetValue()}}}if(!!this.params.bTime){this.activateTimeStyle(c)}else{this.activateDateStyle(c)}if(b){this._auto_hide_disable();this.popup.show();setTimeout(BX.proxy(this._auto_hide_enable,this),0)}this.params.bSetFocus=typeof this.params.bSetFocus=="undefined"?true:!!this.params.bSetFocus;if(this.params.bSetFocus){f.node.blur()}else{BX.bind(f.node,"keyup",BX.defer(function(){this.SetValue(f.node.value);if(!!this.params.bTime){if(this.value.getUTCHours()<=0&&this.value.getUTCMinutes()<=0){BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened")}else{BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-opened")}}},this))}return this};BX.JCCalendar.prototype.activateDateStyle=function(b){BX.addClass(this.DIV,"bx-calendar-time-disabled");if(!!b){BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened")}else{BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-opened")}};BX.JCCalendar.prototype.activateTimeStyle=function(b){if(this.params.bCompatibility&&!this.params.bTimeVisibility){BX.addClass(this.PARTS.BUTTONS,"bx-calendar-buttons-disabled");BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-wrap-simple");BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened")}else{BX.removeClass(this.DIV,"bx-calendar-time-disabled");if(!!b){BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened")}else{BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-opened")}}};BX.JCCalendar.prototype.SetDay=function(b){this.value.setUTCDate(b);return this.SetValue(this.value)};BX.JCCalendar.prototype.SetMonth=function(b){if(this.popup_month){this.popup_month.close()}this.value.setUTCMonth(b);if(b<0){b+=12}else{if(b>=12){b-=12}}while(this.value.getUTCMonth()>b){this.value.setUTCDate(this.value.getUTCDate()-1)}return this.SetValue(this.value)};BX.JCCalendar.prototype.SetYear=function(b){if(this.popup_year){this.popup_year.close()}this.value.setUTCFullYear(b);return this.SetValue(this.value)};BX.JCCalendar.prototype.SetDate=function(c,b){c=this._check_date(c);c.setUTCHours(this.value.getUTCHours());c.setUTCMinutes(this.value.getUTCMinutes());c.setUTCSeconds(this.value.getUTCSeconds());if(this.params.bTime&&!b){return this.SetValue(c)}else{this.SetValue(c);this.SaveValue()}};BX.JCCalendar.prototype.SetValue=function(c){this.value=c&&c.BXCHECKED?c:this._check_date(c);this.PARTS.MONTH.innerHTML=BX.message("MONTH_"+(this.value.getUTCMonth()+1));this.PARTS.YEAR.innerHTML=this.value.getUTCFullYear();if(!!this.params.bTime){var b=this.value.getUTCHours();if(this.bAmPm){if(b>=12){this.PARTS.TIME_AMPM.innerHTML="PM";if(b!=12){b-=12}}else{this.PARTS.TIME_AMPM.innerHTML="AM";if(b==0){b=12}}}this.PARTS.TIME_INPUT_H.value=BX.util.str_pad_left(b.toString(),2,"0");this.PARTS.TIME_INPUT_M.value=BX.util.str_pad_left(this.value.getUTCMinutes().toString(),2,"0")}this._set_layer();return this};BX.JCCalendar.prototype.SaveValue=function(){if(this.popup_month){this.popup_month.close()}if(this.popup_year){this.popup_year.close()}var f=true;if(!!this.params.callback){var d=this.params.callback.apply(this,[new Date(this.value.valueOf()+this.value.getTimezoneOffset()*60000)]);if(d===false){f=false}}if(f){var b=!!this.params.bTime&&BX.hasClass(this.PARTS.TIME,"bx-calendar-set-time-opened");if(this.params.field){var c=BX.message(b?"FORMAT_DATETIME":"FORMAT_DATE");if(b&&!this.params.bUseSecond){c=c.replace(":SS","")}this.params.field.value=BX.calendar.ValueToStringFormat(this.value,c,true);BX.fireEvent(this.params.field,"change")}this.popup.close();if(!!this.params.callback_after){this.params.callback_after.apply(this,[new Date(this.value.valueOf()+this.value.getTimezoneOffset()*60000),b])}}return this};BX.JCCalendar.prototype.Close=function(){if(!!this.popup){this.popup.close()}return this};BX.JCSpinner=function(b){b=b||{};this.params={input:b.input||null,delta:b.delta||1,timeout_start:b.timeout_start||1000,timeout_cont:b.timeout_cont||150,callback_start:b.callback_start||null,callback_change:b.callback_change||null,callback_finish:b.callback_finish||null,bSaveValue:typeof b.bSaveValue=="undefined"?!!b.input:!!b.bSaveValue};this.mousedown=false;this.direction=1};BX.JCSpinner.prototype.Show=function(){this.node=BX.create("span",{events:{mousedown:BX.delegateEvent({attr:"data-dir"},BX.delegate(this.Start,this))},html:'<a href="javascript:void(0)" class="bx-calendar-form-arrow bx-calendar-form-arrow-top" data-dir="1"><i></i></a><a href="javascript:void(0)" class="bx-calendar-form-arrow bx-calendar-form-arrow-bottom" data-dir="-1"><i></i></a>'});return this.node};BX.JCSpinner.prototype.Start=function(){this.mousedown=true;this.direction=BX.proxy_context.getAttribute("data-dir")>0?1:-1;BX.bind(document,"mouseup",BX.proxy(this.MouseUp,this));this.ChangeValue(true)};BX.JCSpinner.prototype.ChangeValue=function(c){if(!this.mousedown){return}if(this.params.input){var b=parseInt(this.params.input.value,10)+this.params.delta*this.direction;if(this.params.bSaveValue){this.params.input.value=b}if(!!c&&this.params.callback_start){this.params.callback_start(this.params,b,this.direction)}if(this.params.callback_change){this.params.callback_change(this.params,b,this.direction)}setTimeout(BX.proxy(this.ChangeValue,this),!!c?this.params.timeout_start:this.params.timeout_cont)}};BX.JCSpinner.prototype.MouseUp=function(){this.mousedown=false;BX.unbind(document,"mouseup",BX.proxy(this.MouseUp,this));if(this.params.callback_finish){this.params.callback_finish(this.params,this.params.input.value)}};window.jsCalendar={Show:function(h,d,b,c,f,k,g,j){return BX.calendar({node:h,field:d,form:g,bTime:!!f,currentTime:k,bHideTimebar:!!j})},ValueToString:BX.calendar.ValueToString};BX.CClockSelector=function(b){this.params=b;this.params.popup_buttons=this.params.popup_buttons||[new BX.PopupWindowButton({text:BX.message("CAL_BUTTON"),className:"popup-window-button-create",events:{click:BX.proxy(this.setValue,this)}})];this.isReady=false;this.WND=new BX.PopupWindow(this.params.popup_id||"clock_selector_popup",this.params.node,this.params.popup_config||{titleBar:BX.message("CAL_TIME"),offsetLeft:-45,offsetTop:-135,autoHide:true,closeIcon:true,closeByEsc:true});this.SHOW=false;BX.addCustomEvent(this.WND,"onPopupClose",BX.delegate(this.onPopupClose,this));this.obClocks={};this.CLOCK_ID=this.params.clock_id||"clock_selector"};BX.CClockSelector.prototype.Show=function(){if(!this.isReady){BX.addCustomEvent("onClockRegister",BX.proxy(this.onClockRegister,this));return BX.ajax.get("/bitrix/tools/clock_selector.php",{start_time:this.params.start_time,clock_id:this.CLOCK_ID,sessid:BX.bitrix_sessid()},BX.delegate(this.Ready,this))}this.WND.setButtons(this.params.popup_buttons);this.WND.show();this.SHOW=true;if(window["bxClock_"+this.obClocks[this.CLOCK_ID]]){setTimeout("window['bxClock_"+this.obClocks[this.CLOCK_ID]+"'].CalculateCoordinates()",40)}return true};BX.CClockSelector.prototype.onClockRegister=function(b){if(b[this.CLOCK_ID]){this.obClocks[this.CLOCK_ID]=b[this.CLOCK_ID];BX.removeCustomEvent("onClockRegister",BX.proxy(this.onClockRegister,this))}};BX.CClockSelector.prototype.Ready=function(b){this.content=this.CreateContent(b);this.WND.setContent(this.content);this.isReady=true;setTimeout(BX.proxy(this.Show,this),30)};BX.CClockSelector.prototype.CreateContent=function(b){return BX.create("DIV",{events:{click:BX.PreventDefault},html:'<div class="bx-tm-popup-clock">'+b+"</div>"})};BX.CClockSelector.prototype.setValue=function(c){if(this.params.callback){var b=BX.findChild(this.content,{tagName:"INPUT"},true);this.params.callback.apply(this.params.node,[b.value])}return BX.PreventDefault(c)};BX.CClockSelector.prototype.closeWnd=function(b){this.WND.close();return b||window.event?BX.PreventDefault(b):true};BX.CClockSelector.prototype.setNode=function(b){this.WND.setBindElement(b)};BX.CClockSelector.prototype.setTime=function(b){this.params.start_time=b;if(window["bxClock_"+this.obClocks[this.CLOCK_ID]]){window["bxClock_"+this.obClocks[this.CLOCK_ID]].SetTime(parseInt(b/3600),parseInt(b%3600/60))}};BX.CClockSelector.prototype.setCallback=function(b){this.params.callback=b};BX.CClockSelector.prototype.onPopupClose=function(){this.SHOW=false}})();var phpVars;if(!phpVars){phpVars={ADMIN_THEME_ID:".default",LANGUAGE_ID:"en",FORMAT_DATE:"DD.MM.YYYY",FORMAT_DATETIME:"DD.MM.YYYY HH:MI:SS",opt_context_ctrl:false,cookiePrefix:"BITRIX_SM",titlePrefix:"",bitrix_sessid:"",messHideMenu:"",messShowMenu:"",messHideButtons:"",messShowButtons:"",messFilterInactive:"",messFilterActive:"",messFilterLess:"",messLoading:"Loading...",messMenuLoading:"",messMenuLoadingTitle:"",messNoData:"",messExpandTabs:"",messCollapseTabs:"",messPanelFixOn:"",messPanelFixOff:"",messPanelCollapse:"",messPanelExpand:""}}var jsUtils={arEvents:Array(),addEvent:function(c,b,d,a){if(c.attachEvent){c.attachEvent("on"+b,d)}else{if(c.addEventListener){c.addEventListener(b,d,false)}else{c["on"+b]=d}}this.arEvents[this.arEvents.length]={element:c,event:b,fn:d}},removeEvent:function(b,a,c){if(b.detachEvent){b.detachEvent("on"+a,c)}else{if(b.removeEventListener){b.removeEventListener(a,c,false)}else{b["on"+a]=null}}},removeAllEvents:function(b){var a;for(a=0;a<this.arEvents.length;a++){if(this.arEvents[a]&&(b==false||b==this.arEvents[a].element)){jsUtils.removeEvent(this.arEvents[a].element,this.arEvents[a].event,this.arEvents[a].fn);this.arEvents[a]=null}}if(b==false){this.arEvents.length=0}},IsDoctype:function(){if(document.compatMode){return document.compatMode=="CSS1Compat"}if(document.documentElement&&document.documentElement.clientHeight){return true}return false},GetRealPos:function(b){if(window.BX){return BX.pos(b)}if(!b||!b.offsetParent){return false}var a=Array();a.left=b.offsetLeft;a.top=b.offsetTop;var c=b.offsetParent;while(c&&c.tagName!="BODY"){a.left+=c.offsetLeft;a.top+=c.offsetTop;c=c.offsetParent}a.right=a.left+b.offsetWidth;a.bottom=a.top+b.offsetHeight;return a},FindChildObject:function(k,p,d,h){if(!k){return null}var c=p.toUpperCase();var b=d?d.toLowerCase():null;var q=k.childNodes.length;for(var g=0;g<q;g++){var m=k.childNodes[g];if(m.tagName&&m.tagName.toUpperCase()==c){if(!d||m.className.toLowerCase()==b){return m}}if(h==true){var j;if(j=jsUtils.FindChildObject(m,p,d,true)){return j}}}return null},FindParentObject:function(f,b,h){if(!f){return null}var a=f;var g=b.toUpperCase();var d=h?h.toLowerCase():null;while(a.parentNode){var c=a.parentNode;if(c.tagName&&c.tagName.toUpperCase()==g){if(!h||c.className.toLowerCase()==d){return c}}a=c}return null},FindNextSibling:function(c,b){if(!c){return null}var f=c;var a=b.toUpperCase();while(f.nextSibling){var d=f.nextSibling;if(d.tagName&&d.tagName.toUpperCase()==a){return d}f=d}return null},FindPreviousSibling:function(c,b){if(!c){return null}var f=c;var a=b.toUpperCase();while(f.previousSibling){var d=f.previousSibling;if(d.tagName&&d.tagName.toUpperCase()==a){return d}f=d}return null},bOpera:navigator.userAgent.toLowerCase().indexOf("opera")!=-1,bIsIE:document.attachEvent&&navigator.userAgent.toLowerCase().indexOf("opera")==-1,IsIE:function(){return this.bIsIE},IsOpera:function(){return this.bOpera},IsSafari:function(){var a=navigator.userAgent.toLowerCase();return/webkit/.test(a)},IsEditor:function(){var b=navigator.userAgent.toLowerCase();var a=(b.match(/.+(msie)[\/: ]([\d.]+)/)||[])[2];var c=/webkit/.test(b);if(this.IsOpera()||document.all&&!document.compatMode&&a<6||c){return false}return true},ToggleDiv:function(b){var a=document.getElementById(b).style;if(a.display!="none"){a.display="none"}else{a.display="block"}return a.display!="none"},urlencode:function(a){return escape(a).replace(new RegExp("\\+","g"),"%2B")},OpenWindow:function(c,b,f){var a=screen.width,d=screen.height;if(this.IsOpera()){a=document.body.offsetWidth;d=document.body.offsetHeight}window.open(c,"","status=no,scrollbars=yes,resizable=yes,width="+b+",height="+f+",top="+Math.floor((d-f)/2-14)+",left="+Math.floor((a-b)/2-5))},SetPageTitle:function(b){document.title=phpVars.titlePrefix+b;var a=document.getElementsByTagName("H1");if(a){a[0].innerHTML=b}},LoadPageToDiv:function(b,a){var c=document.getElementById(a);if(!c){return}CHttpRequest.Action=function(d){CloseWaitWindow();document.getElementById(a).innerHTML=d};ShowWaitWindow();CHttpRequest.Send(b)},trim:function(b){if(typeof b=="string"||typeof b=="object"&&b.constructor==String){var a,c;c=/^[\s\r\n]+/g;a=b.replace(c,"");c=/[\s\r\n]+$/g;a=a.replace(c,"");return a}else{return b}},Redirect:function(c,b){var d=null,a=false;if(c&&c.length>0){d=c[0]}if(!d){d=window.event}if(d){a=d.shiftKey}if(a){window.open(b)}else{window.location.href=b}},False:function(){return false},AlignToPos:function(f,b,h){var a=f.left,g=f.bottom;var d=jsUtils.GetWindowScrollPos();var c=jsUtils.GetWindowInnerSize();if(c.innerWidth+d.scrollLeft-(f.left+b)<0){if(f.right-b>=0){a=f.right-b}else{a=d.scrollLeft}}if(c.innerHeight+d.scrollTop-(f.bottom+h)<0){if(f.top-h>=0){g=f.top-h}else{g=d.scrollTop}}return{left:a,top:g}},EvalGlobal:function(e){try{if(window.execScript){window.execScript(e,"javascript")}else{if(jsUtils.IsSafari()){window.setTimeout(e,0)}else{window.eval(e)}}}catch(e){}},GetStyleValue:function(b,a){var c;if(b.currentStyle){c=b.currentStyle[a]}else{if(window.getComputedStyle){c=document.defaultView.getComputedStyle(b,null).getPropertyValue(a)}}if(!c){c=""}return c},GetWindowInnerSize:function(b){var a,c;if(!b){b=document}if(self.innerHeight){a=self.innerWidth;c=self.innerHeight}else{if(b.documentElement&&(b.documentElement.clientHeight||b.documentElement.clientWidth)){a=b.documentElement.clientWidth;c=b.documentElement.clientHeight}else{if(b.body){a=b.body.clientWidth;c=b.body.clientHeight}}}return{innerWidth:a,innerHeight:c}},GetWindowScrollPos:function(b){var a,c;if(!b){b=document}if(self.pageYOffset){a=self.pageXOffset;c=self.pageYOffset}else{if(b.documentElement&&(b.documentElement.scrollTop||b.documentElement.scrollLeft)){a=document.documentElement.scrollLeft;c=document.documentElement.scrollTop}else{if(b.body){a=b.body.scrollLeft;c=b.body.scrollTop}}}return{scrollLeft:a,scrollTop:c}},GetWindowScrollSize:function(b){var a,c;if(!b){b=document}if(b.compatMode&&b.compatMode=="CSS1Compat"){a=b.documentElement.scrollWidth;c=b.documentElement.scrollHeight}else{if(b.body.scrollHeight>b.body.offsetHeight){c=b.body.scrollHeight}else{c=b.body.offsetHeight}if(b.body.scrollWidth>b.body.offsetWidth||b.compatMode&&b.compatMode=="BackCompat"||b.documentElement&&!b.documentElement.clientWidth){a=b.body.scrollWidth}else{a=b.body.offsetWidth}}return{scrollWidth:a,scrollHeight:c}},GetWindowSize:function(){var b=jsUtils.GetWindowInnerSize();var a=jsUtils.GetWindowScrollPos();var c=jsUtils.GetWindowScrollSize();return{innerWidth:b.innerWidth,innerHeight:b.innerHeight,scrollLeft:a.scrollLeft,scrollTop:a.scrollTop,scrollWidth:c.scrollWidth,scrollHeight:c.scrollHeight}},arCustomEvents:{},addCustomEvent:function(c,b,d,a){if(!this.arCustomEvents[c]){this.arCustomEvents[c]=[]}if(!d){d=[]}if(!a){a=false}this.arCustomEvents[c].push({handler:b,arParams:d,obj:a})},removeCustomEvent:function(c,b){if(!this.arCustomEvents[c]){return}var d=this.arCustomEvents[c].length;if(d==1){delete this.arCustomEvents[c];return}for(var a=0;a<d;a++){if(!this.arCustomEvents[c][a]){continue}if(this.arCustomEvents[c][a].handler==b){delete this.arCustomEvents[c][a];return}}},onCustomEvent:function(c,b){if(!this.arCustomEvents[c]){return}if(!b){b=[]}var f;for(var a=0,d=this.arCustomEvents[c].length;a<d;a++){f=this.arCustomEvents[c][a];if(!f||!f.handler){continue}if(f.obj){f.handler.call(f.obj,f.arParams,b)}else{f.handler(f.arParams,b)}}},loadJSFile:function(c,b,f){if(!f){f=document}if(typeof c=="string"){c=[c]}var a=function(){if(!b){return}if(typeof b=="function"){return b()}if(typeof b!="object"||!b.func){return}var g=b.params||{};if(b.obj){b.func.apply(b.obj,g)}else{b.func(g)}};var d=function(e){if(e>=c.length){return a()}var h=f.body.appendChild(f.createElement("script"));h.src=c[e];var g=false;h.onload=h.onreadystatechange=function(){if(!g&&(!h.readyState||h.readyState=="loaded"||h.readyState=="complete")){g=true;setTimeout(function(){d(++e)},50)}}};d(0)},loadCSSFile:function(h,k,d){if(typeof h=="string"){var g=true;h=[h]}var c,b=h.length,m=[];if(b==0){return}if(!k){k=document}if(!d){d=window}if(!d.bxhead){var f=k.getElementsByTagName("HEAD");d.bxhead=f[0]}if(!d.bxhead){return}for(c=0;c<b;c++){var j=document.createElement("LINK");j.href=h[c];j.rel="stylesheet";j.type="text/css";d.bxhead.appendChild(j);m.push(j)}if(g){return j}return m},appendBXHint:function(b,a){if(!b||!b.parentNode||!a){return}var c=new BXHint(a);b.parentNode.insertBefore(c.oIcon,b);b.parentNode.removeChild(b);c.oIcon.style.marginLeft="5px"},PreventDefault:function(a){if(!a){a=window.event}if(a.stopPropagation){a.preventDefault();a.stopPropagation()}else{a.cancelBubble=true;a.returnValue=false}return false},CreateElement:function(d,b,g,a){if(!a){a=document}var f=a.createElement(d),c;if(b){for(c in b){if(c=="className"||c=="class"){f.setAttribute("class",b[c]);if(jsUtils.IsIE()){f.setAttribute("className",b[c])}continue}if(b[c]!=undefined&&b[c]!=null){f.setAttribute(c,b[c])}}}if(g){for(c in g){f.style[c]=g[c]}}return f},in_array:function(b,a){for(var c=0;c<a.length;c++){if(a[c]==b){return true}}return false},htmlspecialchars:function(a){if(!a.replace){return a}return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}};function JCFloatDiv(){var a=this;this.floatDiv=null;this.x=this.y=0;this.Create=function(c){var b=document.body.appendChild(document.createElement("DIV"));b.id=c.id;b.style.position="absolute";b.style.left="-10000px";b.style.top="-10000px";if(c.className){b.className=c.className}if(c.zIndex){b.style.zIndex=c.zIndex}if(c.width){b.style.width=c.width+"px"}if(c.height){b.style.height=c.height+"px"}return b};this.Show=function(f,c,h,b,g){var d=BX.ZIndexManager.getComponent(f);if(!d){BX.ZIndexManager.register(f)}BX.ZIndexManager.bringToFront(f);if(c<0){c=0}if(h<0){h=0}f.style.left=parseInt(c)+"px";f.style.top=parseInt(h)+"px";f.restrictDrag=g||false;if(isNaN(b)){b=5}f.dxShadow=b};this.Close=function(c){if(!c){return}var b=document.getElementById(c.id+"_shadow");if(b){b.style.visibility="hidden"}var d=document.getElementById(c.id+"_frame");if(d){d.style.visibility="hidden"}};this.Move=function(g,c,j){if(!g){return}var b=g.dxShadow;var h=parseInt(g.style.left)+c;var f=parseInt(g.style.top)+j;if(g.restrictDrag){if(h<0){h=0}if(document.compatMode&&document.compatMode=="CSS1Compat"){windowWidth=document.documentElement.scrollWidth}else{if(document.body.scrollWidth>document.body.offsetWidth||document.compatMode&&document.compatMode=="BackCompat"||document.documentElement&&!document.documentElement.clientWidth){windowWidth=document.body.scrollWidth}else{windowWidth=document.body.offsetWidth}}var d=g.offsetWidth;if(h>windowWidth-d-b){h=windowWidth-d-b}if(f<0){f=0}}g.style.left=h+"px";g.style.top=f+"px";this.AdjustShadow(g)};this.HideShadow=function(c){var b=document.getElementById(c.id+"_shadow");b.style.visibility="hidden"};this.UnhideShadow=function(c){var b=document.getElementById(c.id+"_shadow");b.style.visibility="visible"};this.AdjustShadow=function(d){var c=document.getElementById(d.id+"_shadow");if(c&&c.style.visibility!="hidden"){var f=d.dxShadow;c.style.width=d.offsetWidth+"px";c.style.height=d.offsetHeight+"px";c.style.left=parseInt(d.style.left)+f+"px";c.style.top=parseInt(d.style.top)+f+"px"}var b=document.getElementById(d.id+"_frame");if(b){b.style.width=d.offsetWidth+"px";b.style.height=d.offsetHeight+"px";b.style.left=d.style.left;b.style.top=d.style.top}};this.StartDrag=function(c,d){if(!c){c=window.event}this.x=c.clientX+document.body.scrollLeft;this.y=c.clientY+document.body.scrollTop;this.floatDiv=d;jsUtils.addEvent(document,"mousemove",this.MoveDrag);document.onmouseup=this.StopDrag;if(document.body.setCapture){document.body.setCapture()}document.onmousedown=jsUtils.False;var b=document.body;b.ondrag=jsUtils.False;b.onselectstart=jsUtils.False;b.style.MozUserSelect=a.floatDiv.style.MozUserSelect="none";b.style.cursor="move"};this.StopDrag=function(b){if(document.body.releaseCapture){document.body.releaseCapture()}jsUtils.removeEvent(document,"mousemove",a.MoveDrag);document.onmouseup=null;this.floatDiv=null;document.onmousedown=null;var c=document.body;c.ondrag=null;c.onselectstart=null;c.style.MozUserSelect=a.floatDiv.style.MozUserSelect="";c.style.cursor=""};this.MoveDrag=function(c){var d=c.clientX+document.body.scrollLeft;var b=c.clientY+document.body.scrollTop;if(a.x==d&&a.y==b){return}a.Move(a.floatDiv,d-a.x,b-a.y);a.x=d;a.y=b}}var jsFloatDiv=new JCFloatDiv;var BXHint=function(b,a,c){this.oDivOver=false;this.timeOutID=null;this.oIcon=null;this.freeze=false;this.x=0;this.y=0;this.time=700;if(!b){b=""}this.Create(b,a,c)};BXHint.prototype.Create=function(g,c,j){var b=this,h=0,f=0,d=null,a="icon";this.bWidth=true;if(j){if(j.width===false){this.bWidth=false}else{if(j.width){h=j.width}}if(j.height){f=j.height}if(j.className){d=j.className}if(j.type&&(j.type=="link"||j.type=="icon")){a=j.type}if(j.time>0){this.time=j.time}}if(c){a="element"}if(a=="icon"){var c=document.createElement("IMG");c.src=j&&j.iconSrc?j.iconSrc:"/bitrix/themes/"+phpVars.ADMIN_THEME_ID+"/public/popup/hint.gif";c.ondrag=jsUtils.False}else{if(a=="link"){var c=document.createElement("A");c.href="";c.onclick=function(i){return false};c.innerHTML="[?]"}}this.element=c;if(a=="element"){if(j&&j.show_on_click){jsUtils.addEvent(c,"click",function(e){if(!e){e=window.event}b.GetMouseXY(e);b.timeOutID=setTimeout(function(){b.Show(g,h,f,d)},10)})}else{jsUtils.addEvent(c,"mouseover",function(e){if(!e){e=window.event}b.GetMouseXY(e);b.timeOutID=setTimeout(function(){b.Show(g,h,f,d)},750)})}jsUtils.addEvent(c,"mouseout",function(i){if(b.timeOutID){clearTimeout(b.timeOutID)}b.SmartHide(b)})}else{this.oIcon=c;c.onmouseover=function(e){if(!e){e=window.event}b.GetMouseXY(e);b.Show(g,h,f,d)};c.onmouseout=function(){b.SmartHide(b)}}};BXHint.prototype.IsFrozen=function(){return this.freeze};BXHint.prototype.Freeze=function(){this.freeze=true;this.Hide()};BXHint.prototype.UnFreeze=function(){this.freeze=false};BXHint.prototype.GetMouseXY=function(a){if(a.pageX||a.pageY){this.x=a.pageX;this.y=a.pageY}else{if(a.clientX||a.clientY){this.x=a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft;this.y=a.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop}}};BXHint.prototype.Show=function(k,p,d,h){var c=document.getElementById("__BXHint_div");if(c){this.Hide()}if(this.freeze){return}var b=this;var q=document.body.appendChild(document.createElement("DIV"));q.onmouseover=function(){b.oDivOver=true};q.onmouseout=function(){b.oDivOver=false;b.SmartHide(b)};q.id="__BXHint_div";q.className=h?h:"bxhint";q.style.position="absolute";if(p&&this.bWidth){q.style.width=p+"px"}if(d){q.style.height=d+"px"}q.innerHTML=k;var g=q.offsetWidth;var m=q.offsetHeight;if(this.bWidth){if(!p&&g>200){g=Math.round(Math.sqrt(1.618*g*m))}q.style.width=g+"px";m=q.offsetHeight}var j={left:this.x+10,right:this.x+g,top:this.y,bottom:this.y+m};j=this.AlignToPos(j,g,m);jsFloatDiv.Show(q,j.left,j.top,3);q=null};BXHint.prototype.AlignToPos=function(c,b,d){var a=document.body;if(a.clientWidth+a.scrollLeft<c.left+b){c.left=c.left-b>=0?c.left-b:a.scrollLeft}if(a.clientHeight+a.scrollTop-c.bottom<0){c.top=c.top-d>=0?c.top-d:a.scrollTop}return c};BXHint.prototype.Hide=function(){var a=document.getElementById("__BXHint_div");if(!a){return}BX.ZIndexManager.unregister(a);jsFloatDiv.Close(a);a.parentNode.removeChild(a);a=null};BXHint.prototype.SmartHide=function(a){setTimeout(function(){if(!a.oDivOver){a.Hide()}},100)};function WaitOnKeyPress(a){if(!a){a=window.event}if(!a){return}if(a.keyCode==27){CloseWaitWindow()}}function ShowWaitWindow(){CloseWaitWindow();var b=jsUtils.GetWindowSize();var a=document.body.appendChild(document.createElement("DIV"));a.id="wait_window_div";a.innerHTML=phpVars.messLoading;a.className="waitwindow";a.style.right=5-b.scrollLeft+"px";a.style.top=b.scrollTop+5+"px";if(jsUtils.IsIE()){var c=document.createElement("IFRAME");c.src="javascript:''";c.id="wait_window_frame";c.className="waitwindow";c.style.width=a.offsetWidth+"px";c.style.height=a.offsetHeight+"px";c.style.right=a.style.right;c.style.top=a.style.top;document.body.appendChild(c)}jsUtils.addEvent(document,"keypress",WaitOnKeyPress)}function CloseWaitWindow(){jsUtils.removeEvent(document,"keypress",WaitOnKeyPress);var b=document.getElementById("wait_window_frame");if(b){b.parentNode.removeChild(b)}var a=document.getElementById("wait_window_div");if(a){a.parentNode.removeChild(a)}}var jsSelectUtils={addNewOption:function(h,k,d,g,c){var b=typeof h=="string"||h instanceof String?document.getElementById(h):h;if(b){var m=b.length;if(c!==false){for(var f=0;f<m;f++){if(b[f].value==k){return}}}var j=new Option(d,k,false,false);b.options[m]=j}if(g===true){this.sortSelect(h)}},deleteOption:function(c,b){var d=typeof c=="string"||c instanceof String?document.getElementById(c):c;if(d){for(var a=0;a<d.length;a++){if(d[a].value==b){d.remove(a);break}}}},deleteSelectedOptions:function(b){var a=typeof b=="string"||b instanceof String?document.getElementById(b):b;if(a){var c=0;while(c<a.length){if(a[c].selected){a[c].selected=false;a.remove(c)}else{c++}}}},deleteAllOptions:function(b){if(b){for(var a=b.length-1;a>=0;a--){b.remove(a)}}},optionCompare:function(c,b){var d=c.optText.toLowerCase();var a=b.optText.toLowerCase();if(d>a){return 1}if(d<a){return -1}return 0},sortSelect:function(d){var b=typeof d=="string"||d instanceof String?document.getElementById(d):d;if(b){var g=[];var a=b.options.length;for(var f=0;f<a;f++){g[f]={optText:b[f].text,optValue:b[f].value}}g.sort(this.optionCompare);b.length=0;a=g.length;for(var f=0;f<a;f++){var c=new Option(g[f].optText,g[f].optValue,false,false);b[f]=c}}},selectAllOptions:function(c){var b=typeof c=="string"||c instanceof String?document.getElementById(c):c;if(b){var d=b.length;for(var a=0;a<d;a++){b[a].selected=true}}},selectOption:function(c,b){var f=typeof c=="string"||c instanceof String?document.getElementById(c):c;if(f){var a=f.length;for(var d=0;d<a;d++){f[d].selected=f[d].value==b}}},addSelectedOptions:function(d,b,g,a){if(!d){return}var f=d.length;for(var c=0;c<f;c++){if(d[c].selected){this.addNewOption(b,d[c].value,d[c].text,a,g)}}},moveOptionsUp:function(c){if(!c){return}var b=c.length;for(var f=0;f<b;f++){if(c[f].selected&&f>0&&c[f-1].selected==false){var a=new Option(c[f].text,c[f].value);var d=new Option(c[f-1].text,c[f-1].value);c[f]=d;c[f].selected=false;c[f-1]=a;c[f-1].selected=true}}},moveOptionsDown:function(c){if(!c){return}var b=c.length;for(var f=b-1;f>=0;f--){if(c[f].selected&&f<b-1&&c[f+1].selected==false){var a=new Option(c[f].text,c[f].value);var d=new Option(c[f+1].text,c[f+1].value);c[f]=d;c[f].selected=false;c[f+1]=a;c[f+1].selected=true}}}};(function(b){var a={time:1,step:0.05,type:"linear",allowFloat:false};BX.fx=function(d){this.options=d;if(null!=this.options.time){this.options.originalTime=this.options.time}if(null!=this.options.step){this.options.originalStep=this.options.step}if(!this.__checkOptions()){return false}this.__go=BX.delegate(this.go,this);this.PARAMS={}};BX.fx.prototype.__checkOptions=function(){if(typeof this.options.start!=typeof this.options.finish){return false}if(null==this.options.time){this.options.time=a.time}if(null==this.options.step){this.options.step=a.step}if(null==this.options.type){this.options.type=a.type}if(null==this.options.allowFloat){this.options.allowFloat=a.allowFloat}this.options.time*=1000;this.options.step*=1000;if(typeof this.options.start!="object"){this.options.start={_param:this.options.start};this.options.finish={_param:this.options.finish}}var d;for(d in this.options.start){if(null==this.options.finish[d]){this.options.start[d]=null;delete this.options.start[d]}}if(!BX.type.isFunction(this.options.type)){if(BX.type.isFunction(b[this.options.type])){this.options.type=b[this.options.type]}else{if(BX.type.isFunction(BX.fx.RULES[this.options.type])){this.options.type=BX.fx.RULES[this.options.type]}else{this.options.type=BX.fx.RULES[a.type]}}}return true};BX.fx.prototype.go=function(){var e=(new Date).valueOf();if(e<this.PARAMS.timeFinish){for(var d in this.PARAMS.current){this.PARAMS.current[d][0]=this.options.type.apply(this,[{start_value:this.PARAMS.start[d][0],finish_value:this.PARAMS.finish[d][0],current_value:this.PARAMS.current[d][0],current_time:e-this.PARAMS.timeStart,total_time:this.options.time}])}this._callback(this.options.callback);if(!this.paused){this.PARAMS.timer=setTimeout(this.__go,this.options.step)}}else{this.stop()}};BX.fx.prototype._callback=function(f){var d={};f=f||this.options.callback;for(var g in this.PARAMS.current){d[g]=(this.options.allowFloat?this.PARAMS.current[g][0]:Math.round(this.PARAMS.current[g][0]))+this.PARAMS.current[g][1]}return f.apply(this,[null!=d._param?d._param:d])};BX.fx.prototype.start=function(){var f,d,g;this.PARAMS.start={};this.PARAMS.current={};this.PARAMS.finish={};for(f in this.options.start){d=+this.options.start[f];g=(this.options.start[f]+"").substring((d+"").length);this.PARAMS.start[f]=[d,g];this.PARAMS.current[f]=[d,g];this.PARAMS.finish[f]=[+this.options.finish[f],g]}this._callback(this.options.callback_start);this._callback(this.options.callback);this.PARAMS.timeStart=(new Date).valueOf();this.PARAMS.timeFinish=this.PARAMS.timeStart+this.options.time;this.PARAMS.timer=setTimeout(BX.delegate(this.go,this),this.options.step);return this};BX.fx.prototype.pause=function(){if(this.paused){this.PARAMS.timer=setTimeout(this.__go,this.options.step);this.paused=false}else{clearTimeout(this.PARAMS.timer);this.paused=true}};BX.fx.prototype.stop=function(d){d=!!d;if(this.PARAMS.timer){clearTimeout(this.PARAMS.timer)}if(null!=this.options.originalTime){this.options.time=this.options.originalTime}if(null!=this.options.originalStep){this.options.step=this.options.originalStep}this.PARAMS.current=this.PARAMS.finish;if(!d){this._callback(this.options.callback);this._callback(this.options.callback_complete)}};BX.fx.RULES={linear:function(d){return d.start_value+d.current_time/d.total_time*(d.finish_value-d.start_value)},decelerated:function(d){return d.start_value+Math.sqrt(d.current_time/d.total_time)*(d.finish_value-d.start_value)},accelerated:function(e){var d=e.current_time/e.total_time;return e.start_value+d*d*(e.finish_value-e.start_value)}};BX.fx.hide=function(f,d,h){f=BX(f);if(typeof d=="object"&&null==h){h=d;d=h.type}if(!h){h={}}if(!BX.type.isNotEmptyString(d)){f.style.display="none";return}var g=BX.fx.EFFECTS[d](f,h,0);g.callback_complete=function(){if(h.hide!==false){f.style.display="none"}if(h.callback_complete){h.callback_complete.apply(this,arguments)}};return new BX.fx(g).start()};BX.fx.show=function(f,d,h){f=BX(f);if(typeof d=="object"&&null==h){h=d;d=h.type}if(!h){h={}}if(!BX.type.isNotEmptyString(d)){f.style.display="block";return}var g=BX.fx.EFFECTS[d](f,h,1);g.callback_complete=function(){if(h.show!==false){f.style.display="block"}if(h.callback_complete){h.callback_complete.apply(this,arguments)}};return new BX.fx(g).start()};BX.fx.EFFECTS={scroll:function(f,i,g){if(!i.direction){i.direction="vertical"}var k=i.direction=="horizontal"?"width":"height";var j=parseInt(BX.style(f,k));if(isNaN(j)){j=BX.pos(f)[k]}if(g==0){var d=j,h=i.min_height?parseInt(i.min_height):0}else{var h=j,d=i.min_height?parseInt(i.min_height):0}return{start:d,finish:h,time:i.time||a.time,type:"linear",callback_start:function(){if(BX.style(f,"position")=="static"){f.style.position="relative"}f.style.overflow="hidden";f.style[k]=d+"px";f.style.display="block"},callback:function(e){f.style[k]=e+"px"}}},fade:function(d,g,f){var h={time:g.time||a.time,type:f==0?"decelerated":"linear",start:f==0?1:0,finish:f==0?0:1,allowFloat:true};if(BX.browser.IsIE()&&!BX.browser.IsIE9()){h.start*=100;h.finish*=100;h.allowFloat=false;h.callback_start=function(){d.style.display="block";d.style.filter+="progid:DXImageTransform.Microsoft.Alpha(opacity="+h.start+")"};h.callback=function(e){(d.filters["DXImageTransform.Microsoft.alpha"]||d.filters.alpha).opacity=e}}else{h.callback_start=function(){d.style.display="block"};h.callback=function(e){d.style.opacity=d.style.KhtmlOpacity=d.style.MozOpacity=e}}return h},fold:function(f,h,g){if(g!=0){return}var j=BX.pos(f);var i=j.height/(j.width+j.height);var d={time:h.time||a.time,callback_complete:h.callback_complete,hide:h.hide};h.type="scroll";h.direction="vertical";h.min_height=h.min_height||10;h.hide=false;h.time=i*d.time;h.callback_complete=function(){f.style.whiteSpace="nowrap";h.direction="horizontal";h.min_height=null;h.time=d.time-h.time;h.hide=d.hide;h.callback_complete=d.callback_complete;BX.fx.hide(f,h)};return BX.fx.EFFECTS.scroll(f,h,g)},scale:function(f,i,g){var k={width:parseInt(BX.style(f,"width")),height:parseInt(BX.style(f,"height"))};if(isNaN(k.width)||isNaN(k.height)){var j=BX.pos(f);k={width:j.width,height:j.height}}if(g==0){var d=k,h={width:0,height:0}}else{var h=k,d={width:0,height:0}}return{start:d,finish:h,time:i.time||a.time,type:"linear",callback_start:function(){f.style.position="relative";f.style.overflow="hidden";f.style.display="block";f.style.height=d.height+"px";f.style.width=d.width+"px"},callback:function(e){f.style.height=e.height+"px";f.style.width=e.width+"px"}}}};var c={arStack:{},arRules:{},globalAnimationId:0};BX.fx.colorAnimate=function(f,e,g){if(f==null){return}animationId=f.getAttribute("data-animation-id");if(animationId==null){animationId=c.globalAnimationId;f.setAttribute("data-animation-id",c.globalAnimationId++)}var j=e.split(/\s*,\s*/);for(var h=0;h<j.length;h++){e=j[h];if(!c.arRules[e]){continue}var d=0;if(!c.arStack[animationId]){c.arStack[animationId]={}}else{if(c.arStack[animationId][e]){d=c.arStack[animationId][e].i;clearInterval(c.arStack[animationId][e].tId)}}if(d==0&&g||d==c.arRules[e][3]&&!g){continue}c.arStack[animationId][e]={i:d,element:f,tId:setInterval('BX.fx.colorAnimate.run("'+animationId+'","'+e+'")',c.arRules[e][4]),back:Boolean(g)}}};BX.fx.colorAnimate.addRule=function(f,e,g,k,j,d,h){c.arRules[f]=[BX.util.hex2rgb(e),BX.util.hex2rgb(g),k.replace(/\-(.)/g,function(){return arguments[1].toUpperCase()}),j,d||1,h||false]};BX.fx.colorAnimate.run=function(f,e){element=c.arStack[f][e].element;c.arStack[f][e].i+=c.arStack[f][e].back?-1:1;var g=c.arStack[f][e].i/c.arRules[e][3];var j=1-g;var h=c.arRules[e][0];var d=c.arRules[e][1];element.style[c.arRules[e][2]]="rgb("+Math.floor(h.r*j+d.r*g)+","+Math.floor(h.g*j+d.g*g)+","+Math.floor(h.b*j+d.b*g)+")";if(c.arStack[f][e].i==c.arRules[e][3]||c.arStack[f][e].i==0){clearInterval(c.arStack[f][e].tId);if(c.arRules[e][5]){BX.fx.colorAnimate(c.arStack[f][e].element,e,true)}}};BX.easing=function(d){this.options=d;this.timer=null};BX.easing.prototype.animate=function(){if(!this.options||!this.options.start||!this.options.finish||typeof this.options.start!="object"||typeof this.options.finish!="object"){return null}for(var d in this.options.start){if(typeof this.options.finish[d]=="undefined"){delete this.options.start[d]}}this.options.progress=function(g){var f={};for(var h in this.start){f[h]=Math.round(this.start[h]+(this.finish[h]-this.start[h])*g)}if(this.step){this.step(f)}};this.animateProgress()};BX.easing.prototype.stop=function(d){if(this.timer){cancelAnimationFrame(this.timer);this.timer=null;if(d){this.options.complete&&this.options.complete()}}};BX.easing.prototype.animateProgress=function(){if(!b.requestAnimationFrame){this.options.progress(1);this.options.complete&&this.options.complete();return}var d=null;var g=this.options.transition||BX.easing.transitions.linear;var f=this.options.duration||1000;var h=BX.proxy(function(e){if(d===null){d=e}var i=(e-d)/f;if(i>1){i=1}this.options.progress(g(i));if(i==1){this.stop(true)}else{this.timer=requestAnimationFrame(h)}},this);this.timer=requestAnimationFrame(h)};BX.easing.makeEaseInOut=function(d){return function(e){if(e<0.5){return d(2*e)/2}else{return(2-d(2*(1-e)))/2}}};BX.easing.makeEaseOut=function(d){return function(e){return 1-d(1-e)}};BX.easing.transitions={linear:function(d){return d},quad:function(d){return Math.pow(d,2)},cubic:function(d){return Math.pow(d,3)},quart:function(d){return Math.pow(d,4)},quint:function(d){return Math.pow(d,5)},circ:function(d){return 1-Math.sin(Math.acos(d))},back:function(d){return Math.pow(d,2)*((1.5+1)*d-1.5)},elastic:function(d){return Math.pow(2,10*(d-1))*Math.cos(20*Math.PI*1.5/3*d)},bounce:function(f){for(var d=0,g=1;1;d+=g,g/=2){if(f>=(7-4*d)/11){return -Math.pow((11-6*d-11*f)/4,2)+Math.pow(g,2)}}}}})(window);